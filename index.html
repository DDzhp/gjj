<!DOCTYPE html>
<!-- 
âš¡ï¸ YLå·¥å…·é›† - å¤šåŠŸèƒ½Webåº”ç”¨å·¥å…·é›†åˆ

ğŸ“‹ é¡¹ç›®æ¦‚è¿°ï¼š
è¿™æ˜¯ä¸€ä¸ªé›†æˆäº†å¤šç§å®ç”¨å·¥å…·çš„å•é¡µWebåº”ç”¨ï¼Œä¸“ä¸ºYLå·¥ä½œæµç¨‹è®¾è®¡ï¼Œæä¾›ä¾¿æ·çš„æ•°æ®å¤„ç†å’Œè½¬æ¢åŠŸèƒ½ã€‚

ğŸ”§ ä¸»è¦å·¥å…·åˆ—è¡¨ï¼š
1. ğŸ”„ è„‰å†²è®¡ç®—å™¨ - ç”¨äºè„‰å†²å‚æ•°è®¡ç®—
2. ğŸ”¢ è¿›åˆ¶è½¬æ¢å·¥å…· - æ”¯æŒåè¿›åˆ¶ä¸åå…­è¿›åˆ¶ç›¸äº’è½¬æ¢
3. ğŸ“‹ å…¥åº“å‚æ•°è§£æå·¥å…· - è§£æè®¾å¤‡å…¥åº“å‚æ•°
4. ğŸ“± ICCIDè¯¦æƒ…å·¥å…· - å¤„ç†ICCIDå·ç ï¼Œæ”¯æŒåŒºé—´è§£æå’Œæ ¼å¼è½¬æ¢
5. ğŸ“‹ ICå¡å·å¤„ç† - æ‰¹é‡å¤„ç†Excelæ–‡ä»¶ä¸­çš„ICå¡å·å’Œæµæ°´å·
6. ğŸ”¢ ç”Ÿæˆæµæ°´å·å·¥å…· - ç”Ÿæˆè¿ç»­æµæ°´å·
7. ğŸ’§ æ´—æµ´æ°´æ§é‡‘é¢æ°´é‡æ¢ç®— - é‡‘é¢ä¸æ°´é‡çš„ç›¸äº’æ¢ç®—
8. ğŸš° æ°´æ§å•ä»· - è®¡ç®—æ°´æ§è®¾å¤‡çš„å•ä»·
9. ğŸ“Š IMEI/ICCIDä¹±ç å¤„ç†å·¥å…· - ä¿®å¤Excelä¸­ICCID/IMEIçš„ç§‘å­¦è®¡æ•°æ³•é—®é¢˜
10. ğŸ”² äºŒç»´ç ç”Ÿæˆå™¨ - æ‰¹é‡ç”ŸæˆäºŒç»´ç 
11. ğŸ“Š æ—¥å¿—åˆ†æå™¨ - åˆ†æè®¾å¤‡æ—¥å¿—
12. ğŸ” è§£æäºŒç»´ç  - è§£æäºŒç»´ç å†…å®¹

ğŸ“š æŠ€æœ¯æ ˆï¼š
- HTML5 + CSS3 + JavaScript
- jQuery 3.6.0
- XLSXåº“ï¼ˆExcelæ–‡ä»¶å¤„ç†ï¼‰
- jsQRåº“ï¼ˆäºŒç»´ç è§£æï¼‰
- Tesseract.jsï¼ˆæ–‡å­—è¯†åˆ«ï¼‰
- OCRAD.jsï¼ˆè½»é‡çº§OCRåº“ï¼‰

ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ï¼š
- Excelæ–‡ä»¶ä¸Šä¼ ä¸å¤„ç†
- æ™ºèƒ½æ•°æ®è¯†åˆ«ä¸æ¸…æ´—
- æ¨¡æ¿åŒ–æ–‡ä»¶ç”Ÿæˆ
- å¤šç§æ•°æ®æ ¼å¼è½¬æ¢
- æ‰¹é‡å¤„ç†åŠŸèƒ½
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯
- å¤šé‡å¤‡ç”¨æ–¹æ¡ˆç¡®ä¿é«˜å¯ç”¨æ€§

ğŸ“ ä½¿ç”¨è¯´æ˜ï¼š
1. é€šè¿‡é¡¶éƒ¨å·¥å…·åˆ‡æ¢æŒ‰é’®é€‰æ‹©æ‰€éœ€å·¥å…·
2. æŒ‰ç…§å„å·¥å…·çš„ä½¿ç”¨æç¤ºæ“ä½œ
3. æ”¯æŒæ–‡ä»¶æ‹–æ‹½ä¸Šä¼ 
4. å¤„ç†ç»“æœå®æ—¶é¢„è§ˆ
5. è‡ªåŠ¨ä¸‹è½½ç”Ÿæˆçš„æ–‡ä»¶

ğŸ”§ å¿«é€Ÿç†è§£ä¿¡æ¯ï¼ˆç”¨äºä¸‹æ¬¡æ²Ÿé€šï¼‰ï¼š
- é¡¹ç›®ç±»å‹ï¼šå•é¡µWebåº”ç”¨å·¥å…·é›†
- æ ¸å¿ƒåŠŸèƒ½ï¼šExcelå¤„ç†ã€æ•°æ®è½¬æ¢ã€æ‰¹é‡æ“ä½œ
- ä¸»è¦å·¥å…·ï¼šICå¡å·å¤„ç†ã€ICCIDè¯¦æƒ…ã€æµæ°´å·ç”Ÿæˆã€è¿›åˆ¶è½¬æ¢
- æŠ€æœ¯ä¾èµ–ï¼šjQueryã€XLSXã€jsQRç­‰
- ç‰¹è‰²åŠŸèƒ½ï¼šæ™ºèƒ½æ•°æ®è¯†åˆ«ã€æ¨¡æ¿åŒ–ç”Ÿæˆã€å¤šé‡å¤‡ç”¨æ–¹æ¡ˆ
- æœ€è¿‘ä¿®æ”¹ï¼šæ·»åŠ äº†æµæ°´å·è‡ªåŠ¨æ¸…ç†"NO."å‰ç¼€åŠŸèƒ½

ğŸ“… æœ€åæ›´æ–°ï¼š2025-11-27

-->
    <html lang="zh-CN">
    <head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>âš¡ï¸å·¥å…·é›†âš¡ï¸</title>
        <!-- ç½‘ç«™å›¾æ ‡ -->
        <link rel="icon" type="image/svg+xml" href="favicon.svg">
        <link rel="shortcut icon" type="image/svg+xml" href="favicon.svg">
        <!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> -->
        <script src="js/jquery-3.6.0.min.js"></script>
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script> -->
        <script src="js/xlsx.full.min.js"></script>
        <script src="js/logDecode.js"></script>
        <!-- <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script> -->
        <script src="js/jsQR.min.js"></script>
        <!-- Tesseract.js - ç”¨äºæ–‡å­—è¯†åˆ« -->
        <!-- <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.1.1/dist/tesseract.min.js"></script> -->
        <script src="js/tesseract.min.js"></script>
        <!-- OCRAD.js - è½»é‡çº§OCRåº“ï¼ˆå¤‡ç”¨1ï¼‰ -->
        <!-- <script src="https://cdn.jsdelivr.net/npm/ocrad.js@0.0.1/ocrad.js"></script> -->
        <script src="js/ocrad.js"></script>

        <style>
            /* ===== CSSå˜é‡å®šä¹‰ ===== */
            :root {
                --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                --primary-color: #667eea;
                --secondary-color: #764ba2;
                --success-gradient: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
                --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                --danger-gradient: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
                --bg-color: #ffffff;
                --bg-opacity: 0.95;
                --container-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
                --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            /* ===== å…¨å±€æ ·å¼ ===== */
            * {
                box-sizing: border-box;
            }
            
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
                background: var(--primary-gradient);
                margin: 0;
                padding: 0;
                min-height: 100vh;
                font-size: 16px;
            }
            
            /* ===== å“åº”å¼è®¾è®¡ ===== */
            @media (max-width: 768px) {
                body {
                    font-size: 18px;
                    padding-bottom: 20px;
                }
                
                .container {
                    width: 100% !important;
                    margin: 0 !important;
                    padding: 15px !important;
                    max-width: none !important;
                }
                
                /* è°ƒæ•´è¾“å…¥æ¡†å’ŒæŒ‰é’®å¤§å° */
                input, button, textarea, select {
                    font-size: 18px !important;
                    padding: 15px !important;
                    min-height: 52px !important;
                    width: 100% !important;
                    box-sizing: border-box !important;
                }
                
                /* è°ƒæ•´è¡¨æ ¼å•å…ƒæ ¼å­—ä½“å¤§å° */
                table {
                    width: 100% !important;
                    font-size: 16px !important;
                }
                
                td, th {
                    font-size: 16px !important;
                    padding: 10px !important;
                    word-break: break-all !important;
                }
                
                /* è°ƒæ•´æ ‡é¢˜å¤§å° */
                h1, h2, h3, h4, h5, h6 {
                    font-size: 1.5rem !important;
                    margin: 15px 0 !important;
                    line-height: 1.3 !important;
                }
                
                /* ç¡®ä¿å†…å®¹ä¸è¶…å‡ºå±å¹• */
                .card {
                    padding: 15px !important;
                    margin: 10px 0 !important;
                    width: 100% !important;
                    box-sizing: border-box !important;
                }
                
                /* è°ƒæ•´å·¥å…·åˆ—è¡¨å¼¹çª— */
                #toolModal > div {
                    width: 100% !important;
                    max-width: none !important;
                    margin: 70px 0 0 0 !important;
                    padding: 25px 20px !important;
                    font-size: 18px !important;
                    border-radius: 20px 0 0 0 !important;
                    max-height: calc(100vh - 70px) !important;
                }
                
                /* å¼¹çª—æŒ‰é’®è§¦æ‘¸æ•ˆæœ */
                #toolModal button[data-tool-id]:active {
                    background: var(--primary-gradient) !important;
                    color: white !important;
                    transform: scale(0.98);
                }
                
                /* è°ƒæ•´ç»“æœå±•ç¤ºåŒºåŸŸ */
                #result, #parsedParams, .result-container {
                    font-size: 16px !important;
                    padding: 15px !important;
                    overflow-x: auto !important;
                }
                
                /* éšè—æ¡Œé¢ç«¯å·¥å…·å¯¼èˆª */
                #mainToolSwitcher {
                    display: none !important;
                }
                
                #toggleToolsBtn {
                    display: none !important;
                }
                
                /* ç§»åŠ¨ç«¯éšè—PCç‰ˆå·¥å…·åˆ—è¡¨æŒ‰é’® */
                #topToolSwitchBtn {
                    display: none !important;
                }
                
                /* ç§»åŠ¨ç«¯èœå•æŒ‰é’®ä¿æŒå±…ä¸­æ˜¾ç¤º */
                .mobile-menu-btn {
                    display: block !important;
                    right: 50% !important;
                    transform: translateX(50%) !important;
                    border-radius: 12px 12px 0 0 !important;
                }
                
                /* ç¡®ä¿ç§»åŠ¨ç«¯èœå•æ ·å¼æ­£ç¡® */
                .mobile-menu {
                    top: 71px !important;
                    left: 0 !important;
                    transform: none !important;
                    width: 100% !important;
                }
                
                .mobile-menu-content {
                    width: 100% !important;
                }
                
                /* ç§»åŠ¨ç«¯æ•´ä½“æ–‡å­—ç¼©å°20% */
                body {
                    font-size: 80%;
                }
                
                /* è°ƒæ•´å¼¹çª—å†…å…ƒç´ å­—ä½“å¤§å° */
                #toolModal h3 {
                    font-size: 16px;
                }
                
                #toolModal button[data-tool-id] {
                    font-size: 12.8px;
                }
            }

            /* ===== ç§»åŠ¨ç«¯èœå•æŒ‰é’® ===== */
            .mobile-menu-btn {
                display: none;
                position: fixed;
                top: 15px;
                right: 15px;
                z-index: 1000;
                background: var(--primary-gradient);
                color: white;
                border: none;
                border-radius: 12px 12px 0 0; /* åº•éƒ¨æ— åœ†è§’ï¼Œä¸ä¸‹æ‹‰èœå•è¿æ¥å¤„å¹³æ»‘ */
                width: 56px;
                height: 56px;
                font-size: 28px;
                cursor: pointer;
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
                transition: var(--transition);
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .mobile-menu-btn:hover, .mobile-menu-btn:active {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            }
            
            /* ===== ç§»åŠ¨ç«¯èœå•æ ·å¼ - ä¸‹æ‹‰èœå•å½¢å¼ ===== */
            .mobile-menu {
                position: fixed;
                top: 71px; /* æŒ‰é’®åº•éƒ¨ä½ç½®ï¼ˆ15px + 56pxï¼‰ */
                left: 0;
                width: 100%; /* ä¸é¡µé¢åŒå®½ */
                background: transparent;
                z-index: 999;
                display: block;
                margin: 0;
                transform: none; /* ç§»é™¤å±…ä¸­å˜æ¢ */
            }
            
            .mobile-menu-content {
                background: white;
                border-radius: 0 0 12px 12px; /* é¡¶éƒ¨æ— åœ†è§’ï¼Œä¸æŒ‰é’®è¿æ¥å¤„å¹³æ»‘ */
                padding: 0;
                width: 100%; /* ä¸é¡µé¢åŒå®½ */
                box-sizing: border-box;
                border: none;
                margin: 0;
                max-height: 70vh;
                overflow-y: auto;
                position: relative;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
                /* ç§»é™¤åŠ¨ç”»ä»¥é¿å…ä½ç½®è®¡ç®—é—®é¢˜å¯¼è‡´çš„é—ªçƒ */
            }
            
            /* ç§»åŠ¨ç«¯èœå•é¡¹æ ·å¼ */
            .mobile-menu-item {
                width: 100%;
                height: 48px;
                border: none;
                background: white;
                font-size: 14px; /* é€‚å½“å¢å¤§å­—ä½“ä»¥é€‚åº”å®½èœå• */
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: flex-start;
                padding: 8px 16px;
                text-align: left;
                white-space: nowrap;
                overflow: visible;
                transition: background-color 0.2s ease;
                box-sizing: border-box;
                border-bottom: 1px solid #f0f0f0;
            }
            
            .mobile-menu-item:last-child {
                border-bottom: none;
            }
            
            .mobile-menu-item:hover, .mobile-menu-item:active {
                background-color: #f5f5f5;
            }
            
            /* ç§»é™¤å…³é—­æŒ‰é’®æ ·å¼ */
            .close-menu-btn {
                display: none;
            }
            
            @keyframes slideInRight {
                from {
                    opacity: 0;
                    transform: translateX(100%);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
            
            .close-menu-btn {
                position: absolute;
                top: 10px;
                right: 10px;
                background: var(--primary-color);
                color: white;
                border: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                font-size: 20px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
                transition: var(--transition);
            }
            
            .close-menu-btn:hover, .close-menu-btn:active {
                background: var(--primary-dark);
                transform: scale(1.05);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }
            
            .mobile-tool-switcher {
                display: flex;
                flex-direction: column;
                gap: 14px;
                margin-top: 15px;
            }
            
            .mobile-tool-switcher button {
                padding: 18px 20px;
                text-align: left;
                background: rgba(102, 126, 234, 0.1);
                border: 2px solid #e9ecef;
                border-radius: 16px;
                cursor: pointer;
                font-size: 18px;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                font-weight: 500;
                min-height: 60px;
                display: flex;
                align-items: center;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            }
            
            .mobile-tool-switcher button:hover, .mobile-tool-switcher button:active {
                background: var(--primary-gradient);
                color: white;
                border-color: var(--primary-color);
                transform: translateY(-2px) translateX(3px);
                box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
            }
            
            /* ===== å®¹å™¨æ ·å¼ ===== */
            .container {
                max-width: 1300px;
                margin: 20px auto;
                padding: 20px;
                background: rgba(255, 255, 255, 0.95);
                border-radius: 15px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                backdrop-filter: blur(10px);
            }
            
            /* ===== ä¸»æ ‡é¢˜æ ·å¼ ===== */
            h1 {
                text-align: center;
                /*background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);*/
                -webkit-background-clip: text;
                /*-webkit-text-fill-color: transparent;*/
                background-clip: text;
                font-size: 2.5em;
                margin: 0 0 30px 0;
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            
            /* ===== å·¥å…·å¯¼èˆªæ æ ·å¼ ===== */
    /* ä½¿ç”¨å¤§å°å†™ä¸æ•æ„Ÿçš„æ–¹å¼å¤„ç†å·¥å…·IDé€‰æ‹© */
    .tool-switcher button:not(.active):not([data-tool-id='excelTemplateTool']):not([data-tool-id='pulseTool']):not([data-tool-id*='iccid']):not([data-tool-id*='ICCID']):not([data-tool-id*='serial']):not([data-tool-id*='qr']):not([data-tool-id*='äºŒç»´ç ç”Ÿæˆ']):not([data-tool-id='stockParamTool']) {
        display: none;
    }
            .tool-switcher {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                margin: 20px 0 30px 0;
                padding: 15px;
                background: rgba(255, 255, 255, 0.8);
                border-radius: 12px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            }
            
            .tool-switcher button {
                padding: 12px 20px;
                border: 2px solid transparent;
                background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
                color: #333;
                cursor: pointer;
                border-radius: 25px;
                font-weight: 500;
                font-size: 14px;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                position: relative;
                overflow: hidden;
            }
            
            .tool-switcher button::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
                transition: left 0.6s;
            }
            
            .tool-switcher button:hover::before {
                left: 100%;
            }
            
            .tool-switcher button:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(0, 123, 255, 0.3);
                border-color: #007bff;
            }
            
            .tool-switcher button.active {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border-color: #5a67d8;
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
                transform: translateY(-2px);
            }
            
            /* ===== è®¡ç®—å™¨æ¨¡å—æ ·å¼ ===== */
            .calculator {
                background: rgba(255, 255, 255, 0.9);
                border: none;
                padding: 30px;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
                backdrop-filter: blur(10px);
                animation: fadeInUp 0.5s ease-out;
            }
            
            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .calculator h2 {
                color: #333;
                margin: 0 0 25px 0;
                font-size: 1.8em;
                text-align: center;
                position: relative;
            }
            
            .calculator h2::after {
                content: '';
                position: absolute;
                bottom: -10px;
                left: 50%;
                transform: translateX(-50%);
                width: 50px;
                height: 3px;
                background: linear-gradient(45deg, #667eea, #764ba2);
                border-radius: 2px;
            }
            
            /* ===== è¡¨å•å…ƒç´ æ ·å¼ ===== */
            .form-group {
                margin-bottom: 20px;
            }
            
            label {
                display: block;
                margin-bottom: 8px;
                color: #555;
                font-weight: 600;
                font-size: 14px;
            }
            
            input[type="text"],
            input[type="number"],
            input[type="file"],
            select,
            textarea {
                width: 100%;
                padding: 12px 16px;
                border: 2px solid #e1e5e9;
                border-radius: 8px;
                font-size: 14px;
                font-family: inherit;
                transition: all 0.3s ease;
                background: rgba(255, 255, 255, 0.9);
            }
            
            input[type="text"]:focus,
            input[type="number"]:focus,
            input[type="file"]:focus,
            select:focus,
            textarea:focus {
                outline: none;
                border-color: #667eea;
                box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                transform: translateY(-2px);
            }
            
            input[readonly] {
                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                color: #666;
                cursor: not-allowed;
            }
            
            textarea {
                resize: vertical;
                min-height: 100px;
                font-family: 'Consolas', 'Monaco', monospace;
            }
            
            /* ===== æŒ‰é’®æ ·å¼ ===== */
            button {
                padding: 12px 24px;
                border: none;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
            }
            
            /* ===== æ—¥å¿—åˆ†æå™¨æ ·å¼ ===== */
            .log-analysis-tool {
                display: flex;
                flex-direction: column;
                gap: 20px;
            }
            
            /* ç»“æœé¡¹å®¹å™¨æ ·å¼ */
            .result-item {
                background-color: white;
                border-radius: 10px;
                overflow: hidden;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                margin-bottom: 20px;
                transition: all 0.3s ease;
            }
            
            .result-item:hover {
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }
            
            .result-item.error {
                border: 2px solid #f5c6cb;
            }
            
            /* é”™è¯¯åŸå§‹æ•°æ®åŒºåŸŸæ ·å¼ */
            .error-raw-data {
                padding: 15px;
                background-color: #f8d7da;
                font-family: 'Courier New', monospace;
                font-size: 0.9em;
                word-break: break-all;
            }
            
            /* åŸå§‹æ—¥å¿—æ˜¾ç¤ºåŒºåŸŸæ ·å¼ */
            .result-header + div {
                font-family: 'Courier New', monospace;
                font-size: 0.9em;
            }
            
            .log-input-section {
                display: flex;
                flex-direction: column;
                gap: 15px;
            }
            
            .buttons-section {
                display: flex;
                gap: 10px;
            }
            
            .analyze-btn {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                padding: 12px 30px;
                font-size: 16px;
                border-radius: 50px;
                cursor: pointer;
                transition: all 0.3s;
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            }
            
            .analyze-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
            }
            
            .clear-btn {
                background: #6c757d;
                color: white;
                border: none;
                padding: 12px 25px;
                font-size: 16px;
                border-radius: 50px;
                cursor: pointer;
                transition: all 0.3s;
            }
            
            .clear-btn:hover {
                background: #5a6268;
                transform: translateY(-1px);
            }
            
            .status-section {
                padding: 15px;
                border-radius: 10px;
                font-weight: 600;
                text-align: center;
                margin-bottom: 15px;
            }
            
            .status-section.info {
                background: #d1ecf1;
                color: #0c5460;
                border: 1px solid #bee5eb;
            }
            
            .status-section.error {
                background: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
            }
            
            .result-section {
                display: flex;
                flex-direction: column;
            }
            
            .result-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #ffffff;
                padding: 15px 20px;
                font-weight: bold;
                font-size: 1em;
                border-top-left-radius: 10px;
                border-top-right-radius: 10px;
            }
            
            .result-content {
                max-height: 600px;
                overflow-y: auto;
                border: 2px solid #e1e5e9;
                border-top: none;
                border-bottom-left-radius: 10px;
                border-bottom-right-radius: 10px;
            }
            
            .data-table {
                width: 100%;
                border-collapse: collapse;
                background: white;
            }
            
            .data-table th {
                background: #d1ecf1;
                color: #0c5460;
                padding: 8px 6px;
                text-align: center;
                font-weight: 600;
                border-bottom: 2px solid #dee2e6;
                font-size: 0.75em;
                min-width: 60px;
                max-width: 120px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            
            .data-table th.row-label {
                background: #e9ecef;
                color: #495057;
                font-weight: 700;
                text-align: left;
                min-width: 80px;
                max-width: 100px;
                position: sticky;
                left: 0;
                z-index: 10;
                text-align: center;
                font-size: 1.3em;

            }
            
            .data-table th.range-cell {
                background: #f1f3f4;
                color: #222222;
                font-size: 1.2em;
                font-weight: 500;
            }
            
            .data-table td {
                padding: 6px 4px;
                border-bottom: 1px solid #dee2e6;
                font-family: 'Courier New', monospace;
                font-size: 1.5em;
                text-align: center;
                white-space: nowrap;
                min-width: 60px;
                max-width: 120px;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            
            .data-table td.row-label {
                background: #f8f9fa;
                font-weight: 600;
                text-align: left;
                position: sticky;
                left: 0;
                z-index: 5;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                min-width: 80px;
                max-width: 100px;
                text-align: center;
                font-size: 1.3em;

            }
            
            .data-table td.data-cell {
                min-width: 60px;
                max-width: 120px;
            }
            
            .data-table tr:nth-child(even) {
                background-color: #f8f9fa;
            }
            
            .data-table tr:hover {
                background-color: #e3f2fd;
            }
            
            .hex-value {
                color: #666666;
                font-weight: bold;
                font-size: 1.5em;
                text-align: center;
            }
            
            .dec-value {
                color: #333333;
                font-size: 1.5em;
                text-align: center;
                font-weight: bold;

            }
            
            .data-type-badge {
                display: inline-block;
                background: linear-gradient(135deg, #ff6b6b, #ee5a24);
                color: white;
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 0.8em;
                font-weight: bold;
                margin-right: 10px;
            }
            
            @media (max-width: 768px) {
                .data-table {
                    font-size: 0.65em;
                }
                
                .data-table th, .data-table td {
                    padding: 4px 2px;
                    min-width: 45px;
                    max-width: 80px;
                }
                
                .data-table th.row-label, .data-table td.row-label {
                    min-width: 60px;
                    max-width: 80px;
                }
            }
            
            @media (max-width: 480px) {
                .data-table th, .data-table td {
                    padding: 3px 1px;
                    min-width: 35px;
                    max-width: 60px;
                    font-size: 0.6em;
                }
                
                .data-table th.row-label, .data-table td.row-label {
                    min-width: 50px;
                    max-width: 70px;
                }
            }
            
            button {
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                position: relative;
                overflow: hidden;
            }
            
            button::before {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                width: 0;
                height: 0;
                background: rgba(255, 255, 255, 0.3);
                border-radius: 50%;
                transform: translate(-50%, -50%);
                transition: width 0.6s, height 0.6s;
            }
            
            button:active::before {
                width: 300px;
                height: 300px;
            }
            
            button:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
            
            /* ä¸»è¦æŒ‰é’®æ ·å¼ */
            .btn-primary {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
            }
            
            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            }
            
            .btn-primary:hover:not(:disabled) {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            }
            
            /* æˆåŠŸæŒ‰é’®æ ·å¼ */
            .btn-success {
                background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
                color: white;
            }
            
            .btn-success:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(86, 171, 47, 0.4);
            }
            
            /* è­¦å‘ŠæŒ‰é’®æ ·å¼ */
            .btn-warning {
                background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                color: white;
            }
            
            .btn-warning:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(240, 147, 251, 0.4);
            }
            
            /* å±é™©æŒ‰é’®æ ·å¼ */
            .btn-danger {
                background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
                color: white;
            }
            
            .btn-danger:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(255, 65, 108, 0.4);
            }
            
            /* ===== ç»“æœæ˜¾ç¤ºåŒºåŸŸæ ·å¼ ===== */
            .result-area {
                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                padding: 20px;
                border-radius: 12px;
                border: 2px solid #e9ecef;
                min-height: 40px;
                font-family: 'Consolas', 'Monaco', monospace;
                line-height: 1.6;
            }
            
            /* ===== å‚æ•°è§£æå·¥å…·ç‰¹æ®Šæ ·å¼ ===== */
            .param-results {
                margin-top: 20px;
                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                border: 2px solid #dee2e6;
                border-radius: 12px;
                padding: 20px;
            }
            
            .param-group {
                display: flex;
                gap: 20px;
                margin-top: 15px;
            }
            
            .param-column {
                flex: 1;
                padding: 15px;
                background: rgba(255, 255, 255, 0.8);
                border: 1px solid #dee2e6;
                border-radius: 8px;
            }
            
            .param-column h4 {
                margin: 0 0 10px 0;
                color: #495057;
            }
            
            /* ===== æŒ‰é’®ç»„æ ·å¼ ===== */
            .button-group {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                margin: 15px 0;
            }
            
            /* ===== æç¤ºä¿¡æ¯æ ·å¼ ===== */
            .info-box {
                background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
                border: 2px solid #ffeaa7;
                padding: 15px;
                border-radius: 12px;
                margin-top: 20px;
            }
            
            .info-box .title {
                font-weight: 600;
                color: #856404;
                margin-bottom: 8px;
            }
            
            .info-box .content {
                color: #856404;
                font-size: 14px;
                line-height: 1.5;
            }
            
            /* ===== è¡¨æ ¼æ ·å¼ ===== */
            .data-table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 15px;
                font-size: 12px;
            }
            
            .data-table th,
            .data-table td {
                border: 1px solid #dee2e6;
                padding: 8px;
                text-align: center;
            }
            
            .data-table th {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                font-weight: 600;
                font-size: 1.0em;
            }
            
            .data-table tr:nth-child(even) {
                background: rgba(102, 126, 234, 0.05);
            }
            

            /* ===== å“åº”å¼è®¾è®¡ ===== */
            @media (max-width: 768px) {
                .container {
                    margin: 10px;
                    padding: 15px;
                    margin-top: 70px; /* ä¸ºå›ºå®šçš„ç§»åŠ¨ç«¯èœå•æŒ‰é’®ç•™å‡ºç©ºé—´ */
                }
                
                .tool-switcher {
                    display: none; /* åœ¨ç§»åŠ¨ç«¯éšè—æ¡Œé¢å¯¼èˆª */
                }
                
                .calculator {
                    padding: 20px;
                }
                
                .button-group {
                    flex-direction: column;
                }
                
                .param-group {
                    flex-direction: column;
                }
                
                h1 {
                    font-size: 2em;
                    margin-top: 20px;
                }
            }
            
            /* ===== ç§»åŠ¨ç«¯èœå•æ ·å¼ - ä¸‹æ‹‰èœå•å½¢å¼ ===== */
            .mobile-menu {
                position: fixed;
                top: 71px; /* æŒ‰é’®åº•éƒ¨ä½ç½® */
                left: auto;
                width: 56px; /* ä¸æŒ‰é’®åŒå®½ */
                background: transparent;
                z-index: 999;
                display: block;
                margin: 0 auto;
                left: 50%;
                transform: translateX(-50%);
                animation: slideDown 0.3s ease-out;
            }
            
            .mobile-menu-content {
                background: white;
                border-radius: 0 0 15px 15px; /* é¡¶éƒ¨æ— åœ†è§’ï¼Œä¸æŒ‰é’®è¿æ¥å¤„å¹³æ»‘ */
                padding: 0;
                width: 100%;
                max-height: 70vh;
                overflow-y: auto;
                position: relative;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
                animation: slideDown 0.3s ease-out;
            }
            
            /* ä¸‹æ‹‰åŠ¨ç”» */
            @keyframes slideDown {
                from {
                    opacity: 0;
                    transform: translateX(-50%) translateY(-10px);
                }
                to {
                    opacity: 1;
                    transform: translateX(-50%) translateY(0);
                }
            }
            
            .close-menu-btn {
                position: absolute;
                top: 10px;
                right: 10px;
                background: none;
                border: none;
                font-size: 24px;
                cursor: pointer;
                color: #666;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                transition: var(--transition);
            }
            
            .close-menu-btn:hover {
                background: #f0f0f0;
                color: #333;
            }
            
            .mobile-tool-switcher {
                display: flex;
                flex-direction: column;
                gap: 10px;
                margin-top: 40px;
            }
            
            .mobile-tool-switcher button {
                padding: 15px 20px;
                border: none;
                background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
                color: #333;
                cursor: pointer;
                border-radius: 10px;
                font-weight: 500;
                font-size: 16px;
                transition: var(--transition);
                text-align: left;
            }
            
            .mobile-tool-switcher button:hover {
                transform: translateX(5px);
                background: var(--primary-gradient);
                color: white;
                box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
            }
            
            @keyframes fadeIn {
                from {
                    opacity: 0;
                }
                to {
                    opacity: 1;
                }
            }
            
            @keyframes slideUp {
                from {
                    transform: translateY(20px);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }
            
            /* ===== æ»šåŠ¨æ¡æ ·å¼ ===== */
            ::-webkit-scrollbar {
                width: 8px;
            }
            
            ::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 4px;
            }
            
            ::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                border-radius: 4px;
            }
            
            ::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            }
            
            /* ===== äºŒç»´ç ç”Ÿæˆå™¨æ ·å¼ ===== */
            .qr-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
                margin-top: 20px;
                padding: 0;
            }
            
            .qr-item {
                background: rgba(255, 255, 255, 0.9);
                border: 2px solid #e9ecef;
                border-radius: 12px;
                padding: 15px;
                text-align: center;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                min-width: 0;
                overflow: hidden;
                backdrop-filter: blur(10px);
            }
            
            .qr-item:hover {
                transform: translateY(-5px);
                box-shadow: 0 15px 35px rgba(102, 126, 234, 0.2);
                border-color: #667eea;
            }
            
            .qr-item img {
                max-width: 100%;
                height: auto;
                border-radius: 8px;
                margin-bottom: 10px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            }
            
            .qr-label {
                word-break: break-all;
                line-height: 1.4;
                color: #333;
                font-size: 14px;
                font-weight: 500;
            }
            
            .api-status, .progress-container, .error-message, .success-message {
                margin: 15px 0;
                padding: 12px 16px;
                border-radius: 8px;
                font-size: 14px;
                display: none;
            }
            
            .api-status {
                background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
                border: 2px solid #2196f3;
                color: #1565c0;
            }
            
            .progress-container {
                background: rgba(255, 255, 255, 0.9);
                border: 2px solid #e9ecef;
            }
            
            .progress-bar {
                width: 100%;
                height: 8px;
                background: #f0f0f0;
                border-radius: 4px;
                overflow: hidden;
                margin-bottom: 8px;
            }
            
            .progress-fill {
                height: 100%;
                background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
                width: 0%;
                transition: width 0.3s ease;
                border-radius: 4px;
            }
            
            .progress-text {
                color: #666;
                font-size: 12px;
                text-align: center;
            }
            
            .error-message {
                background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
                border: 2px solid #f44336;
                color: #c62828;
            }
            
            .success-message {
                background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
                border: 2px solid #4caf50;
                color: #2e7d32;
            }
            
            .loading {
                display: inline-block;
                width: 16px;
                height: 16px;
                border: 2px solid rgba(255, 255, 255, 0.3);
                border-radius: 50%;
                border-top-color: #fff;
                animation: spin 1s ease-in-out infinite;
            }
            
            @keyframes spin {
                to { transform: rotate(360deg); }
            }
            
            /* å“åº”å¼æ–­ç‚¹ä¼˜åŒ– */
            @media (max-width: 1400px) {
                .qr-grid {
                    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
                    gap: 12px;
                }
            }
            
            @media (max-width: 1200px) {
                .qr-grid {
                    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                }
            }
            
            @media (max-width: 992px) {
                .qr-grid {
                    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                }
            }
            
            @media (max-width: 768px) {
                .qr-grid {
                    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                    gap: 10px;
                }
                .qr-item {
                    padding: 12px;
                }
                .qr-label {
                    font-size: 12px;
                }
            }
            
            @media (max-width: 576px) {
                .qr-grid {
                    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                    gap: 8px;
                }
                .qr-item {
                    padding: 10px;
                }
                .qr-label {
                    font-size: 11px;
                }
            }
            
            @media (max-width: 480px) {
                .qr-grid {
                    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
                    gap: 6px;
                }
                .qr-item {
                    padding: 8px;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <!-- å³ä¸Šè§’å·¥å…·åˆ‡æ¢æŒ‰é’® -->
            <button id="topToolSwitchBtn" style="position: absolute; top: 15px; right: 80px; padding: 6px 14px; background: var(--primary-gradient); color: white; border: none; border-radius: 18px; cursor: pointer; z-index: 100; font-size: 14px;">
                ğŸ› ï¸ å·¥å…·åˆ—è¡¨
            </button>
            
            <h1 style="font-family:arial;margin-right: 10px;color:#007bff;">âš¡ï¸YLå·¥å…·é›†âš¡ï¸</h1>

            <!-- æ•™ç¨‹ç›®å½•ï¼ˆå¸¦æ”¶èµ·/å±•å¼€åŠŸèƒ½ï¼‰ -->
            <div style="margin: 15px 0;">
                <span>æ•™ç¨‹ç›®å½•ï¼š</span>
                <button id="toggleTutorialBtn" style="margin: 0 10px; padding: 4px 12px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 15px; cursor: pointer;">â–¼</button>
                <div id="tutorialsContainer" style="display: none; margin-top: 10px;">
                    <a href="http://docx.yuelongxinxi.com/login.html" style="font-family:arial;margin-right: 10px;color:black;">ç™»å½•;</a>
                    <a href="http://docx.yuelongxinxi.com/static/views/doc_content/index.html?doc_content_id=63&sign=e21406567970f804d6aef89bd77d6c19" style="font-family:arial;margin-right: 10px;color:black;">å¹³å°æ•™ç¨‹ç›®å½•;</a>
                    <a href="http://docx.yuelongxinxi.com/static/views/doc_content/index.html?doc_content_id=62&sign=9aa417293f0f3753fad23457f5fb6973" style="font-family:arial;margin-left:10px;color:black;">å…¬ä¼—å·æ•™ç¨‹ç›®å½•</a>
                    <a href="http://docx.yuelongxinxi.com/static/views/doc_content/index.html?doc_content_id=134&sign=ef12fc1f6bd4d2491f3db21ab5cd3e3f" style="font-family:arial;margin-left:10px;color:black;">ç¡¬ä»¶äº§å“å¤‡å¿˜å½•</a>
                </div>
            </div>

            <!-- å·¥å…·åˆ‡æ¢åŒºåŸŸï¼ˆå¸¦æ”¶èµ·/å±•å¼€åŠŸèƒ½ï¼‰ -->
            <div style="position: relative;">
                <button id="toggleToolsBtn" style="position: absolute; right: 10px; top: 10px; padding: 4px 12px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 15px; cursor: pointer; z-index: 10;"></button>
                <nav class="tool-switcher" id="mainToolSwitcher">
                <button data-tool-id="pulseTool">ğŸ”„ è„‰å†²è®¡ç®—å™¨</button>
                <button data-tool-id="conversionTool">ğŸ”¢ è¿›åˆ¶è½¬æ¢å™¨</button>
                <button data-tool-id="stockParamTool">ğŸ“¦ å…¥åº“å‚æ•°ç”Ÿæˆ</button>
                <button data-tool-id="paramParser">ğŸ“‹ å…¥åº“å‚æ•°è§£æ</button>
                <button data-tool-id="iccidTool">ğŸ“± ICCIDè¯¦æƒ…</button>
                <button data-tool-id="excelTemplateTool">ğŸ“‹ ICå¡å·å¤„ç†</button>
                <button data-tool-id="serialNumberTool">ğŸ”¢ ç”Ÿæˆæµæ°´å·</button>
                <button data-tool-id="waterValueTool">ğŸ’§ æ´—æµ´å•ä»·</button>
                <button data-tool-id="waterPriceTool">ğŸš° æ°´æ§å•ä»·</button>
                <button data-tool-id="csv89860Tool">ğŸ“Š ä¿®å¤iccidä¹±ç </button>
                <button data-tool-id="qrGeneratorTool">ğŸ”² äºŒç»´ç ç”Ÿæˆå™¨</button>
                <button data-tool-id="logAnalysisTool">ğŸ“Š æ—¥å¿—åˆ†æå™¨</button>
                <button data-tool-id="logAnalysisTool2">ğŸ“Š æ—¥å¿—è§£æå™¨</button>
                <button data-tool-id="qrParserTool">ğŸ” è§£æäºŒç»´ç </button>
            </nav>
            
            <!-- ç§»åŠ¨ç«¯èœå•æŒ‰é’® -->
            <button class="mobile-menu-btn" id="mobileMenuBtn" onclick="toggleMobileMenu()">â˜°</button>
            
            <script>
            // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢å‡½æ•°
            function toggleMobileMenu() {
                const mobileMenu = document.getElementById('mobileMenu');
                // ç»Ÿä¸€ä½¿ç”¨blockæ˜¾ç¤ºæ–¹å¼ï¼Œä¸CSSæ ·å¼ä¿æŒä¸€è‡´
                if (mobileMenu.style.display === 'block') {
                    mobileMenu.style.display = 'none';
                } else {
                    // ç¡®ä¿èœå•ä½ç½®ä»ä¸€å¼€å§‹å°±æ­£ç¡®è®¾ç½®
                    mobileMenu.style.display = 'block';
                }
            }
            
            // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹å…³é—­ç§»åŠ¨èœå•
            document.addEventListener('click', function(event) {
                const mobileMenu = document.getElementById('mobileMenu');
                const mobileMenuBtn = document.getElementById('mobileMenuBtn');
                
                // ç»Ÿä¸€ä½¿ç”¨blockæ˜¾ç¤ºæ–¹å¼æ£€æŸ¥
                if (mobileMenu.style.display === 'block' && 
                    !mobileMenu.contains(event.target) && 
                    event.target !== mobileMenuBtn) {
                    mobileMenu.style.display = 'none';
                }
            });
            </script>

            <!-- ç§»åŠ¨ç«¯èœå•å®¹å™¨ - ä¸‹æ‹‰èœå•å½¢å¼ -->
            <div id="mobileMenu" class="mobile-menu" style="display: none;">
                <div class="mobile-menu-content">
                    <div class="mobile-tool-switcher">
                        <button onclick="showTool('pulseTool'); toggleMobileMenu();" class="mobile-menu-item">è„‰å†²è®¡ç®—å™¨</button>
                        <button onclick="showTool('conversionTool'); toggleMobileMenu();" class="mobile-menu-item">è¿›åˆ¶è½¬æ¢å™¨</button>
                        <button onclick="showTool('stockParamTool'); toggleMobileMenu();" class="mobile-menu-item">å…¥åº“å‚æ•°ç”Ÿæˆ</button>
                        <button onclick="showTool('paramParser'); toggleMobileMenu();" class="mobile-menu-item">å…¥åº“å‚æ•°è§£æ</button>
                        <button onclick="showTool('iccidTool'); toggleMobileMenu();" class="mobile-menu-item">ICCIDè¯¦æƒ…</button>
                        <button onclick="showTool('excelTemplateTool'); toggleMobileMenu();" class="mobile-menu-item">ICå¡å·å¤„ç†</button>
                        <button onclick="showTool('serialNumberTool'); toggleMobileMenu();" class="mobile-menu-item">ç”Ÿæˆæµæ°´å·</button>
                        <button onclick="showTool('waterValueTool'); toggleMobileMenu();" class="mobile-menu-item">æ´—æµ´å•ä»·</button>
                        <button onclick="showTool('waterPriceTool'); toggleMobileMenu();" class="mobile-menu-item">æ°´æ§å•ä»·</button>
                        <button onclick="showTool('csv89860Tool'); toggleMobileMenu();" class="mobile-menu-item">ä¿®å¤iccidä¹±ç </button>
                        <button onclick="showTool('qrGeneratorTool'); toggleMobileMenu();" class="mobile-menu-item">äºŒç»´ç ç”Ÿæˆå™¨</button>
                        <button onclick="showTool('logAnalysisTool'); toggleMobileMenu();" class="mobile-menu-item">æ—¥å¿—åˆ†æå™¨</button>
                        <button onclick="showTool('logAnalysisTool2'); toggleMobileMenu();" class="mobile-menu-item">æ—¥å¿—è§£æå™¨</button>
                        <button onclick="showTool('qrParserTool'); toggleMobileMenu();" class="mobile-menu-item">è§£æäºŒç»´ç </button>
                    </div>
                </div>
            </div>
            
            <!-- å·¥å…·åˆ—è¡¨å¼¹çª— -->
            <div id="toolModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; justify-content: flex-end; align-items: flex-start; backdrop-filter: blur(4px);">
                <div style="background: white; border-radius: 20px 0 20px 20px; padding: 30px 25px 25px; width: 95%; max-width: 400px; max-height: 85vh; overflow-y: auto; margin: 70px 0 0 0; box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3); animation: slideInRight 0.3s ease-out;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="font-size: 20px; font-weight: 600; margin: 0; color: var(--text-primary);">ğŸ› ï¸ å·¥å…·åˆ—è¡¨</h3>
                        <button id="closeToolModalBtn" style="background: var(--primary-color); color: white; border: none; border-radius: 50%; width: 36px; height: 36px; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;">âœ•</button>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button data-tool-id="pulseTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ”„ è„‰å†²è®¡ç®—å™¨</button>
                        <button data-tool-id="conversionTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ”¢ è¿›åˆ¶è½¬æ¢å™¨</button>
                        <button data-tool-id="paramParser" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ“‹ å…¥åº“å‚æ•°è§£æ</button>
                        <button data-tool-id="iccidTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ“± ICCIDè¯¦æƒ…</button>
                        <button data-tool-id="excelTemplateTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ“‹ ICå¡å·å¤„ç†</button>
                        <button data-tool-id="serialNumberTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ”¢ ç”Ÿæˆæµæ°´å·</button>
                        <button data-tool-id="waterValueTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ’§ æ´—æµ´å•ä»·</button>
                        <button data-tool-id="waterPriceTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸš° æ°´æ§å•ä»·</button>
                        <button data-tool-id="csv89860Tool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ“Š ä¿®å¤iccidä¹±ç </button>
                        <button data-tool-id="qrGeneratorTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ”² äºŒç»´ç ç”Ÿæˆå™¨</button>
                        <button data-tool-id="logAnalysisTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ“Š æ—¥å¿—åˆ†æå™¨</button>
                        <button data-tool-id="logAnalysisTool2" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ“Š æ—¥å¿—è§£æå™¨</button>
                        <button data-tool-id="qrParserTool" style="padding: 16px 20px; text-align: left; background: rgba(102, 126, 234, 0.1); border: 2px solid #e9ecef; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">ğŸ” è§£æäºŒç»´ç </button>
                    </div>
                </div>
            </div>

            <!-- ICå¡å·å¤„ç†å·¥å…·æ¨¡å— -->
            <section id="excelTemplateTool" class="calculator">
                <h2>ğŸ“‹ ICå¡å·å¤„ç†</h2>
                <div class="form-group">
                    <label>ä¸Šä¼ Excelæ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°ä¸‹æ–¹ï¼š</label>
                    <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="height: 150px; padding: 8px; font-size: 14px;">
                </div>
                <div class="button-group">
                    <button onclick="processExcelFile()" class="btn-primary" disabled>ğŸ“Š å¤„ç†Excelæ–‡ä»¶</button>
                    <button onclick="clearExcelData()" class="btn-warning">ğŸ—‘ï¸ æ¸…ç©ºæ•°æ®</button>
                </div>
                <div class="form-group">
                    <label>æ•°æ®é¢„è§ˆï¼š</label>
                    <div id="excelDataPreview" class="result-area" style="max-height: 300px; overflow-y: auto;">ç­‰å¾…æ–‡ä»¶ä¸Šä¼ ...</div>
                </div>
                <div class="form-group">
                    <label>ä½¿ç”¨æ¨¡æ¿ï¼š</label>
                    <select id="templateSelect">
                        <option value="icå¡å…¥åº“æ¨¡æ¿.xls" selected>icå¡å…¥åº“æ¨¡æ¿.xls</option>
                    </select>
                    <div id="templateStatus" style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px; font-size: 14px;">ğŸ”„ æ­£åœ¨åŠ è½½è¿œç¨‹æ¨¡æ¿...</div>
                </div>
                <div class="form-group">
                    <label>å¤„ç†çŠ¶æ€ï¼š</label>
                    <div id="excelProcessStatus" class="result-area">è¯·ä¸Šä¼ Excelæ–‡ä»¶å¹¶é€‰æ‹©æ¨¡æ¿</div>
                </div>
                <div class="info-box">
                    <div class="title">ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š</div>
                    <div class="content">
                        â€¢ æ”¯æŒ.xlsxå’Œ.xlsæ ¼å¼çš„Excelæ–‡ä»¶<br>
                        â€¢ ä½¿ç”¨GitHub Pages/Gitee Pagesæ‰˜ç®¡æ¨¡æ¿æ–‡ä»¶ï¼Œç¨³å®šå¯é <br>
                        â€¢ è‡ªåŠ¨è¯†åˆ«Aã€Båˆ—ä¸­çš„æ°´å¡å·ï¼ˆåŒ…å«å­—æ¯ï¼‰å’Œæµæ°´å·ï¼ˆçº¯æ•°å­—ï¼‰<br>
                        â€¢ å¦‚æœé¦–è¡ŒåŒ…å«"æµæ°´å·"ã€"æ°´å¡å·"ç­‰ä¸­æ–‡å­—ç¬¦ï¼Œå°†è·³è¿‡é¦–è¡Œ<br>
                        â€¢ å¤„ç†åçš„æ•°æ®å°†å¡«å…¥è¿œç¨‹æ¨¡æ¿æ–‡ä»¶ä¸­<br>
                        â€¢ æ°´å¡å·å¡«å…¥æ¨¡æ¿Aåˆ—ï¼ˆä»A2å¼€å§‹ï¼‰ï¼Œæµæ°´å·å¡«å…¥Båˆ—ï¼ˆä»B2å¼€å§‹ï¼‰<br><br>
                        ğŸ”§ <strong>é…ç½®æ¨¡æ¿æ–‡ä»¶æ­¥éª¤ï¼š</strong><br>
                        1ï¸âƒ£ åœ¨GitHubä¸Šåˆ›å»ºä¸€ä¸ªå…¬å¼€ä»“åº“<br>
                        2ï¸âƒ£ ä¸Šä¼ `icå¡å…¥åº“æ¨¡æ¿.xls`æ–‡ä»¶åˆ°ä»“åº“æ ¹ç›®å½•<br>
                        3ï¸âƒ£ åœ¨ä»“åº“Settingsä¸­å¯ç”¨GitHub Pages<br>
                        4ï¸âƒ£ è·å–æ¨¡æ¿æ–‡ä»¶çš„å…¬å¼€URLï¼ˆå¦‚ï¼šhttps://username.github.io/repo/icå¡å…¥åº“æ¨¡æ¿.xlsï¼‰<br>
                        5ï¸âƒ£ ä¿®æ”¹ä»£ç ä¸­çš„templateUrlä¸ºå®é™…URL<br><br>
                        ğŸ† <strong>Gitee Pageså¤‡ç”¨æ–¹æ¡ˆï¼ˆå›½å†…è®¿é—®æ›´å¿«ï¼‰ï¼š</strong><br>
                        1ï¸âƒ£ åœ¨Giteeä¸Šåˆ›å»ºä¸€ä¸ªå…¬å¼€ä»“åº“<br>
                        2ï¸âƒ£ ä¸Šä¼ `icå¡å…¥åº“æ¨¡æ¿.xls`æ–‡ä»¶åˆ°ä»“åº“æ ¹ç›®å½•<br>
                        3ï¸âƒ£ åœ¨ä»“åº“çš„"æœåŠ¡"ä¸­é€‰æ‹©"Gitee Pages"<br>
                        4ï¸âƒ£ é€‰æ‹©éƒ¨ç½²åˆ†æ”¯ï¼ˆé€šå¸¸ä¸ºmasterï¼‰ï¼Œç‚¹å‡»"å¯åŠ¨"<br>
                        5ï¸âƒ£ æˆåŠŸåè·å–URLï¼ˆå¦‚ï¼šhttps://username.gitee.io/repo/icå¡å…¥åº“æ¨¡æ¿.xlsï¼‰<br>
                        6ï¸âƒ£ å°†æ­¤URLè®¾ç½®ä¸ºfallbackUrls[0]<br><br>
                        ğŸŒ <strong>å¦‚æœGitee Pagesä¸å¯ç”¨ï¼Œæ›¿ä»£æ–¹æ¡ˆï¼š</strong><br>
                        â€¢ <strong>jsDelivr CDN</strong>: https://cdn.jsdelivr.net/gh/ç”¨æˆ·å/ä»“åº“å/æ–‡ä»¶å<br>
                        â€¢ <strong>GitHub Raw</strong>: https://raw.githubusercontent.com/ç”¨æˆ·å/ä»“åº“å/main/æ–‡ä»¶å<br>
                        â€¢ <strong>Coding.net</strong>: https://ç”¨æˆ·å.coding.net/p/é¡¹ç›®å/d/ä»“åº“å/git/raw/master/æ–‡ä»¶å
                    </div>
                </div>
                <div class="info-box" style="border-color: #007bff; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);">
                    <div class="title" style="color: #1565c0;">ğŸŒ å½“å‰å¤šé‡å¤‡ç”¨é…ç½®ï¼š</div>
                    <div class="content" style="color: #1565c0; font-size: 12px;">
                        â€¢ ä¸»URLï¼š<code>GitHub Raw</code><br>
                        â€¢ å¤‡ç”¨URL 1ï¼š<code>GitHub Pages</code><br>
                        â€¢ å¤‡ç”¨URL 2ï¼š<code>Gitee Pages</code><br>
                        â€¢ å¤‡ç”¨URL 3ï¼š<code>jsDelivr CDN</code><br>
                        â€¢ å¤‡ç”¨URL 4ï¼š<code>Coding.net</code><br>
                        â€¢ çŠ¶æ€ï¼šâœ… å¤šé‡ä¿éšœï¼Œé«˜å¯ç”¨æ€§
                    </div>
                </div>
            </section>
            
            <section id="pulseTool" class="calculator" style="display:none;">
                <h2>ğŸ”„ è„‰å†²å‚æ•°è®¡ç®—å™¨</h2>
                <div class="form-group">
                    <label>ç³»ç»Ÿè®¾ç½®è„‰å†²æ•°ï¼š</label>
                    <input type="number" id="systemPulses" min="0" step="1" placeholder="è¯·è¾“å…¥æ­£æ•´æ•°" >
                </div>
                
                <div class="form-group">
                    <label>ç³»ç»Ÿæ˜¾ç¤ºå‡ºæ°´é‡(ml)ï¼š</label>
                    <input type="number" id="systemWater" min="0" step="0.01" placeholder="è¯·è¾“å…¥æ­£æ•°">
                </div>
                
                <div class="form-group">
                    <label>å®é™…å‡ºæ°´é‡(ml)ï¼š</label>
                    <input type="number" id="actualWater" placeholder="è¯·è¾“å…¥æ­£æ•°">
                </div>
                
                <div class="form-group">
                    <label>å®é™…è„‰å†²æ•°ï¼š</label>
                    <input type="number" id="actualPulses" readonly placeholder="è‡ªåŠ¨è®¡ç®—ç»“æœ">
                </div>
                
                <div class="button-group">
                    <button onclick="calculateActualPulses()" class="btn-primary">ğŸ”¢ è®¡ç®—å®é™…è„‰å†²æ•°</button>
                </div>
            </section>

            <section id="conversionTool" class="calculator" style="display:none;">
                <h2>ğŸ”¢ è¿›åˆ¶è½¬æ¢å·¥å…·</h2>
                <div class="form-group">
                    <label>åè¿›åˆ¶ï¼š</label>
                    <input type="text" id="decimalInput" placeholder="è¾“å…¥0-9æ•°å­—">
                </div>
                
                <div class="form-group">
                    <label>åå…­è¿›åˆ¶ï¼š</label>
                    <input type="text" id="hexInput" placeholder="è¾“å…¥0-9/A-F">
                </div>
            </section>
            
            <section id="paramParser" class="calculator" style="display:none;">
                <h2>ğŸ“‹ å…¥åº“å‚æ•°è§£æå·¥å…·</h2>
                <div class="form-group">
                    <label>å‚æ•°æ–‡æœ¬ï¼š</label>
                    <textarea id="paramInput" placeholder="ç²˜è´´å‚æ•°æ–‡æœ¬... ç¤ºä¾‹ï¼š
    1è„‰å†²1250ï¼Œæ£€ä¿®720ï¼Œå¤§/1é€šé“/çƒ­æ°´è´¹ç‡[å…ƒ/å‡]0.5"></textarea>
                </div>
                <div class="button-group">
                    <button onclick="parseParams()" class="btn-primary">ğŸ” è§£æå‚æ•°</button>
                </div>
                
                <div class="param-results">
                    <div class="param-group">
                        <div class="param-column">
                            <h4>æ ‡å‡†æ ¼å¼ï¼š</h4>
                            <div id="formattedParams"></div>
                        </div>
                    </div>
                </div>
            </section>
            

            
            <!-- ICCIDè¯¦æƒ…å·¥å…·æ¨¡å— -->
            <section id="iccidTool" class="calculator" style="display:none;">
                <h2>ICCIDè¯¦æƒ…å·¥å…·</h2>
                <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px; margin-top: 15px;">
                        <div style="font-weight: 600; color: #856404; margin-bottom: 5px;">ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š</div>
                        <div style="color: #856404; font-size: 14px;">
                            â€¢ æ”¯æŒç²˜è´´ICCIDåŒºé—´èŒƒå›´æ–‡æœ¬ä¾‹ï¼š898604C6062290468489åˆ°898604C6062290468491<br>
                            â€¢ æ”¯æŒå•ä¸ªiccidï¼ˆä¸€è¡Œä¸€ä¸ªï¼‰<br>
                            â€¢ ç‚¹å‡»è·å–å®Œæ•´iccidæŒ‰é’®ï¼Œä¼šå°†åŒºé—´æ‰€æœ‰iccidèŒƒå›´æå–ä¸ºä¸€åˆ—æ•°æ®ã€‚<br>
                            â€¢ ç‚¹å‡»ä¿®æ”¹ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼æŒ‰é’®ï¼Œä¼šåˆ é™¤æ‰€æœ‰æ¢è¡Œã€‚ä½¿ç”¨è‹±æ–‡é€—å·é—´éš”ã€‚<br>
                            â€¢ åœ¨iccidåæ·»åŠ è‹±æ–‡å•å¼•å·ï¼Œç”¨äºé˜²æ­¢ç²˜è´´è‡³excelè‡ªåŠ¨å˜ç§‘å­¦è®¡æ•°ã€‚<br>
                        </div>
                    </div>
                <div class="form-group">
                    <textarea id="iccidInput" placeholder="ç²˜è´´ICCIDèŒƒå›´æ–‡æœ¬... ç¤ºä¾‹ï¼š
    898604C6062290468489åˆ°898604C6062290468491(3å¼ )
    898604C6062290469305åˆ°898604C6062290469309ï¼ˆ5å¼ ï¼‰
    898604D00623D0047511'
    898604D00623D0047313'
    898604D00623D0046269'

    æ”¯æŒåŒæ—¶è§£æä¸¤ç§æ ¼å¼çš„ICCID
    æŒ‰Ctrl+Enterå¯ä»¥æ¢è¡Œ
    " style="width:100%; height:100px; padding:8px; margin-bottom:10px;"></textarea>
                </div>
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <button onclick="parseIccids()" style="background: #007bff; color: white; padding: 8px 20px;">ğŸ” è·å–å®Œæ•´iccid</button>
                    <button onclick="formatIccids()" style="background: #28a745; color: white; padding: 8px 20px;">ğŸ“ ä¿®æ”¹ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼</button>
                    <button onclick="addQuotesToIccids()" style="background: #ffc107; color: black; padding: 8px 20px;">ğŸ”„ é˜²æ­¢ç§‘å­¦è®¡æ•°æ ¼å¼</button>
                </div>
                
                <div class="form-group">
                    <label>è§£æç»“æœï¼š</label>
                    <textarea id="iccidResult" style="width:100%; height:200px; padding:8px;"></textarea>
                </div>
            </section>

            <!-- ç”Ÿæˆæµæ°´å·å·¥å…·æ¨¡å— -->
            <section id="serialNumberTool" class="calculator" style="display:none;">
                <h2>ğŸ”¢ ç”Ÿæˆæµæ°´å·å·¥å…·</h2>
                <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px; margin-top: 15px;">
                    <div style="font-weight: 600; color: #856404; margin-bottom: 5px;">ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š</div>
                    <div style="color: #856404; font-size: 14px;">
                        â€¢ èµ·å§‹æµæ°´å·ä¸ºå¿…å¡«é¡¹ï¼Œé»˜è®¤æ˜¾ç¤ºå½“æ—¥æ—¥æœŸ+001<br>
                        â€¢ æ•°é‡å’Œç»“æŸæµæ°´å·ä»»é€‰å…¶ä¸€å¡«å†™<br>
                        â€¢ ç”ŸæˆæŒ‰é’®ç”¨äºæ ¹æ®è¾“å…¥ç”Ÿæˆå¯¹åº”æ•°é‡çš„æµæ°´å·<br>
                        â€¢ å¤åˆ¶æŒ‰é’®å¯å¤åˆ¶ç”Ÿæˆçš„ç»“æœ<br>
                        â€¢ ä¿®æ”¹ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼ï¼šå°†æ¢è¡Œåˆ†éš”è½¬ä¸ºé€—å·åˆ†éš”<br>
                        â€¢ é˜²æ­¢ç§‘å­¦è®¡æ•°æ ¼å¼ï¼šåœ¨æ¯ä¸ªæµæ°´å·åæ·»åŠ å•å¼•å·
                    </div>
                </div>
                
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <div style="flex:1;">
                        <label>èµ·å§‹æµæ°´å·ï¼š</label>
                        <input type="text" id="startSerialNumber" style="width:100%; padding:8px;">
                    </div>
                    <div style="flex:1;">
                        <label>æ•°é‡ï¼š</label>
                        <input type="number" id="serialNumberCount" max="20000" style="width:100%; padding:8px;">
                    </div>
                    <div style="flex:1;">
                        <label>ç»“æŸæµæ°´å·ï¼š</label>
                        <input type="text" id="endSerialNumber" style="width:100%; padding:8px;">
                    </div>
                </div>
                
                <!-- æç¤ºä¿¡æ¯æ˜¾ç¤ºåŒºåŸŸ -->
                <div id="toolMessage" style="padding:10px; margin-bottom:10px; border-radius:5px; background-color: #f8f9fa; display:none;"></div>
                
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <button onclick="generateSerialNumbers()" style="background: #007bff; color: white; padding: 8px 20px;">ğŸ” ç”Ÿæˆæµæ°´å·</button>
                    <button onclick="copySerialNumbers()" style="background: #6c757d; color: white; padding: 8px 20px;">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
                    <button onclick="formatSerialNumbers()" style="background: #28a745; color: white; padding: 8px 20px;">ğŸ“ ä¿®æ”¹ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼</button>
                    <button onclick="addQuotesToSerialNumbers()" style="background: #ffc107; color: black; padding: 8px 20px;">ğŸ”„ é˜²æ­¢ç§‘å­¦è®¡æ•°æ ¼å¼</button>
                </div>
                
                <div class="form-group">
                    <label>ç”Ÿæˆç»“æœï¼š</label>
                    <textarea id="serialNumberResult" style="width:100%; height:200px; padding:8px;"></textarea>
                </div>
            </section>

            <section id="waterValueTool" class="calculator" style="display:none;">
                <h2>ğŸ’§ æ´—æµ´æ°´æ§ é‡‘é¢æ°´é‡æ¢ç®—</h2>
                <div class="button-group">
                    <button id="clearWaterValueBtn" class="btn-danger">ğŸ—‘ï¸ æ¸…ç©ºæ•°æ®</button>
                </div>
                <div class="form-group">
                    <label>é‡‘é¢ (å…ƒ):</label>
                    <input type="number" id="amount" step="0.01" placeholder="è¾“å…¥é‡‘é¢" oninput="calculateWaterValue()">
                </div>
                <div class="form-group">
                    <label>æ°´é‡ (æ¯«å‡):</label>
                    <input type="number" id="waterVolume" placeholder="è¾“å…¥æ°´é‡" oninput="calculateWaterValue()">
                </div>
                <div class="form-group">
                    <label>1åˆ†é’±å¯¹åº”æ°´é‡ (æ¯«å‡):</label>
                    <input type="number" id="pricePerMl" step="0.01" placeholder="è¾“å…¥1åˆ†é’±å¯¹åº”çš„æ¯«å‡æ•°" oninput="calculateWaterValue()">
                </div>
                <div class="form-group">
                    <label>æ¢ç®—ç»“æœï¼š</label>
                    <div id="waterValueResult" class="result-area">
                        <div id="waterCalculations">è¯·è¾“å…¥ä»»æ„ä¸¤ä¸ªå‚æ•°è¿›è¡Œè®¡ç®—</div>
                    </div>
                </div>
            </section>

            <section id="waterPriceTool" class="calculator" style="display:none;">
                <h2>ğŸš° æ°´æ§å•ä»·</h2>
                <div class="button-group">
                    <button id="clearWaterPriceBtn" class="btn-danger">ğŸ—‘ï¸ æ¸…ç©ºæ•°æ®</button>
                </div>
                <div class="form-group">
                    <label>æ°´é‡ (æ¯«å‡):</label>
                    <input type="number" id="waterVolume2" step="0.01" placeholder="ä¾‹å¦‚ï¼š787" oninput="calculateWaterPrice()">
                </div>
                <div class="form-group">
                    <label>æ¶ˆè´¹é‡‘é¢ (å…ƒ):</label>
                    <input type="number" id="amount2" step="0.0001" placeholder="ä¾‹å¦‚ï¼š0.2385" oninput="calculateWaterPrice()">
                </div>
                <div class="form-group">
                    <label>1å‡æ°´å•ä»· (å…ƒ/å‡):</label>
                    <input type="number" id="pricePerLiter" step="0.0001" placeholder="ä¾‹å¦‚ï¼š0.3030" oninput="calculateWaterPrice()">
                </div>
                <div class="form-group">
                    <label>è®¡ç®—ç»“æœï¼š</label>
                    <div id="waterPriceResult" class="result-area">
                        <div id="waterPriceCalculations">è¯·è¾“å…¥ä»»æ„ä¸¤ä¸ªå‚æ•°è¿›è¡Œè®¡ç®—</div>
                    </div>
                </div>
                

            </section>
            
            <!-- CSV/Excel IMEI/ICCID ç§‘å­¦è®¡æ•°æ³•å¤„ç†å·¥å…·æ¨¡å— -->
            <section id="csv89860Tool" class="calculator" style="display:none;">
                    <h2>ğŸ“Š  IMEI/ICCID ä¹±ç å¤„ç†å·¥å…·</h2>
                    <div class="form-group">
                        <label>ä¸Šä¼ æ–‡ä»¶ï¼ˆæ”¯æŒCSVã€XLSã€XLSXæ ¼å¼ï¼‰ï¼š</label>
                        <input type="file" id="csvFileInput" accept=".csv,.xls,.xlsx" style="height: 150px; padding: 8px; font-size: 14px;">
                    </div>
                    <button onclick="processCSVFile()" disabled>å¤„ç†æ–‡ä»¶</button>
                    <div class="form-group">
                        <label>å¤„ç†çŠ¶æ€ï¼š</label>
                        <div id="csvProcessStatus" style="min-height: 40px;">è¯·é€‰æ‹©æ–‡ä»¶è¿›è¡Œå¤„ç†</div>
                    </div>
                    <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px; margin-top: 15px;">
                        <div style="font-weight: 600; color: #856404; margin-bottom: 5px;">ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š</div>
                        <div style="color: #856404; font-size: 14px;">
                            â€¢ æ”¯æŒCSVã€Excel(.xls/.xlsx)æ ¼å¼æ–‡ä»¶å¤„ç†<br>
                            â€¢ è‡ªåŠ¨åœ¨æ‰€æœ‰"89860"å¼€å¤´çš„å€¼å‰æ·»åŠ è‹±æ–‡å•å¼•å·<br>
                            â€¢ è‡ªåŠ¨åœ¨æ‰€æœ‰"86"å¼€å¤´çš„15ä½æ•°å­—(IMEI)å‰æ·»åŠ è‹±æ–‡å•å¼•å·<br>
                            â€¢ è‡ªåŠ¨åœ¨æ‰€æœ‰é•¿æ•°å­—(å¯èƒ½è¢«Excelè½¬ä¸ºç§‘å­¦è®¡æ•°æ³•)å‰æ·»åŠ è‹±æ–‡å•å¼•å·<br>
                            â€¢ å¤„ç†å®Œæˆåè‡ªåŠ¨ä¸‹è½½ä¿®æ”¹åçš„æ–‡ä»¶
                        </div>
                    </div>
            </section>

        </div>

        <script>
            // å…¨å±€å˜é‡
            let excelData = null;
            let parsedData = { waterCardNumbers: [], serialNumbers: [] };
            let uploadedFileName = '';
            let templateWorkbook = null;
            let loadedTemplates = new Map(); // å­˜å‚¨å·²åŠ è½½çš„æ¨¡æ¿æ–‡ä»¶
            
            // è¿œç¨‹æ¨¡æ¿é…ç½®ï¼ˆå¤šé‡å¤‡ç”¨æ–¹æ¡ˆï¼‰
            const remoteTemplateConfig = {
                // ğŸ”— ä¸»æ–¹æ¡ˆä½¿ç”¨GitHub Rawï¼Œæ›´ç¨³å®šå¯é 
                templateUrl: 'js/icå¡å…¥åº“æ¨¡æ¿.xls',
                templateName: 'icå¡å…¥åº“æ¨¡æ¿.xls',
                // å¤šä¸ªå¤‡ç”¨URLï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
                fallbackUrls: [
                    'https://DDzhp.github.io/ICkamuban/icå¡å…¥åº“æ¨¡æ¿.xls',  // GitHub Pages
                    'https://raw.githubusercontent.com/DDzhp/ICkamuban/main/icå¡å…¥åº“æ¨¡æ¿.xls',  // Gitee Pages
                    'https://cdn.jsdelivr.net/gh/DDzhp/ICkamuban/icå¡å…¥åº“æ¨¡æ¿.xls',  // jsDelivr CDN
                    'https://your-username.coding.net/p/your-project/d/your-repo/git/raw/master/icå¡å…¥åº“æ¨¡æ¿.xls'  // Coding.net
                ]
            };
            
            // ä»è¿œç¨‹URLåŠ è½½æ¨¡æ¿æ–‡ä»¶ï¼ˆæ”¯æŒå¤šé‡å¤‡ç”¨ï¼‰
            async function loadRemoteTemplate() {
                const statusDiv = document.getElementById('templateStatus');
                const { templateUrl, templateName, fallbackUrls } = remoteTemplateConfig;
                
                statusDiv.innerHTML = 'ğŸ”„ æ­£åœ¨ä»è¿œç¨‹æœåŠ¡å™¨åŠ è½½æ¨¡æ¿...';
                
                // æ‰€æœ‰è¦å°è¯•çš„URLåˆ—è¡¨
                const urlsToTry = [templateUrl, ...fallbackUrls];
                let lastError = null;
                
                for (let i = 0; i < urlsToTry.length; i++) {
                    const currentUrl = urlsToTry[i];
                    if (!currentUrl || currentUrl.includes('your-username')) {
                        continue; // è·³è¿‡æœªé…ç½®çš„URL
                    }
                    
                    try {
                        statusDiv.innerHTML = `ğŸ”„ æ­£åœ¨å°è¯•ç¬¬${i + 1}ä¸ªæœåŠ¡å™¨: ${getServerName(currentUrl)}...`;
                        
                        const response = await fetch(currentUrl, {
                            method: 'GET',
                            mode: 'cors',
                            cache: 'default'
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}`);
                        }
                        
                        // è·å–æ–‡ä»¶æ•°æ®
                        const arrayBuffer = await response.arrayBuffer();
                        const data = new Uint8Array(arrayBuffer);
                        
                        // ä½¿ç”¨XLSXè¯»å–æ¨¡æ¿
                        const workbook = XLSX.read(data, { type: 'array' });
                        
                        // éªŒè¯å·¥ä½œç°¿
                        if (!workbook || !workbook.SheetNames || workbook.SheetNames.length === 0) {
                            throw new Error('æ¨¡æ¿æ–‡ä»¶æ ¼å¼æ— æ•ˆ');
                        }
                        
                        // å­˜å‚¨æ¨¡æ¿å·¥ä½œç°¿å’Œæ¥æºä¿¡æ¯
                        loadedTemplates.set(templateName, {
                            workbook: workbook,
                            fileName: templateName,
                            fileData: data,
                            source: `${getServerName(currentUrl)} - ${currentUrl}`,
                            loadedAt: new Date().toISOString()
                        });
                        
                        statusDiv.innerHTML = `âœ… è¿œç¨‹æ¨¡æ¿åŠ è½½æˆåŠŸ: ${templateName}<br>` +
                            `ğŸ“Š åŒ…å« ${workbook.SheetNames.length} ä¸ªå·¥ä½œè¡¨<br>` +
                            `ğŸŒ æ¥æº: ${getServerName(currentUrl)} (ç¬¬${i + 1}ä¸ªæœåŠ¡å™¨)<br>` +
                            `ğŸ”— å½“å‰URL: <code style="font-size:11px;color:#666;">${currentUrl}</code>`;
                        
                        console.log('è¿œç¨‹æ¨¡æ¿åŠ è½½æˆåŠŸ:', {
                            name: templateName,
                            sheets: workbook.SheetNames,
                            size: `${(data.length / 1024).toFixed(2)}KB`,
                            source: currentUrl
                        });
                        
                        // å¯ç”¨å¤„ç†æŒ‰é’®
                        updateProcessButton();
                        
                        return; // æˆåŠŸåé€€å‡º
                        
                    } catch (error) {
                        lastError = error;
                        console.warn(`ç¬¬${i + 1}ä¸ªæœåŠ¡å™¨å¤±è´¥:`, currentUrl, error.message);
                        
                        if (i < urlsToTry.length - 1) {
                            statusDiv.innerHTML = `âš ï¸ ${getServerName(currentUrl)}å¤±è´¥ï¼Œæ­£åœ¨å°è¯•ä¸‹ä¸€ä¸ªæœåŠ¡å™¨...`;
                            await new Promise(resolve => setTimeout(resolve, 1000)); // ç­‰å¾…1ç§’
                        }
                    }
                }
                
                // æ‰€æœ‰URLéƒ½å¤±è´¥
                console.error('æ‰€æœ‰è¿œç¨‹æ¨¡æ¿åŠ è½½å¤±è´¥:', lastError);
                statusDiv.innerHTML = `âŒ æ‰€æœ‰è¿œç¨‹æ¨¡æ¿éƒ½åŠ è½½å¤±è´¥<br>` +
                    `ğŸ“ è¯·æ£€æŸ¥ä»¥ä¸‹äº‹é¡¹ï¼š<br>` +
                    `â€¢ ç¡®ä¿æ¨¡æ¿æ–‡ä»¶å·²æ­£ç¡®ä¸Šä¼ <br>` +
                    `â€¢ æ£€æŸ¥URLé…ç½®æ˜¯å¦æ­£ç¡®<br>` +
                    `â€¢ ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸<br>` +
                    `â€¢ å°è¯•ä½¿ç”¨ä¸‹é¢çš„æ›¿ä»£æ–¹æ¡ˆ<br>` +
                    `ğŸ”— å°è¯•çš„URLåˆ—è¡¨: <details><summary>ç‚¹å‡»æŸ¥çœ‹</summary><pre style="font-size:10px;">${urlsToTry.filter(url => url && !url.includes('your-username')).join('\n')}</pre></details>`;
                
                // ç¦ç”¨å¤„ç†æŒ‰é’®
                updateProcessButton();
            }
            
            // è·å–æœåŠ¡å™¨åç§°
            function getServerName(url) {
                if (url.includes('github.io')) return 'GitHub Pages';
                if (url.includes('gitee.io')) return 'Gitee Pages';
                if (url.includes('coding.net')) return 'Coding.net';
                if (url.includes('jsdelivr.net')) return 'jsDelivr CDN';
                if (url.includes('githubusercontent.com')) return 'GitHub Raw';
                return 'æœªçŸ¥æœåŠ¡å™¨';
            }
            
            // å·¥å…·åˆ‡æ¢å‡½æ•°
            function showTool(toolId) {
                document.querySelectorAll('.calculator').forEach(tool => {
                    tool.style.display = 'none';
                });
                
                document.getElementById(toolId).style.display = 'block';
                
                document.querySelectorAll('.tool-switcher button').forEach(btn => {
                    btn.classList.remove('active');
                });
                // æ‰¾åˆ°å¯¹åº”çš„æŒ‰é’®å¹¶æ·»åŠ activeç±»
                const activeButton = document.querySelector(`.tool-switcher button[onclick="showTool('${toolId}')"]`);
                if (activeButton) {
                    activeButton.classList.add('active');
                }
            }

            // ===== Excelæ¨¡æ¿å¤„ç†ç›¸å…³å‡½æ•° =====
            
            // åŠ è½½æ¨¡æ¿æ–‡ä»¶åˆ—è¡¨
            const templatePath = 'icå¡å…¥åº“æ¨¡æ¿.xls';
            // åŠ è½½æŒ‡å®šè·¯å¾„çš„æ¨¡æ¿
            async function loadSpecificTemplate() {
                const templateName = 'icå¡å…¥åº“æ¨¡æ¿.xls';
                const statusDiv = document.getElementById('templateStatus');
                
                try {
                    // é¦–å…ˆå°è¯•ä»æŒ‡å®šç»å¯¹è·¯å¾„åŠ è½½æ¨¡æ¿æ–‡ä»¶
                    let response;
                    let usedPath;
                    
                    try {
                        response = await fetch(templatePath);
                        usedPath = templatePath;
                    } catch (error) {
                        // ç»å¯¹è·¯å¾„å¤±è´¥ï¼Œå°è¯•ç›¸å¯¹è·¯å¾„
                        response = await fetch(templateName);
                        usedPath = templateName;
                    }
                    
                    if (!response.ok) {
                        throw new Error(`æ— æ³•åŠ è½½æ¨¡æ¿æ–‡ä»¶: ${response.status}`);
                    }
                    
                    const arrayBuffer = await response.arrayBuffer();
                    const data = new Uint8Array(arrayBuffer);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // å­˜å‚¨æ¨¡æ¿å·¥ä½œç°¿
                    loadedTemplates.set(templateName, {
                        workbook: workbook,
                        fileName: templateName,
                        fileData: data
                    });
                    
                    statusDiv.innerHTML = `âœ… å·²æˆåŠŸåŠ è½½æ¨¡æ¿: ${usedPath}`;
                    
                } catch (error) {
                    console.error('åŠ è½½æ¨¡æ¿å¤±è´¥:', error);
                    statusDiv.innerHTML = `âš ï¸ åŠ è½½æ¨¡æ¿å¤±è´¥: ${error.message}<br>è¯·ç¡®ä¿æœ¬åœ°æœåŠ¡å™¨è¿è¡Œä¸”æ¨¡æ¿æ–‡ä»¶å¯è®¿é—®: ${templatePath}`;
                }
            }
            async function loadTemplateList() {
                // å¦‚æœå·²ç»æœ‰åŠ è½½çš„æ¨¡æ¿ï¼Œæ˜¾ç¤ºå®ƒä»¬
                if (loadedTemplates.size > 0) {
                    renderTemplateOptions();
                } else {
                    // æç¤ºç”¨æˆ·åŠ è½½æ¨¡æ¿
                    const statusDiv = document.getElementById('excelProcessStatus');
                    statusDiv.innerHTML = 'è¯·ç‚¹å‡»â€œåŠ è½½æ¨¡æ¿æ–‡ä»¶å¤¹â€æŒ‰é’®æ¥é€‰æ‹©æ¨¡æ¿æ–‡ä»¶';
                }
            }
            
            // å¤„ç†æ¨¡æ¿æ–‡ä»¶ä¸Šä¼ 
            function handleTemplateUpload(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const statusDiv = document.getElementById('excelProcessStatus');
                statusDiv.innerHTML = 'æ­£åœ¨åŠ è½½æ¨¡æ¿æ–‡ä»¶...';
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        templateWorkbook = XLSX.read(data, { type: 'array' });
                        
                        // æ›´æ–°é€‰æ‹©æ¡†æ˜¾ç¤ºå·²ä¸Šä¼ çš„æ¨¡æ¿
                        const select = document.getElementById('templateSelect');
                        const uploadedOption = document.createElement('option');
                        uploadedOption.value = 'uploaded';
                        uploadedOption.textContent = `ğŸ“„ ${file.name} (å·²ä¸Šä¼ )`;
                        uploadedOption.selected = true;
                        
                        // ç§»é™¤ä¹‹å‰çš„ä¸Šä¼ é€‰é¡¹
                        const existingUploaded = select.querySelector('option[value="uploaded"]');
                        if (existingUploaded) {
                            existingUploaded.remove();
                        }
                        
                        select.appendChild(uploadedOption);
                        
                        statusDiv.innerHTML = `æ¨¡æ¿æ–‡ä»¶ "${file.name}" åŠ è½½æˆåŠŸ`;
                        updateProcessButton();
                        
                    } catch (error) {
                        statusDiv.innerHTML = `æ¨¡æ¿æ–‡ä»¶åŠ è½½å¤±è´¥: ${error.message}`;
                        templateWorkbook = null;
                    }
                };
                
                reader.readAsArrayBuffer(file);
            }
            
            // è¯»å–Excelæ–‡ä»¶
            function readExcelFile(file) {
                const statusDiv = document.getElementById('excelProcessStatus');
                const previewDiv = document.getElementById('excelDataPreview');
                
                // ä¿å­˜ä¸Šä¼ æ–‡ä»¶å
                uploadedFileName = file.name;
                
                statusDiv.innerHTML = 'æ­£åœ¨è¯»å–Excelæ–‡ä»¶...';
                previewDiv.innerHTML = 'æ­£åœ¨è§£ææ–‡ä»¶å†…å®¹...';
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        
                        // è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
                        const firstSheetName = workbook.SheetNames[0];
                        const worksheet = workbook.Sheets[firstSheetName];
                        
                        // è½¬æ¢ä¸ºJSON
                        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        
                        excelData = jsonData;
                        analyzeExcelData(jsonData);
                        
                    } catch (error) {
                        statusDiv.innerHTML = `è¯»å–æ–‡ä»¶å¤±è´¥: ${error.message}`;
                        previewDiv.innerHTML = 'æ–‡ä»¶è§£æå¤±è´¥';
                    }
                };
                
                reader.readAsArrayBuffer(file);
            }
            
            // åˆ†æExcelæ•°æ®
            function analyzeExcelData(data) {
                const statusDiv = document.getElementById('excelProcessStatus');
                const previewDiv = document.getElementById('excelDataPreview');
                
                try {
                    if (!data || data.length === 0) {
                        statusDiv.innerHTML = 'æ–‡ä»¶ä¸ºç©ºæˆ–æ— æœ‰æ•ˆæ•°æ®';
                        return;
                    }
                    
                    let startRow = 0;
                    let waterCardCol = -1;
                    let serialCol = -1;
                    
                    // æ£€æŸ¥é¦–è¡Œæ˜¯å¦åŒ…å«ä¸­æ–‡å­—ç¬¦
                    const firstRow = data[0] || [];
                    const hasChineseInFirstRow = firstRow.some(cell => 
                        cell && /[\u4e00-\u9fa5]/.test(cell.toString())
                    );
                    
                    if (hasChineseInFirstRow) {
                        startRow = 1;
                        statusDiv.innerHTML = 'æ£€æµ‹åˆ°é¦–è¡ŒåŒ…å«ä¸­æ–‡ï¼Œå°†ä»ç¬¬äºŒè¡Œå¼€å§‹å¤„ç†';
                    } else {
                        startRow = 0;
                        statusDiv.innerHTML = 'é¦–è¡Œä¸åŒ…å«ä¸­æ–‡ï¼Œä»ç¬¬ä¸€è¡Œå¼€å§‹å¤„ç†';
                    }
                    
                    // åˆ†æAã€Båˆ—æ•°æ®ç±»å‹
                    const sampleSize = Math.min(10, data.length - startRow);
                    let colAHasLetters = false;
                    let colBHasLetters = false;
                    
                    for (let i = startRow; i < startRow + sampleSize && i < data.length; i++) {
                        const row = data[i];
                        if (row && row.length >= 2) {
                            const cellA = row[0] ? row[0].toString() : '';
                            const cellB = row[1] ? row[1].toString() : '';
                            
                            if (/[a-zA-Z]/.test(cellA)) colAHasLetters = true;
                            if (/[a-zA-Z]/.test(cellB)) colBHasLetters = true;
                        }
                    }
                    
                    // æ ¹æ®è§„åˆ™ç¡®å®šåˆ—ç±»å‹
                    if (colAHasLetters && !colBHasLetters) {
                        waterCardCol = 0;
                        serialCol = 1;
                    } else if (colBHasLetters && !colAHasLetters) {
                        waterCardCol = 1;
                        serialCol = 0;
                    } else if (colAHasLetters && colBHasLetters) {
                        // ä¸¤åˆ—éƒ½æœ‰å­—æ¯ï¼Œé»˜è®¤Aåˆ—ä¸ºæ°´å¡å·
                        waterCardCol = 0;
                        serialCol = 1;
                    } else {
                        // éƒ½æ˜¯çº¯æ•°å­—ï¼Œé»˜è®¤Aåˆ—ä¸ºæµæ°´å·ï¼ŒBåˆ—ä¸ºæ°´å¡å·
                        serialCol = 0;
                        waterCardCol = 1;
                    }
                    
                    // æå–æ•°æ®
                    const waterCards = [];
                    const serials = [];
                    
                    for (let i = startRow; i < data.length; i++) {
                        const row = data[i];
                        if (row && row.length >= 2) {
                            if (waterCardCol >= 0 && row[waterCardCol]) {
                                waterCards.push(row[waterCardCol].toString());
                            }
                            if (serialCol >= 0 && row[serialCol]) {
                                // æ¸…ç†æµæ°´å·ï¼Œç§»é™¤"NO."å‰ç¼€
                                const rawSerial = row[serialCol].toString();
                                const cleanedSerial = rawSerial.replace(/^NO\./i, '').trim();
                                serials.push(cleanedSerial);
                            }
                        }
                    }
                    
                    parsedData = {
                        waterCardNumbers: waterCards,
                        serialNumbers: serials
                    };
                    
                    // æ˜¾ç¤ºé¢„è§ˆ
                    let preview = `<p>æ•°æ®è§£æç»“æœï¼š</p>`;
                    preview += `<p><text>å¼€å§‹è¡Œï¼šç¬¬${startRow + 1}è¡Œ</text>`;
                    preview += `<text>;æ°´å¡å·åˆ—ï¼š${String.fromCharCode(65 + waterCardCol)}åˆ— (${waterCards.length}æ¡)</text>`;
                    preview += `<text>;æµæ°´å·åˆ—ï¼š${String.fromCharCode(65 + serialCol)}åˆ— (${serials.length}æ¡)</text></p>`;
                    
                    preview += `<table class="data-table">`;
                    preview += `<tr><th>åºå·</th><th>æ°´å¡å·</th><th>æµæ°´å·</th></tr>`;
                    
                    const maxRows = Math.min(10, Math.max(waterCards.length, serials.length));
                    for (let i = 0; i < maxRows; i++) {
                        preview += `<tr>`;
                        preview += `<td>${i + 1}</td>`;
                        preview += `<td>${waterCards[i] || ''}</td>`;
                        preview += `<td>${serials[i] || ''}</td>`;
                        preview += `</tr>`;
                    }
                    
                    if (Math.max(waterCards.length, serials.length) > 10) {
                        preview += `<tr><td colspan="3">... è¿˜æœ‰ ${Math.max(waterCards.length, serials.length) - 10} è¡Œæ•°æ®</td></tr>`;
                    }
                    
                    preview += `</table>`;
                    
                    previewDiv.innerHTML = preview;
                    statusDiv.innerHTML = `æ•°æ®è§£æå®Œæˆï¼å…±è¯†åˆ«åˆ° ${waterCards.length} ä¸ªæ°´å¡å·å’Œ ${serials.length} ä¸ªæµæ°´å·`;
                    
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    updateProcessButton();
                    
                } catch (error) {
                    statusDiv.innerHTML = `æ•°æ®åˆ†æå¤±è´¥: ${error.message}`;
                    previewDiv.innerHTML = 'æ•°æ®åˆ†æå¤±è´¥';
                }
            }
            
            // å¤„ç†Excelæ–‡ä»¶
            async function processExcelFile() {
                const statusDiv = document.getElementById('excelProcessStatus');
                const templateName = document.getElementById('templateSelect').value;
                
                if (!excelData || !templateName) {
                    statusDiv.innerHTML = 'è¯·ç¡®ä¿å·²ä¸Šä¼ æ–‡ä»¶å¹¶é€‰æ‹©æ¨¡æ¿';
                    return;
                }
                
                if (!loadedTemplates.has(templateName)) {
                    statusDiv.innerHTML = 'é€‰ä¸­çš„æ¨¡æ¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°åŠ è½½æ¨¡æ¿';
                    return;
                }
                
                try {
                    statusDiv.innerHTML = 'ğŸ”„ æ­£åœ¨ä½¿ç”¨æ¨¡æ¿å¤„ç†æ•°æ®...';
                    
                    // è·å–æ¨¡æ¿å·¥ä½œç°¿å’Œæ¥æºä¿¡æ¯
                    const templateInfo = loadedTemplates.get(templateName);
                    const templateWorkbook = templateInfo.workbook;
                    const templateSource = templateInfo.source || 'æœ¬åœ°ç¼“å­˜';
                    
                    // ä½¿ç”¨æ¨¡æ¿å¤„ç†æ•°æ®
                    const result = await processWithTemplate(templateWorkbook, templateName, templateSource);
                    
                    if (result.success) {
                        statusDiv.innerHTML = `âœ… æ–‡ä»¶å¤„ç†å®Œæˆï¼<br>` +
                            `â€¢ ä½¿ç”¨æ¨¡æ¿ï¼š${templateName}<br>` +
                            `â€¢ æ¨¡æ¿æ¥æºï¼š${templateSource}<br>` +
                            `â€¢ å·²ä¸‹è½½æ–‡ä»¶ï¼š${result.filename}<br>` +
                            `â€¢ æ°´å¡å·ï¼š${parsedData.waterCardNumbers.length}æ¡ï¼Œæµæ°´å·ï¼š${parsedData.serialNumbers.length}æ¡<br>` +
                            `â€¢ æ•°æ®å·²å¡«å…¥æ¨¡æ¿Aåˆ—å’ŒBåˆ—ï¼ˆä»A2ã€B2å¼€å§‹ï¼‰`;
                    } else {
                        statusDiv.innerHTML = `âŒ å¤„ç†å¤±è´¥ï¼š${result.error}`;
                    }
                    
                } catch (error) {
                    statusDiv.innerHTML = `âŒ å¤„ç†å¤±è´¥: ${error.message}`;
                    console.error('å¤„ç†Excelæ–‡ä»¶å¤±è´¥:', error);
                }
            }
            
            // ä½¿ç”¨æ¨¡æ¿å¤„ç†æ•°æ®
            async function processWithTemplate(templateWorkbook, templateName, templateSource) {
                try {
                    // å…‹éš†æ¨¡æ¿å·¥ä½œç°¿
                    const newWorkbook = XLSX.utils.book_new();
                    
                    // å¤åˆ¶æ¨¡æ¿çš„æ‰€æœ‰å·¥ä½œè¡¨
                    templateWorkbook.SheetNames.forEach(sheetName => {
                        const originalSheet = templateWorkbook.Sheets[sheetName];
                        
                        // å¤åˆ¶åŸå·¥ä½œè¡¨çš„æ•°æ®
                        const sheetData = XLSX.utils.sheet_to_json(originalSheet, { header: 1, defval: '' });
                        
                        // åœ¨A2å’ŒB2ä½ç½®å¼€å§‹å¡«å…¥æ•°æ®
                        const maxRows = Math.max(parsedData.waterCardNumbers.length, parsedData.serialNumbers.length);
                        
                        // ç¡®ä¿æœ‰è¶³å¤Ÿçš„è¡Œæ•°
                        while (sheetData.length < maxRows + 1) {
                            sheetData.push([]);
                        }
                        
                        // å¡«å…¥æ•°æ®åˆ°Aåˆ—å’ŒBåˆ—ï¼ˆä»A2ã€B2å¼€å§‹ï¼‰
                        for (let i = 0; i < maxRows; i++) {
                            const rowIndex = i + 1; // ä»ç¬¬2è¡Œå¼€å§‹ï¼ˆ0-basedç´¢å¼•ï¼‰
                            
                            // ç¡®ä¿è¡Œå­˜åœ¨
                            if (!sheetData[rowIndex]) {
                                sheetData[rowIndex] = [];
                            }
                            
                            // å¡«å…¥Aåˆ—ï¼ˆæ°´å¡å·ï¼‰
                            if (parsedData.waterCardNumbers[i]) {
                                // sheetData[rowIndex][0] = parsedData.waterCardNumbers[i];
                                if(parsedData.waterCardNumbers[i].length != 8 ){
                                    alert(`ç¬¬${i+1}è¡Œæ°´å¡(ICå¡)å·é•¿åº¦å¿…é¡»ä¸º8ä¸ªå­—ç¬¦ï¼Œè¯·æ£€æŸ¥ï¼`);return;
                                }else{
                                    sheetData[rowIndex][0] = parsedData.waterCardNumbers[i];
                                }
                            }
                            
                            // å¡«å…¥Båˆ—ï¼ˆæµæ°´å·ï¼‰ï¼Œå†æ¬¡æ¸…ç†"NO."å‰ç¼€ç¡®ä¿æ•°æ®å¹²å‡€
                            if (parsedData.serialNumbers[i]) {
                                const rawSerial = parsedData.serialNumbers[i].toString();
                                const cleanedSerial = rawSerial.replace(/^NO\./i, '').trim();
                                if(cleanedSerial.length < 1 ||cleanedSerial.length >12){
                                    alert(`ç¬¬${i+1}è¡Œæµæ°´å·é•¿åº¦å¿…é¡»åœ¨1-12ä¸ªå­—ç¬¦ä¹‹é—´ï¼Œè¯·æ£€æŸ¥ï¼`);return;
                                }else{
                                    sheetData[rowIndex][1] = cleanedSerial;
                                }
                                // sheetData[rowIndex][1] = cleanedSerial;
                            }
                        }
                        
                        // åˆ›å»ºæ–°çš„å·¥ä½œè¡¨
                        const newSheet = XLSX.utils.aoa_to_sheet(sheetData);
                        
                        // å¤åˆ¶åŸå§‹å·¥ä½œè¡¨çš„å…¶ä»–å±æ€§ï¼ˆå¦‚åˆ—å®½ã€æ ¼å¼ç­‰ï¼‰
                        if (originalSheet['!cols']) {
                            newSheet['!cols'] = originalSheet['!cols'];
                        }
                        if (originalSheet['!rows']) {
                            newSheet['!rows'] = originalSheet['!rows'];
                        }
                        if (originalSheet['!merges']) {
                            newSheet['!merges'] = originalSheet['!merges'];
                        }
                        
                        XLSX.utils.book_append_sheet(newWorkbook, newSheet, sheetName);
                    });
                    
                    // ç”Ÿæˆæ–‡ä»¶å¹¶ä¸‹è½½
                    const originalName = uploadedFileName;
                    const extension = originalName.lastIndexOf('.') >= 0 ? originalName.slice(originalName.lastIndexOf('.')) : '.xlsx';
                    const baseName = originalName.lastIndexOf('.') >= 0 ? originalName.slice(0, originalName.lastIndexOf('.')) : originalName;
                    const filename = `${baseName}_å·²å¤„ç†${extension}`;
                    XLSX.writeFile(newWorkbook, filename);
                    
                    return {
                        success: true,
                        filename: filename,
                        templateSource: templateSource
                    };
                    
                } catch (error) {
                    return {
                        success: false,
                        error: error.message
                    };
                }
            }
            
            // ä½¿ç”¨é»˜è®¤æ¨¡æ¿å¤„ç†
            function processWithDefaultTemplate() {
                const statusDiv = document.getElementById('excelProcessStatus');
                
                try {
                    // åˆ›å»ºæ–°çš„å·¥ä½œç°¿
                    const newWorkbook = XLSX.utils.book_new();
                    
                    // åˆ›å»ºå·¥ä½œè¡¨æ•°æ®
                    const wsData = [];
                    
                    // æ·»åŠ æ ‡é¢˜è¡Œ
                    wsData.push(['æ°´å¡å·', 'æµæ°´å·']);
                    
                    // æ·»åŠ æ•°æ®è¡Œ
                    const maxRows = Math.max(parsedData.waterCardNumbers.length, parsedData.serialNumbers.length);
                    for (let i = 0; i < maxRows; i++) {
                        // æ¸…ç†æµæ°´å·ï¼Œç§»é™¤"NO."å‰ç¼€
                        const rawSerial = parsedData.serialNumbers[i] || '';
                        const cleanedSerial = rawSerial.toString().replace(/^NO\./i, '').trim();
                        wsData.push([
                            parsedData.waterCardNumbers[i] || '',
                            cleanedSerial
                        ]);
                    }
                    
                    // åˆ›å»ºå·¥ä½œè¡¨
                    const worksheet = XLSX.utils.aoa_to_sheet(wsData);
                    
                    // æ·»åŠ å·¥ä½œè¡¨åˆ°å·¥ä½œç°¿
                    XLSX.utils.book_append_sheet(newWorkbook, worksheet, 'Sheet1');
                    
                    // ç”Ÿæˆæ–‡ä»¶å¹¶ä¸‹è½½
                    const originalName = uploadedFileName;
                    const extension = originalName.lastIndexOf('.') >= 0 ? originalName.slice(originalName.lastIndexOf('.')) : '.xlsx';
                    const baseName = originalName.lastIndexOf('.') >= 0 ? originalName.slice(0, originalName.lastIndexOf('.')) : originalName;
                    const filename = `${baseName}å·²å¤„ç†${extension}`;
                    XLSX.writeFile(newWorkbook, filename);
                    
                    statusDiv.innerHTML = `æ–‡ä»¶å¤„ç†å®Œæˆï¼<br>` +
                        `â€¢ ä½¿ç”¨é»˜è®¤æ¨¡æ¿<br>` +
                        `â€¢ å·²ä¸‹è½½æ–‡ä»¶ï¼š${filename}<br>` +
                        `â€¢ æ°´å¡å·ï¼š${parsedData.waterCardNumbers.length}æ¡ï¼Œæµæ°´å·ï¼š${parsedData.serialNumbers.length}æ¡`;
                    
                } catch (error) {
                    statusDiv.innerHTML = `é»˜è®¤æ¨¡æ¿å¤„ç†å¤±è´¥: ${error.message}`;
                }
            }
            
            // æ¸…ç©ºæ•°æ®
            function clearExcelData() {
                excelData = null;
                parsedData = { waterCardNumbers: [], serialNumbers: [] };
                uploadedFileName = '';
                templateWorkbook = null;
                document.getElementById('excelFileInput').value = '';
                document.getElementById('templateSelect').value = '';
                document.getElementById('templateFileInput').value = '';
                
                // ç§»é™¤ä¸Šä¼ çš„æ¨¡æ¿é€‰é¡¹
                const select = document.getElementById('templateSelect');
                const uploadedOption = select.querySelector('option[value="uploaded"]');
                if (uploadedOption) {
                    uploadedOption.remove();
                }
                
                document.getElementById('excelProcessStatus').innerHTML = 'è¯·ä¸Šä¼ Excelæ–‡ä»¶å¹¶é€‰æ‹©æ¨¡æ¿';
                document.getElementById('excelDataPreview').innerHTML = 'ç­‰å¾…æ–‡ä»¶ä¸Šä¼ ...';
                updateProcessButton();
            }
            
            // æ›´æ–°å¤„ç†æŒ‰é’®çŠ¶æ€
            function updateProcessButton() {
                const hasFile = excelData !== null;
                const hasTemplate = document.getElementById('templateSelect').value !== '' && loadedTemplates.has('icå¡å…¥åº“æ¨¡æ¿.xls');
                const processButton = document.querySelector('#excelTemplateTool .btn-primary');
                processButton.disabled = !(hasFile && hasTemplate);
                
                // æ›´æ–°æŒ‰é’®æ–‡æœ¬æ˜¾ç¤ºå½“å‰çŠ¶æ€
                if (processButton.disabled) {
                    if (!hasFile) {
                        processButton.textContent = 'ğŸ“Š è¯·å…ˆä¸Šä¼ Excelæ–‡ä»¶';
                    } else if (!hasTemplate) {
                        processButton.textContent = 'ğŸ“Š æ­£åœ¨åŠ è½½æ¨¡æ¿...';
                    }
                } else {
                    processButton.textContent = 'ğŸ“Š å¤„ç†Excelæ–‡ä»¶';
                }
            }

            // åè¿›åˆ¶è½¬åå…­è¿›åˆ¶å‡½æ•°
            function convertDecToHex() {
                const decimalValue = document.getElementById('decimalInput').value;
                if (/^\d+$/.test(decimalValue)) {
                    const hex = parseInt(decimalValue).toString(16).toUpperCase();
                    document.getElementById('hexInput').value = hex;
                    showMessage(`å·²æˆåŠŸè½¬æ¢ ${decimalValue} ä¸ºåå…­è¿›åˆ¶ ${hex}`, 'success');
                } else if (decimalValue.trim()) {
                    document.getElementById('hexInput').value = '';
                    showMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„åè¿›åˆ¶æ•°å­—', 'error');
                }
            }

            // åå…­è¿›åˆ¶è½¬åè¿›åˆ¶å‡½æ•°
            function convertHexToDec() {
                const hexValue = document.getElementById('hexInput').value;
                if (/^[0-9A-Fa-f]+$/.test(hexValue)) {
                    const decimal = parseInt(hexValue, 16);
                    document.getElementById('decimalInput').value = decimal;
                    showMessage(`å·²æˆåŠŸè½¬æ¢åå…­è¿›åˆ¶ ${hexValue.toUpperCase()} ä¸ºåè¿›åˆ¶ ${decimal}`, 'success');
                } else if (hexValue.trim()) {
                    document.getElementById('decimalInput').value = '';
                    showMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„åå…­è¿›åˆ¶æ•°å­—ï¼ˆ0-9, A-Fï¼‰', 'error');
                }
            }

            // è„‰å†²è®¡ç®—ä¸»å‡½æ•°
            function calculateActualPulses() {
                const systemPulses = parseFloat(document.getElementById('systemPulses').value);
                const systemWater = parseFloat(document.getElementById('systemWater').value);
                const actualWater = parseFloat(document.getElementById('actualWater').value);
                
                if (isNaN(systemPulses) || isNaN(systemWater) || isNaN(actualWater)) {
                    document.getElementById('actualPulses').value = '';
                    showMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—', 'error');
                    return;
                }
                
                if (systemPulses > 0 && systemWater > 0 && actualWater > 0) {
                    const actualPulses = (systemPulses * systemWater) / actualWater;
                    document.getElementById('actualPulses').value = actualPulses.toFixed(2);
                    showMessage('è„‰å†²è®¡ç®—æˆåŠŸ', 'success');
                } else {
                    document.getElementById('actualPulses').value = '';
                    if (systemPulses <= 0 || isNaN(systemPulses)) {
                        showMessage('è¯·è¾“å…¥å¤§äº0çš„ç³»ç»Ÿè„‰å†²æ•°', 'error');
                    } else if (systemWater <= 0 || isNaN(systemWater)) {
                        showMessage('è¯·è¾“å…¥å¤§äº0çš„ç³»ç»Ÿæ°´é‡', 'error');
                    } else if (actualWater <= 0 || isNaN(actualWater)) {
                        showMessage('è¯·è¾“å…¥å¤§äº0çš„å®é™…æ°´é‡', 'error');
                    }
                }
            }


            // å…¥åº“å‚æ•°è§£æå‡½æ•°ï¼ˆå®Œå–„ç‰ˆï¼‰
            function parseParams() {
                const inputText = document.getElementById('paramInput').value;
                
                // åˆ›å»ºç»“æœå¯¹è±¡
                const result = {
                    rawItems: [],
                    formattedItems: [],
                    jsonData: {}
                };
            
                // æ–°å¢å…¬å¸åç§°åŒ¹é…è§„åˆ™
                const companyMatch = inputText.match(/^([\s\S]*?)\s*è·ƒé¾™/);
                let processedText = inputText;
                const rawItems = [];
                const formattedItems = [];
            
                // æå–å…¬å¸åç§°
                if (companyMatch) {
                    const company = companyMatch[1].trim().replace(/\s+/g, ' ');
                    rawItems.push(`å…¬å¸=${company}`);
                    formattedItems.push(`å…¬å¸ï¼š${company}`);
                    processedText = processedText.replace(companyMatch[0], ''); // ç§»é™¤å·²åŒ¹é…å†…å®¹
                }
            
                // ä¼˜åŒ–è·ƒé¾™ç±»å‹åˆ¤æ–­é€»è¾‘
                const yuelongTypes = [
                    { pattern: 'è·ƒé¾™æ–°ç§æœ‰', value: 'æ–°ç§æœ‰' },
                    { pattern: 'è·ƒé¾™å…¬æœ‰å”®æ°´æœº', value: 'å…¬æœ‰å”®æ°´æœº' },
                    { pattern: 'è·ƒé¾™æ–°å…¬æœ‰', value: 'æ–°å…¬æœ‰' },
                    { pattern: 'è·ƒé¾™å…¬æœ‰', value: 'å…¬æœ‰' },
                    { pattern: 'è·ƒé¾™ç§æœ‰', value: 'ç§æœ‰' }
                ];
                
                // ä¿®æ”¹ä¸ºä½¿ç”¨åŸå§‹è¾“å…¥æ–‡æœ¬åˆ¤æ–­
                yuelongTypes.forEach(type => {
                    if (inputText.includes(type.pattern)) {
                        rawItems.push(`è·ƒé¾™ç±»å‹=${type.value}`);
                        formattedItems.push(`è·ƒé¾™ç±»å‹ï¼š${type.value}`);
                    }
                });

                // ä¼˜åŒ–ICCIDåŒ¹é…
                const iccidMatches = [...processedText.matchAll(/(89860[\dA-Za-z]{14,18})/g)];
                const iccids = iccidMatches.map(m => m[0]);
                
                // åªå¤„ç†ç¬¬ä¸€ä¸ªICCID
                if (iccids.length > 0) {
                    rawItems.push(`ICCIDå¼€å§‹=${iccids[0]}`);
                    formattedItems.push(`ICCIDå¼€å§‹ï¼š${iccids[0]}`);
                }
                // ç§»é™¤æ‰€æœ‰ICCID
                iccids.forEach(iccid => {
                    processedText = processedText.replace(iccid, '');
                });

                // ä¼˜åŒ–åçš„æ•°é‡æå–è§„åˆ™ï¼ˆæ”¯æŒä¸­æ–‡ç¬¦å·é—´éš”ï¼‰
                const quantityMatch = processedText.match(/(\d+)\s*å¼ (?=\D*$)/);
                if (quantityMatch) {
                    rawItems.push(`æ•°é‡=${quantityMatch[1]}`);
                    formattedItems.push(`æ•°é‡ï¼š${quantityMatch[1]}`);
                    processedText = processedText.replace(quantityMatch[0], '');
                }
            
                // æ–°å¢é¢„å¤„ç†ï¼šè¿‡æ»¤"å…¶ä¸­"ç›¸å…³å†…å®¹
                processedText = processedText.replace(/å…¶ä¸­\D*(\d+)[\u4e00-\u9fa5]+/g, '');
            
                // æ–°å¢æ»¤èŠ¯å¯¿å‘½åˆ¤æ–­
                let filterType = 'ç©º';
                if (/æ—¶é—´/.test(processedText)) {
                    filterType = '0æ—¶é—´';
                } else if (/æµé‡/.test(processedText)) {
                    filterType = '1æµé‡';
                }
                rawItems.push(`æ»¤èŠ¯å¯¿å‘½=${filterType}`);
                formattedItems.push(`æ»¤èŠ¯å¯¿å‘½ï¼š${filterType}`);

                // ä¼˜åŒ–åçš„å‚æ•°è§£æé€»è¾‘ï¼ˆå…¼å®¹è·¯å¾„å’Œæ™®é€šå‚æ•°ï¼‰
                const pattern = /((?:[\u4e00-\u9fa5]+(?:\/[\u4e00-\u9fa5\/\[\]]+)*|[\u4e00-\u9fa5]+))(\d+\.?\d*)/g;
                const matches = [...processedText.matchAll(pattern)];
                
                matches.forEach(match => {
                    let title = match[1]
                        .replace(/\[.*?\]/g, '')  // ç§»é™¤å•ä½è¯´æ˜
                        .replace(/\/+/g, '/')     // åˆå¹¶è¿ç»­æ–œæ 
                        .replace(/\/$/, '');     // å»é™¤ç»“å°¾æ–œæ 
                    const value = match[2];
            
                    // æ–°å¢ä¸­æ–‡å‚æ•°åç§°è¿‡æ»¤
                    if(title && value && !/^[\u4e00-\u9fa5]+$/.test(value)) {
                        rawItems.push(`${title}=${value}`);
                        formattedItems.push(`${title}ï¼š${value}`);
                    }
                });
            
                // æ˜¾ç¤ºç»“æœï¼ˆä¿®æ”¹è¿™éƒ¨åˆ†ï¼‰
                // å®šä¹‰ä¼˜å…ˆæ˜¾ç¤ºçš„å‚æ•°é¡ºåº
                const priorityParams = [
                    { key: 'æ»¤èŠ¯å¯¿å‘½', default: 'ç©º' },
                    { key: 'è„‰å†²', default: null },
                    { key: 'å†·æ°´è„‰å†²', default: null },
                    { key: 'æ”¾æ°´', default: null },
                    { key: 'æ”¾æ°´æ—¶é—´', default: null },
                    { key: 'åˆ¶æ°´', default: null },
                    { key: 'åˆ¶æ°´æ—¶é—´', default: null },
                    { key: 'æ£€ä¿®', default: '0' },
                    { key: 'æ£€ä¿®æ—¶é—´', default: '0' }
                ];
            
                // æ£€æŸ¥æ£€ä¿®å‚æ•°çš„ç‰¹æ®Šæƒ…å†µ
                const maintenanceItem = formattedItems.find(item => item.startsWith('æ£€ä¿®ï¼š'));
                const maintenanceTimeItem = formattedItems.find(item => item.startsWith('æ£€ä¿®æ—¶é—´ï¼š'));
                
                // å¦‚æœæ£€ä¿®å’Œæ£€ä¿®æ—¶é—´éƒ½ä¸º0ï¼Œåˆ™åªä¿ç•™æ£€ä¿®
                if (maintenanceItem?.endsWith('ï¼š0') && maintenanceTimeItem?.endsWith('ï¼š0')) {
                    formattedItems = formattedItems.filter(item => !item.startsWith('æ£€ä¿®æ—¶é—´ï¼š'));
                }
            
                // æ£€æŸ¥äº’æ–¥å‚æ•°
                const hasPulse = formattedItems.some(item => item.startsWith('è„‰å†²ï¼š'));
                const hasWaterDrain = formattedItems.some(item => item.startsWith('æ”¾æ°´ï¼š'));
                const hasWaterMake = formattedItems.some(item => item.startsWith('åˆ¶æ°´ï¼š'));
                const hasMaintenance = formattedItems.some(item => item.startsWith('æ£€ä¿®ï¼š'));
            
                // è¿‡æ»¤æ‰ä¸éœ€è¦æ˜¾ç¤ºçš„äº’æ–¥å‚æ•°
                const filteredPriorityParams = priorityParams.filter(param => {
                    if (hasPulse && param.key === 'å†·æ°´è„‰å†²') return false;
                    if (hasWaterDrain && param.key === 'æ”¾æ°´æ—¶é—´') return false;
                    if (hasWaterMake && param.key === 'åˆ¶æ°´æ—¶é—´') return false;
                    if (hasMaintenance && param.key === 'æ£€ä¿®æ—¶é—´') return false;
                    return true;
                });
            
                // åˆ†ç¦»ä¼˜å…ˆæ˜¾ç¤ºå’Œæ™®é€šå‚æ•°
                const priorityResults = [];
                const normalResults = [];
            
                // å¤„ç†ä¼˜å…ˆå‚æ•°
                filteredPriorityParams.forEach(param => {
                    const foundItem = formattedItems.find(item => item.startsWith(param.key + 'ï¼š'));
                    if (foundItem) {
                        priorityResults.push(foundItem);
                    } else if (param.default !== null) {
                        priorityResults.push(`${param.key}ï¼š${param.default}`);
                    }
                });
            
                // å¤„ç†æ™®é€šå‚æ•°ï¼ˆè¿‡æ»¤æ‰å·²æ˜¾ç¤ºçš„ä¼˜å…ˆå‚æ•°ï¼‰
                formattedItems.forEach(item => {
                    const [key] = item.split('ï¼š');
                    if (!priorityParams.some(param => param.key === key)) {
                        normalResults.push(item);
                    }
                });
            
                // å¯¹æ™®é€šå‚æ•°æŒ‰é•¿åº¦æ’åºï¼ˆä»çŸ­åˆ°é•¿ï¼‰
                normalResults.sort((a, b) => {
                    const aLen = a.split('ï¼š')[1]?.length || 0;
                    const bLen = b.split('ï¼š')[1]?.length || 0;
                    return aLen - bLen;
                });
            
                // åˆå¹¶ç»“æœ
                const finalResults = [...priorityResults, ...normalResults];
                
                
                // å¦åˆ™æ­£å¸¸æ˜¾ç¤ºç»“æœ
                document.getElementById('formattedParams').innerHTML = finalResults.map((item,index) => {
                    const [key, value] = item.split('ï¼š');
                    
                    return `${index + 1} - ${key}ï¼š<span style="color:red">${value}</span>`;
                }).filter(item => item !== '').join('<br>');
                
                console.log(finalResults,'finalResults')
                
                return result.jsonData;
            }

            // æ·»åŠ ä¸€ä¸ªå…¨å±€å‡½æ•°ä¾›å¤–éƒ¨è°ƒç”¨
            function getParsedParams() {
                return parseParams();
            }
            // å‚æ•°è¾“å…¥æ¡†å›è½¦äº‹ä»¶
            document.getElementById('paramInput').addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault(); // é˜»æ­¢é»˜è®¤æ¢è¡Œè¡Œä¸º
                    parseParams();       // è§¦å‘å…¥åº“å‚æ•°è§£æ
                    this.blur();        // ç§»é™¤è¾“å…¥æ¡†ç„¦ç‚¹
                }
            });


            // ICCIDè§£æå‡½æ•°
            function parseIccids() {
                const inputText = document.getElementById('iccidInput').value;
                const resultArray = [];
                
                if (!inputText.trim()) {
                    showMessage('è¯·è¾“å…¥ICCIDæ•°æ®', 'error');
                    return;
                }
                
                // å¤„ç†èŒƒå›´æ ¼å¼ï¼šICCIDåˆ°ICCID(æ•°é‡å¼ )
                const rangePattern = /(\d+[A-Za-z0-9]*)åˆ°(\d+[A-Za-z0-9]*)(?:\s*[\(ï¼ˆ](\d+)å¼ [\)ï¼‰])?/g;
                let match;
                
                // å¤„ç†èŒƒå›´æ ¼å¼
                while ((match = rangePattern.exec(inputText)) !== null) {
                    const startIccid = match[1];
                    const endIccid = match[2];
                    const count = match[3] ? parseInt(match[3]) : null;
                    
                    // æå–æ•°å­—éƒ¨åˆ†
                    const numericStart = extractNumericSuffix(startIccid);
                    const numericEnd = extractNumericSuffix(endIccid);
                    
                    if (numericStart && numericEnd) {
                        const prefix = startIccid.substring(0, startIccid.length - numericStart.length);
                        const startNum = parseInt(numericStart);
                        const endNum = parseInt(numericEnd);
                        
                        // éªŒè¯èŒƒå›´æ˜¯å¦ä¸æŒ‡å®šæ•°é‡åŒ¹é…
                        const actualCount = endNum - startNum + 1;
                        if (count !== null && actualCount !== count) {
                            console.warn(`è­¦å‘Šï¼šæŒ‡å®šæ•°é‡ ${count} ä¸å®é™…èŒƒå›´ ${actualCount} ä¸åŒ¹é…`);
                        }
                        
                        // ç”ŸæˆèŒƒå›´å†…çš„æ‰€æœ‰ICCID
                        for (let i = startNum; i <= endNum; i++) {
                            const paddedNum = i.toString().padStart(numericStart.length, '0');
                            resultArray.push(prefix + paddedNum);
                        }
                    } else {
                        console.error('æ— æ³•æå–æ•°å­—éƒ¨åˆ†:', startIccid, endIccid);
                    }
                }
                
                // åŒæ—¶å¤„ç†å•è¡ŒICCIDæ ¼å¼ï¼ˆæ— è®ºæ˜¯å¦å·²å¤„ç†èŒƒå›´æ ¼å¼ï¼‰
                // åˆ†å‰²è¾“å…¥æ–‡æœ¬ï¼Œå¤„ç†æ¯ä¸€è¡Œ
                const lines = inputText.split(/[\n\r]+/);
                
                lines.forEach(line => {
                    // è·³è¿‡åŒ…å«"åˆ°"çš„è¡Œï¼Œå› ä¸ºè¿™äº›è¡Œå·²ç»åœ¨èŒƒå›´å¤„ç†ä¸­å¤„ç†è¿‡äº†
                    if (line.includes('åˆ°')) {
                        return;
                    }
                    
                    // é¦–å…ˆå°è¯•åŒ¹é… 'ICCIDï¼ˆæ•°é‡å¼ ï¼‰' æˆ– 'ICCID(æ•°é‡å¼ )' æ ¼å¼
                    const singleIccidWithCountPattern = /([A-Za-z0-9]+)\s*[\(ï¼ˆ]\s*(\d+)\s*å¼ [\)ï¼‰]/;
                    const singleMatch = line.match(singleIccidWithCountPattern);
                    
                    if (singleMatch) {
                        // æå–ICCIDéƒ¨åˆ†
                        const iccid = singleMatch[1].trim();
                        // æå–æ•°é‡éƒ¨åˆ†ï¼ˆè¿™é‡Œæˆ‘ä»¬ä¸ä½¿ç”¨æ•°é‡ï¼Œåªæå–ICCIDï¼‰
                        const count = singleMatch[2];
                        
                        // éªŒè¯ICCIDçš„æœ‰æ•ˆæ€§
                        if (iccid.length > 10) {
                            resultArray.push(iccid);
                        }
                    } else {
                        // æ¸…ç†æ¯è¡Œï¼Œç§»é™¤å¯èƒ½çš„å¼•å·å’Œç©ºæ ¼
                        const cleanedLine = line.trim().replace(/['""`]/g, '');
                        
                        // å¦‚æœæ˜¯æœ‰æ•ˆçš„ICCIDï¼ˆè‡³å°‘åŒ…å«æ•°å­—å’Œå¯èƒ½çš„å­—æ¯ï¼Œé•¿åº¦å¤§äº10ï¼‰
                        if (/^[A-Za-z0-9]+$/.test(cleanedLine) && cleanedLine.length > 10) {
                            resultArray.push(cleanedLine);
                        }
                    }
                });
                
                // æ˜¾ç¤ºç»“æœï¼Œæ¯è¡Œä¸€ä¸ªICCID
                document.getElementById('iccidResult').value = resultArray.join('\n');
                
                if (resultArray.length > 0) {
                    showMessage(`è§£ææˆåŠŸï¼Œå…±æå– ${resultArray.length} ä¸ªICCID`, 'success');
                } else {
                    showMessage('æœªæ‰¾åˆ°æœ‰æ•ˆçš„ICCIDæ•°æ®ï¼Œè¯·æ£€æŸ¥è¾“å…¥æ ¼å¼', 'error');
                }
            }
            
            // æå–ICCIDæœ«å°¾çš„æ•°å­—éƒ¨åˆ†
            function extractNumericSuffix(iccid) {
                // å¯¹äºçº¯æ•°å­—ICCIDï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†
                if (/^\d+$/.test(iccid)) {
                    // å¦‚æœæ˜¯çº¯æ•°å­—ï¼Œå–æœ€å5ä½ä½œä¸ºå˜åŒ–éƒ¨åˆ†
                    return iccid.slice(-5);
                } else {
                    // å¯¹äºæ··åˆå­—æ¯æ•°å­—çš„ICCIDï¼Œä½¿ç”¨åŸæ¥çš„é€»è¾‘
                    const match = iccid.match(/(\d+)$/);
                    return match ? match[1] : null;
                }
            }
            
            // ä¿®æ”¹ICCIDæ ¼å¼å‡½æ•°
            function formatIccids() {
                const resultText = document.getElementById('iccidResult').value;
                if (!resultText.trim()) {
                    showMessage('è¯·å…ˆè§£æICCIDæ•°æ®', 'error');
                    return;
                }
                
                // å°†æ¢è¡Œåˆ†éš”çš„ICCIDè½¬æ¢ä¸ºé€—å·åˆ†éš”
                const iccids = resultText.split('\n').filter(line => line.trim());
                document.getElementById('iccidResult').value = iccids.join(',');
                showMessage('å·²è½¬æ¢ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼', 'success');
            }
            
            // æ¢å¤ICCIDæ ¼å¼å‡½æ•° - åœ¨æ¯ä¸ªICCIDåæ·»åŠ å•å¼•å·
            function addQuotesToIccids() {
                const resultText = document.getElementById('iccidResult').value;
                if (!resultText.trim()) {
                    showMessage('è¯·å…ˆè§£æICCIDæ•°æ®', 'error');
                    return;
                }
                
                // å¤„ç†ä¸åŒæ ¼å¼çš„ICCID
                let iccids;
                if (resultText.includes(',')) {
                    // é€—å·åˆ†éš”çš„æ ¼å¼
                    iccids = resultText.split(',').filter(item => item.trim());
                    // æ·»åŠ å•å¼•å·å¹¶é‡æ–°ç”¨é€—å·è¿æ¥
                    document.getElementById('iccidResult').value = iccids.map(iccid => 
                        iccid.trim().endsWith("'") ? iccid.trim() : iccid.trim() + "'"
                    ).join(',');
                } else {
                    // æ¢è¡Œåˆ†éš”çš„æ ¼å¼
                    iccids = resultText.split('\n').filter(line => line.trim());
                    // æ·»åŠ å•å¼•å·å¹¶ä¿æŒæ¢è¡Œæ ¼å¼
                    document.getElementById('iccidResult').value = iccids.map(iccid => 
                        iccid.trim().endsWith("'") ? iccid.trim() : iccid.trim() + "'"
                    ).join('\n');
                }
                
                showMessage('å·²æ·»åŠ å•å¼•å·ï¼Œé˜²æ­¢ç§‘å­¦è®¡æ•°æ ¼å¼', 'success');
            }

            // é‡‘é¢æ°´é‡æ¢ç®—å‡½æ•°
            function calculateWaterValue() {
                const amount = parseFloat(document.getElementById('amount').value) || 0;
                const waterVolume = parseFloat(document.getElementById('waterVolume').value) || 0;
                const mlPerCent = parseFloat(document.getElementById('pricePerMl').value) || 0;
                
                let results = [];
                
                if (amount > 0 && waterVolume > 0) {
                    const calculatedMlPerCent = waterVolume / (amount * 100);
                    document.getElementById('pricePerMl').value = calculatedMlPerCent.toFixed(4);
                    results.push(`ğŸ§® 1åˆ†é’±å¯¹åº”ï¼š<span style="color:red">${calculatedMlPerCent.toFixed(4)}æ¯«å‡</span>`);
                    results.push(`ğŸ’§ ${waterVolume}æ¯«å‡ = <span style="color:red">${amount}å…ƒ</span>`);
                } else if (amount > 0 && mlPerCent > 0) {
                    const calculatedVolume = (amount * 100) * mlPerCent;
                    document.getElementById('waterVolume').value = calculatedVolume.toFixed(2);
                    results.push(`ğŸ’§ æ°´é‡ï¼š<span style="color:red">${calculatedVolume.toFixed(2)}æ¯«å‡</span>`);
                } else if (waterVolume > 0 && mlPerCent > 0) {
                    const calculatedAmount = waterVolume / mlPerCent / 100;
                    document.getElementById('amount').value = calculatedAmount.toFixed(2);
                    results.push(`ğŸ’° é‡‘é¢ï¼š<span style="color:red">${calculatedAmount.toFixed(2)}å…ƒ</span>`);
                } else {
                    results.push(`ğŸ“ è¯·è¾“å…¥ä»»æ„ä¸¤ä¸ªå‚æ•°è¿›è¡Œè®¡ç®—`);
                }
                
                document.getElementById('waterCalculations').innerHTML = results.join('<br>');
            }

            // æ°´å•ä»·è®¡ç®—å‡½æ•°
            // æ¸…ç©ºæ´—æµ´æ°´æ§æ•°æ®å‡½æ•°
            function clearWaterValueData() {
                document.getElementById('amount').value = '';
                document.getElementById('waterVolume').value = '';
                document.getElementById('pricePerMl').value = '';
                document.getElementById('waterCalculations').innerHTML = 'è¯·è¾“å…¥ä»»æ„ä¸¤ä¸ªå‚æ•°è¿›è¡Œè®¡ç®—';
            }

            // ç»‘å®šæ´—æµ´æ°´æ§æ¸…ç©ºæŒ‰é’®äº‹ä»¶
            document.getElementById('clearWaterValueBtn').addEventListener('click', clearWaterValueData);

            // æ°´æ§å•ä»·è®¡ç®—å‡½æ•°
            function calculateWaterPrice() {
                const waterVolume = parseFloat(document.getElementById('waterVolume2').value) || 0;
                const amount = parseFloat(document.getElementById('amount2').value) || 0;
                const pricePerLiter = parseFloat(document.getElementById('pricePerLiter').value) || 0;
                
                let results = [];
                
                if (waterVolume > 0 && amount > 0) {
                    const calculatedPricePerLiter = (amount / waterVolume) * 1000;
                    document.getElementById('pricePerLiter').value = calculatedPricePerLiter.toFixed(4);
                    results.push(`ğŸš° <strong>è®¡ç®—ç»“æœï¼š1å‡æ°´å•ä»· = <span style="color:red;font-size:18px">${calculatedPricePerLiter.toFixed(4)}å…ƒ/å‡</span></strong>`);
                    results.push(`ğŸ“Š è®¡ç®—è¿‡ç¨‹ï¼š${amount}å…ƒ Ã· ${waterVolume}æ¯«å‡ Ã— 1000 = ${calculatedPricePerLiter.toFixed(4)}å…ƒ/å‡`);
                } else if (waterVolume > 0 && pricePerLiter > 0) {
                    const calculatedAmount = (waterVolume / 1000) * pricePerLiter;
                    document.getElementById('amount2').value = calculatedAmount.toFixed(4);
                    results.push(`ğŸ’° <strong>åº”ä»˜é‡‘é¢ï¼š<span style="color:red;font-size:18px">${calculatedAmount.toFixed(4)}å…ƒ</span></strong>`);
                } else if (amount > 0 && pricePerLiter > 0) {
                    const calculatedVolume = (amount / pricePerLiter) * 1000;
                    document.getElementById('waterVolume2').value = calculatedVolume.toFixed(2);
                    results.push(`ğŸ’§ <strong>å¯è´­ä¹°æ°´é‡ï¼š<span style="color:red;font-size:18px">${calculatedVolume.toFixed(2)}æ¯«å‡</span></strong>`);
                } else {
                    results.push(`ğŸ“ è¯·è¾“å…¥ä»»æ„ä¸¤ä¸ªå‚æ•°è¿›è¡Œè®¡ç®—`);
                    results.push(`ğŸ’¡ ç¤ºä¾‹ï¼šè¾“å…¥787æ¯«å‡å’Œ0.2385å…ƒï¼Œè‡ªåŠ¨è®¡ç®—1å‡æ°´å•ä»·`);
                }
                
                document.getElementById('waterPriceCalculations').innerHTML = results.join('<br>');
            }
            
            // æ¸…ç©ºæ°´æ§å•ä»·æ•°æ®å‡½æ•°
            function clearWaterPriceData() {
                document.getElementById('waterVolume2').value = '';
                document.getElementById('amount2').value = '';
                document.getElementById('pricePerLiter').value = '';
                document.getElementById('waterPriceCalculations').innerHTML = 'è¯·è¾“å…¥ä»»æ„ä¸¤ä¸ªå‚æ•°è¿›è¡Œè®¡ç®—';
            }
            
            // ç»‘å®šæ¸…ç©ºæ•°æ®æŒ‰é’®äº‹ä»¶
            document.getElementById('clearWaterPriceBtn').addEventListener('click', clearWaterPriceData);

            // CSV/Excelæ–‡ä»¶å¤„ç†ç›¸å…³
            document.getElementById('csvFileInput').addEventListener('change', function() {
                const processButton = document.querySelector('#csv89860Tool button');
                if (this.files.length > 0) {
                    processButton.disabled = false;
                    document.getElementById('csvProcessStatus').textContent = `å·²é€‰æ‹©æ–‡ä»¶: ${this.files[0].name}`;
                } else {
                    processButton.disabled = true;
                    document.getElementById('csvProcessStatus').textContent = 'è¯·é€‰æ‹©æ–‡ä»¶è¿›è¡Œå¤„ç†';
                }
            });
            
            function processCSVFile() {
                const fileInput = document.getElementById('csvFileInput');
                const file = fileInput.files[0];
                
                if (!file) {
                    document.getElementById('csvProcessStatus').textContent = 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶';
                    return;
                }
                
                document.getElementById('csvProcessStatus').textContent = 'æ­£åœ¨å¤„ç†æ–‡ä»¶...';
                
                const fileExtension = file.name.split('.').pop().toLowerCase();
                
                // æ ¹æ®æ–‡ä»¶ç±»å‹é€‰æ‹©å¤„ç†æ–¹æ³•
                if (fileExtension === 'csv') {
                    processCSV(file);
                } else if (['xls', 'xlsx'].includes(fileExtension)) {
                    processExcel(file);
                } else {
                    document.getElementById('csvProcessStatus').textContent = 'ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼Œè¯·é€‰æ‹©CSVã€XLSæˆ–XLSXæ–‡ä»¶';
                }
            }
            
            // å¤„ç†CSVæ–‡ä»¶
            function processCSV(file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const content = e.target.result;
                        let matchCount = 0;
                        
                        // å¤„ç†å¼•å·ä¸­çš„89860å¼€å¤´çš„å€¼
                        let modifiedContent = content;
                        const pattern89860 = /"89860/g;
                        const matches89860 = content.match(pattern89860) || [];
                        modifiedContent = modifiedContent.replace(pattern89860, '"\'89860');
                        matchCount += matches89860.length;
                        
                        // å¤„ç†86å¼€å¤´çš„15ä½æ•°å­—(IMEI)
                        // å…ˆåŒ¹é…å¼•å·ä¸­çš„IMEI
                        const patternIMEIQuoted = /"86\d{13}"/g;
                        const matchesIMEIQuoted = content.match(patternIMEIQuoted) || [];
                        modifiedContent = modifiedContent.replace(patternIMEIQuoted, (match) => {
                            return `"'${match.substring(1, match.length - 1)}"`;
                        });
                        matchCount += matchesIMEIQuoted.length;

                        // å†åŒ¹é…æ²¡æœ‰å¼•å·çš„IMEIï¼ˆé€šå¸¸åœ¨CSVä¸­å‡ºç°ï¼‰
                        const patternIMEIUnquoted = /(^|,|\n)86\d{13}($|,|\n)/g;
                        const matchesIMEIUnquoted = content.match(patternIMEIUnquoted) || [];
                        modifiedContent = modifiedContent.replace(patternIMEIUnquoted, (match) => {
                            // ä¿ç•™åˆ†éš”ç¬¦
                            if (match.startsWith(',') || match.startsWith('\n')) {
                                const prefix = match[0];
                                const imei = match.substring(1, match.length - 1);
                                const suffix = match[match.length - 1];
                                return `${prefix}"${imei}"${suffix}`;
                            } else if (match.endsWith(',') || match.endsWith('\n')) {
                                const prefix = match[0];
                                const imei = match.substring(1, match.length - 1);
                                const suffix = match[match.length - 1];
                                return `${prefix}"${imei}"${suffix}`;
                            } else {
                                const imei = match;
                                return `"${imei}"`;
                            }
                        });
                        matchCount += matchesIMEIUnquoted.length;
                        
                        // å¤„ç†å¯èƒ½è¢«Excelè½¬ä¸ºç§‘å­¦è®¡æ•°æ³•çš„é•¿æ•°å­—
                        // åŒ¹é…å¼•å·ä¸­çš„10ä½ä»¥ä¸Šçº¯æ•°å­—
                        const patternLongNum = /"\d{10,}"/g;
                        const matchesLongNum = content.match(patternLongNum) || [];
                        modifiedContent = modifiedContent.replace(patternLongNum, (match) => {
                            // é¿å…é‡å¤å¤„ç†å·²ç»æ·»åŠ å•å¼•å·çš„å€¼
                            if (!match.includes("'")) {
                                return `"'${match.substring(1, match.length - 1)}"`;
                            }
                            return match;
                        });
                        matchCount += matchesLongNum.length;
                        
                        // åˆ›å»ºä¸‹è½½é“¾æ¥
                        const blob = new Blob(['\ufeff' + modifiedContent], { type: 'text/csv;charset=utf-8;' });
                        const link = document.createElement('a');
                        const url = URL.createObjectURL(blob);
                        
                        // è®¾ç½®ä¸‹è½½æ–‡ä»¶å
                        const originalName = file.name;
                        const extension = originalName.lastIndexOf('.') >= 0 ? originalName.slice(originalName.lastIndexOf('.')) : '.csv';
                        const baseName = originalName.lastIndexOf('.') >= 0 ? originalName.slice(0, originalName.lastIndexOf('.')) : originalName;
                        const downloadName = `${baseName}_processed${extension}`;
                        
                        link.setAttribute('href', url);
                        link.setAttribute('download', downloadName);
                        link.style.visibility = 'hidden';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        document.getElementById('csvProcessStatus').textContent = `å¤„ç†å®Œæˆï¼å…±å¤„ç†äº† ${matchCount} ä¸ªéœ€è¦æ·»åŠ å•å¼•å·çš„å€¼ï¼Œæ–‡ä»¶å·²ä¸‹è½½`;
                        
                        // é‡ç½®æ–‡ä»¶è¾“å…¥ï¼Œå…è®¸å†æ¬¡é€‰æ‹©åŒä¸€æ–‡ä»¶
                        document.getElementById('csvFileInput').value = '';
                        document.querySelector('#csv89860Tool button').disabled = true;
                    } catch (error) {
                        document.getElementById('csvProcessStatus').textContent = `å¤„ç†å¤±è´¥: ${error.message}`;
                    }
                };
                
                reader.onerror = function() {
                    document.getElementById('csvProcessStatus').textContent = 'è¯»å–æ–‡ä»¶å¤±è´¥';
                };
                
                // è¯»å–æ–‡ä»¶å†…å®¹
                reader.readAsText(file, 'utf-8');
            }
            
            // å¤„ç†Excelæ–‡ä»¶
            function processExcel(file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        
                        let totalProcessedCount = 0;
                        
                        // å¤„ç†æ¯ä¸ªå·¥ä½œè¡¨
                        workbook.SheetNames.forEach(sheetName => {
                            const worksheet = workbook.Sheets[sheetName];
                            const range = XLSX.utils.decode_range(worksheet['!ref'] || 'A1:A1');
                            
                            let sheetProcessedCount = 0;
                            
                            // éå†æ‰€æœ‰å•å…ƒæ ¼
                            for (let row = range.s.r; row <= range.e.r; row++) {
                                for (let col = range.s.c; col <= range.e.c; col++) {
                                    const cellAddress = XLSX.utils.encode_cell({ r: row, c: col });
                                    const cell = worksheet[cellAddress];
                                    
                                    if (cell && cell.v && typeof cell.v === 'string') {
                                        const originalValue = cell.v;
                                        let modified = false;
                                        
                                        // æ£€æŸ¥æ˜¯å¦éœ€è¦æ·»åŠ å•å¼•å·
                                        // å»é™¤å‰åç©ºæ ¼åå†åˆ¤æ–­
                                        const trimmedValue = originalValue.trim();
                                        if (
                                            (trimmedValue.startsWith('89860') || 
                                            (trimmedValue.startsWith('86') && /^86\d{13}$/.test(trimmedValue)) ||
                                            /^\d{10,}$/.test(trimmedValue)) &&
                                            !originalValue.startsWith("'")
                                        ) {
                                            // åœ¨å€¼å‰æ·»åŠ å•å¼•å·ï¼Œå¹¶è®¾ç½®å•å…ƒæ ¼ç±»å‹ä¸ºæ–‡æœ¬
                                            cell.v = `'${originalValue}`;
                                            cell.t = 's'; // è®¾ç½®ä¸ºå­—ç¬¦ä¸²ç±»å‹
                                            modified = true;
                                            sheetProcessedCount++;
                                        }
                                    } else if (cell && typeof cell.v === 'number') {
                                        // å¤„ç†æ•°å­—ç±»å‹å€¼
                                        const originalValue = cell.v.toString();
                                        
                                        // æ£€æŸ¥æ˜¯å¦æ˜¯é•¿æ•°å­—ï¼ˆå¯èƒ½è¢«Excelè½¬ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼‰
                                        if (originalValue.length >= 10 && !originalValue.includes('.')) {
                                            // è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ·»åŠ å•å¼•å·
                                            cell.v = `'${originalValue}`;
                                            cell.t = 's'; // è®¾ç½®ä¸ºå­—ç¬¦ä¸²ç±»å‹
                                            modified = true;
                                            sheetProcessedCount++;
                                        }
                                    }
                                }
                            }
                            
                            totalProcessedCount += sheetProcessedCount;
                            console.log(`å·¥ä½œè¡¨ ${sheetName} å¤„ç†äº† ${sheetProcessedCount} ä¸ªå•å…ƒæ ¼`);
                        });
                        
                        // ç”Ÿæˆå¤„ç†åçš„æ–‡ä»¶
                        const originalName = file.name;
                        const extension = originalName.lastIndexOf('.') >= 0 ? originalName.slice(originalName.lastIndexOf('.')) : '.xlsx';
                        const baseName = originalName.lastIndexOf('.') >= 0 ? originalName.slice(0, originalName.lastIndexOf('.')) : originalName;
                        const downloadName = `${baseName}_å·²å¤„ç†${extension}`;
                        
                        // ä¸‹è½½æ–‡ä»¶
                        XLSX.writeFile(workbook, downloadName);
                        
                        document.getElementById('csvProcessStatus').textContent = `å¤„ç†å®Œæˆï¼å…±å¤„ç†äº† ${totalProcessedCount} ä¸ªå•å…ƒæ ¼ï¼Œæ–‡ä»¶å·²ä¸‹è½½`;
                        
                        // é‡ç½®æ–‡ä»¶è¾“å…¥ï¼Œå…è®¸å†æ¬¡é€‰æ‹©åŒä¸€æ–‡ä»¶
                        document.getElementById('csvFileInput').value = '';
                        document.querySelector('#csv89860Tool button').disabled = true;
                    } catch (error) {
                        document.getElementById('csvProcessStatus').textContent = `å¤„ç†å¤±è´¥: ${error.message}`;
                        console.error('Excelå¤„ç†é”™è¯¯:', error);
                    }
                };
                
                reader.onerror = function() {
                    document.getElementById('csvProcessStatus').textContent = 'è¯»å–æ–‡ä»¶å¤±è´¥';
                };
                
                // è¯»å–æ–‡ä»¶å†…å®¹
                reader.readAsArrayBuffer(file);
            }
            
            // åè¿›åˆ¶è½¬åå…­è¿›åˆ¶å‡½æ•°
            function convertDecToHex() {
                const decimalValue = document.getElementById('decimalInput').value;
                // æ­£åˆ™éªŒè¯åè¿›åˆ¶æ ¼å¼
                if (/^\d+$/.test(decimalValue)) {
                    const hex = parseInt(decimalValue)
                            .toString(16)
                            .toUpperCase();
                    document.getElementById('hexInput').value = hex;
                } else {
                    document.getElementById('hexInput').value = '';
                }
            }
            
            // åå…­è¿›åˆ¶è½¬åè¿›åˆ¶å‡½æ•°
            function convertHexToDec() {
                const hexValue = document.getElementById('hexInput').value;
                // æ­£åˆ™éªŒè¯åå…­è¿›åˆ¶æ ¼å¼ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
                if (/^[0-9A-Fa-f]+$/.test(hexValue)) {
                    const decimal = parseInt(hexValue, 16);
                    document.getElementById('decimalInput').value = decimal;
                } else {
                    document.getElementById('decimalInput').value = '';
                }
            }
            
            // äº‹ä»¶ç»‘å®š
            document.addEventListener('DOMContentLoaded', function() {
                // è„‰å†²è®¡ç®—å™¨äº‹ä»¶
                document.getElementById('systemPulses').addEventListener('input', calculateActualPulses);
                document.getElementById('systemWater').addEventListener('input', calculateActualPulses);
                document.getElementById('actualWater').addEventListener('input', calculateActualPulses);
                
                // è¿›åˆ¶è½¬æ¢äº‹ä»¶
                document.getElementById('decimalInput').addEventListener('input', convertDecToHex);
                document.getElementById('hexInput').addEventListener('input', convertHexToDec);
            
                // å‚æ•°è§£æå™¨å›è½¦äº‹ä»¶
                document.getElementById('paramInput').addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        parseParams();
                        this.blur();
                    }
                });

                
                // Excelæ–‡ä»¶ä¸Šä¼ äº‹ä»¶
                const fileInput = document.getElementById('excelFileInput');
                fileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        readExcelFile(file);
                    } else {
                        clearExcelData();
                    }
                });
                
                // æ¨¡æ¿é€‰æ‹©äº‹ä»¶
                document.getElementById('templateSelect').addEventListener('change', function(e) {
                    if (e.target.value === 'upload') {
                        // è§¦å‘æ¨¡æ¿æ–‡ä»¶ä¸Šä¼ 
                        document.getElementById('templateFileInput').click();
                        // é‡ç½®é€‰æ‹©æ¡†
                        e.target.value = '';
                    } else {
                        updateProcessButton();
                    }
                });
                
                // åˆå§‹åŒ–ï¼šåŠ è½½è¿œç¨‹æ¨¡æ¿
                loadRemoteTemplate().then(() => {
                    console.log('è¿œç¨‹æ¨¡æ¿åˆå§‹åŒ–å®Œæˆ');
                    // ç¡®ä¿æŒ‰é’®çŠ¶æ€æ­£ç¡®æ›´æ–°
                    updateProcessButton();
                }).catch(error => {
                    console.error('è¿œç¨‹æ¨¡æ¿åˆå§‹åŒ–å¤±è´¥:', error);
                    // å³ä½¿åŠ è½½å¤±è´¥ä¹Ÿè¦æ›´æ–°æŒ‰é’®çŠ¶æ€
                    updateProcessButton();
                });

                // é»˜è®¤æ˜¾ç¤ºè„‰å†²è®¡ç®—å™¨å·¥å…·
                showTool('pulseTool');
            });
            
            // å…¥åº“å‚æ•°ç”Ÿæˆå™¨ç›¸å…³å‡½æ•°
            function extractData() {
                // éªŒè¯æ»¤èŠ¯å¯¿å‘½æ˜¯å¦å·²é€‰æ‹©
                const filterLifeType = document.getElementById('filterLifeType').value;
                if (!filterLifeType) {
                    alert('è¯·é€‰æ‹©æ»¤èŠ¯å¯¿å‘½ï¼');
                    return;
                }
                
                // è·å–Excelæ•°æ®å¹¶å¤„ç†
                const excelData = document.getElementById('excelData').value.trim();
                let excelResult = '';
                
                if (excelData) {
                    // å¤„ç†åˆ¶è¡¨ç¬¦åˆ†éš”çš„å­—æ®µ
                    const extractedData = excelData.split(/\t/).filter(item => item.trim() !== '');
                    // ç¡®ä¿åªåŒ…å«åŸºç¡€ä¿¡æ¯ï¼šå…¬å¸åç§°ã€å¾®ä¿¡å…¬ä¼—å·ã€æ— å¡ç±»å‹ã€å‚å•†IDã€ç³»ç»Ÿç±»å‹
                    // å»é™¤å¯èƒ½åŒ…å«é‡å¤å‚æ•°çš„å¤šä½™å­—æ®µ
                    const basicFields = extractedData.slice(0, 5);
                    // ç¬¬2æ­¥ï¼šç³»ç»Ÿç±»å‹è¾“å‡ºå®Œæˆåæ¢è¡Œ
                    excelResult = basicFields.join('ï¼Œ') + 'ã€‚\n';
                }
                
                // è·å–æ»¤èŠ¯å¯¿å‘½çš„å®Œæ•´æè¿°
                let filterLifeTypeText = '';
                if (filterLifeType === '0') {
                    filterLifeTypeText = '0.æ—¶é—´';
                } else if (filterLifeType === '1') {
                    filterLifeTypeText = '1.æµé‡';
                }
                
                // è·å–å‚æ•°æ•°æ®
                const parameters = {
                    'ä¸»æ¿å‹å·ï¼š': document.getElementById('motherboardModel').value.trim(),
                    'æ»¤èŠ¯å¯¿å‘½ï¼š': filterLifeTypeText,
                    'é€šé“2è„‰å†²[å†·ã€å°2]ï¼š': document.getElementById('channel2Pulse').value.trim(),
                    'é€šé“1è„‰å†²[çƒ­,å¤§]ï¼š': document.getElementById('channel1Pulse').value.trim(),
                    'åˆ¶æ°´æ—¶é—´ï¼š': document.getElementById('waterTime').value.trim(),
                    'é˜€2æ”¾æ°´æ—¶é—´[å†·ã€å°]ï¼š': document.getElementById('valve2Time').value.trim(),
                    'é˜€1æ”¾æ°´æ—¶é—´[ç½è£…ã€å¤§ã€çƒ­]ï¼š': document.getElementById('valve1Time').value.trim(),
                    'æ£€ä¿® æ—¶é—´ï¼š': document.getElementById('maintainTime').value.trim(),
                    'çƒ­æ°´ æ¸©åº¦ï¼š': document.getElementById('hotWaterTemp').value.trim(),
                    'å¤§/1é€šé“/çƒ­æ°´è€è´¹ç‡ï¼š': document.getElementById('rate1Hot').value.trim(),
                    'å°/2é€šé“/å†·æ°´è€è´¹ç‡ï¼š': document.getElementById('rate2Cold').value.trim(),
                    'å¤§/1é€šé“/çƒ­æ°´è´¹ç‡ï¼š': document.getElementById('rate1HotPerLiter').value.trim(),
                    'å°/2é€šé“/å†·æ°´è´¹ç‡ï¼š': document.getElementById('rate2ColdPerLiter').value.trim(),
                    'å•æ¬¡é™åˆ¶æµé‡/ç®±3ï¼š': document.getElementById('singleLimitFlow').value.trim(),
                    'æµ®çƒ-æ´¾å£«ï¼š': document.getElementById('floatBall').value.trim(),
                    'å•æ¬¡é™åˆ¶æ—¶é—´ï¼š': document.getElementById('singleLimitTime').value.trim(),
                    'å¡æµé‡ï¼š': document.getElementById('cardFlow').value.trim(),
                    'ICCIDèµ·å§‹ï¼š': document.getElementById('iccidStart').value.trim(),
                    'ICCIDç»“å°¾ï¼š': document.getElementById('iccidEnd').value.trim(),
                    'å…¥åº“æ•°é‡ï¼š': document.getElementById('inStockCount').value.trim()
                };
                
                // æ„å»ºå‚æ•°ç»“æœï¼ŒåªåŒ…å«æœ‰å€¼çš„å‚æ•°
                const paramEntries = [];
                for (const [key, value] of Object.entries(parameters)) {
                    if (value !== '') {
                        paramEntries.push(`${key}${value}`);
                    }
                }
                let paramResult = '';
                if (paramEntries.length > 0) {
                    paramResult = paramEntries.join('ï¼Œ') + 'ã€‚';
                }
                
                // æ£€æŸ¥åŸå§‹æ•°æ®æ˜¯å¦åŒ…å«"æŒ‡å®šID"ï¼Œå¦‚æœåŒ…å«åˆ™æ·»åŠ åˆ°ç»“æœæœ«å°¾
                const nonStandardData = document.getElementById('nonStandardData').value.trim();
                if (nonStandardData.includes('æŒ‡å®šID')) {
                    if (paramResult) {
                        // å¦‚æœå·²æœ‰å‚æ•°ç»“æœï¼Œåœ¨å¥å·å‰æ·»åŠ 
                        paramResult = paramResult.replace(/ã€‚$/, 'ï¼ŒæŒ‡å®šIDã€‚');
                    } else {
                        // å¦‚æœæ²¡æœ‰å‚æ•°ç»“æœï¼Œç›´æ¥æ·»åŠ 
                        paramResult = 'æŒ‡å®šIDã€‚';
                    }
                }
                
                // åˆå¹¶ç»“æœ
                let finalResult = '';
                if (excelResult) {
                    finalResult += excelResult;
                }
                if (paramResult) {
                    finalResult += paramResult;
                }
                
                // æ˜¾ç¤ºç»“æœ
                const resultElement = document.getElementById('result');
                resultElement.textContent = finalResult;
                
                // è‡ªåŠ¨å¤åˆ¶ç»“æœåˆ°å‰ªè´´æ¿
                navigator.clipboard.writeText(finalResult)
                    .then(() => {
                        console.log('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                    })
                    .catch(err => {
                        console.error('å¤åˆ¶å¤±è´¥:', err);
                    });
            }
            
            function convertData() {
                const nonStandardData = document.getElementById('nonStandardData').value.trim();
                if (!nonStandardData) {
                    alert('è¯·è¾“å…¥éæ ‡å‡†å†…å®¹ï¼');
                    return;
                }
                
                // ä¸æ¸…ç©ºä¹‹å‰æ‰€æœ‰è½¬æ¢çš„æ•°æ®ï¼Œåªæ¸…ç©ºå‚æ•°è®¾ç½®åŒºåŸŸ
                // æ¸…ç©ºå‚æ•°è®¾ç½®åŒºåŸŸ
                document.getElementById('motherboardModel').value = '';
                document.getElementById('filterLifeType').value = '';
                document.getElementById('channel2Pulse').value = '';
                document.getElementById('channel1Pulse').value = '';
                document.getElementById('waterTime').value = '';
                document.getElementById('valve2Time').value = '';
                document.getElementById('valve1Time').value = '';
                document.getElementById('maintainTime').value = '';
                document.getElementById('rate1Hot').value = '';
                document.getElementById('rate2Cold').value = '';
                document.getElementById('rate1HotPerLiter').value = '';
                document.getElementById('rate2ColdPerLiter').value = '';
                document.getElementById('singleLimitFlow').value = '';
                document.getElementById('floatBall').value = '';
                document.getElementById('singleLimitTime').value = '';
                document.getElementById('cardFlow').value = '';
                document.getElementById('iccidStart').value = '';
                document.getElementById('iccidEnd').value = '';
                document.getElementById('inStockCount').value = '';
                document.getElementById('hotWaterTemp').value = '';
                
                // å®šä¹‰ç³»ç»Ÿç±»å‹å…³é”®å­—æ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰æ”¯æŒçš„ç³»ç»Ÿç±»å‹
                const systemKeywords = ['è·ƒé¾™æ–°ç§æœ‰', 'è·ƒé¾™å…¬æœ‰å”®æ°´æœº', 'è·ƒé¾™å…¬æœ‰å”®æ°´æœºæœ‰åŸŸå', 'è·ƒé¾™æ–°å…¬æœ‰', 'è·ƒé¾™æ–°å…¬æœ‰æœ‰åŸŸå', 'è·ƒé¾™å…¬æœ‰', 'è·ƒé¾™å…¬æœ‰æœ‰åŸŸå', 'è·ƒé¾™2.0å…¬æœ‰', 'è·ƒé¾™3.0å…¬æœ‰', 'è·ƒé¾™ç§æœ‰', 'å®¢æˆ·ç§æœ‰'];
                
                // å¤„ç†ç”¨æˆ·è¾“å…¥çš„æ ¼å¼ï¼Œæ”¯æŒé€—å·å’Œç©ºæ ¼åˆ†éš”
                let basicInfo;
                let companyName = '';
                let wechatName = '';
                let vendorId = '';
                let cardType = 'æ— å¡ç±»å‹'; // é»˜è®¤æ— å¡ç±»å‹
                let motherboardModel = '';
                let systemType = ''; // ç³»ç»Ÿç±»å‹
                
                if (nonStandardData.includes('ï¼Œ')) {
                    // ä¼˜åŒ–ï¼šç”¨æˆ·æ•°æ®åŒ…å«é€—å·ï¼Œä½†ä¸»è¦æ˜¯ç©ºæ ¼åˆ†éš”çš„ï¼Œæ‰€ä»¥å…ˆæŒ‰ç©ºæ ¼åˆ†å‰²å¤„ç†
                    basicInfo = nonStandardData.split(/\s+/).filter(item => item.trim() !== '');
                    
                    // å¤„ç†äº”è¦ç´ ï¼šå…¬å¸åç§°,å¾®ä¿¡å…¬ä¼—å·,å‚å•†ID,å¡ç±»å‹,æ‰€å±ç³»ç»Ÿ
                // 1. å¤„ç†å…¬å¸åç§°
                if (basicInfo.length >= 1) {
                    companyName = basicInfo[0];
                }
                
                // 2. å¤„ç†å¾®ä¿¡å…¬ä¼—å· - ä¸ºç©ºæ—¶è¡¥å¡«å…¬å¸åç§°
                if (basicInfo.length >= 2 && basicInfo[1].trim() !== '') {
                    wechatName = basicInfo[1];
                } else {
                    wechatName = companyName; // å¾®ä¿¡å…¬ä¼—å·ä¸ºç©ºæ—¶ï¼Œé»˜è®¤è¡¥å¡«å…¬å¸åç§°
                }
                
                // 3. å¤„ç†å‚å•†ID
                if (basicInfo.length >= 3) {
                    vendorId = basicInfo[2];
                }
                
                // 4. æ‰€æœ‰å¡ç±»å‹éƒ½è®¾ç½®ä¸º"æ— å¡ç±»å‹"
                cardType = 'æ— å¡ç±»å‹';
                
                // 5. å¤„ç†æ‰€å±ç³»ç»Ÿ - æ£€æµ‹åˆ°æ‰€å±ç³»ç»Ÿæ—¶ï¼Œå®Œç»“äº”è¦ç´ è½¬æ¢
                // éå†ä»ç¬¬å››ä¸ªå­—æ®µå¼€å§‹çš„æ‰€æœ‰å­—æ®µï¼Œå¯»æ‰¾ç³»ç»Ÿç±»å‹
                for (let i = 3; i < basicInfo.length; i++) {
                    const item = basicInfo[i];
                    if (systemKeywords.includes(item)) {
                        systemType = item;
                        break; // æ£€æµ‹åˆ°æ‰€å±ç³»ç»Ÿæ—¶ï¼Œå®Œç»“äº”è¦ç´ è½¬æ¢
                    }
                }
                    // æ‰€æœ‰å¡ç±»å‹éƒ½è®¾ç½®ä¸º"æ— å¡ç±»å‹"ï¼Œå¿½ç•¥åŸå§‹å¡ç±»å‹å­—æ®µ
                    cardType = 'æ— å¡ç±»å‹';
                    
                    // æå–ä¸»æ¿å‹å·
                    // 1. å…ˆå°è¯•ä»æ˜ç¡®æ ‡æ³¨ä¸­æå–
                    let modelMatch = nonStandardData.match(/ä¸»æ¿å‹å·ï¼š([^ï¼Œã€‚]+)/);
                    if (modelMatch && modelMatch[1]) {
                        motherboardModel = modelMatch[1].trim();
                    } else {
                        // 2. éå†æ‰€æœ‰å­—æ®µï¼ŒæŸ¥æ‰¾å‹å·
                        for (const item of basicInfo) {
                            // åŒ¹é…ä»»æ„å­—æ¯å¼€å¤´ï¼ŒåŒ…å«å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦å’Œä¸­æ–‡çš„å‹å·ï¼Œä¸åŒ…å«ç©ºæ ¼
                            const modelRegex = /^[A-Za-z][A-Za-z0-9\-\u4e00-\u9fa5]+$/;
                            if (modelRegex.test(item)) {
                                motherboardModel = item;
                                break;
                            }
                        }
                        
                        // 3. å¦‚æœè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œä»ç³»ç»Ÿç±»å‹åé¢æŸ¥æ‰¾å‹å·
                        if (!motherboardModel) {
                            let systemTypePos = -1;
                            for (const keyword of systemKeywords) {
                                const pos = nonStandardData.indexOf(keyword);
                                if (pos !== -1) {
                                    systemTypePos = pos + keyword.length;
                                    break;
                                }
                            }
                            
                            if (systemTypePos !== -1) {
                                // ä»ç³»ç»Ÿç±»å‹åé¢æå–å‹å·ï¼Œé‡åˆ°ç©ºæ ¼è‡ªåŠ¨ç»“æŸ
                                const textAfterSystem = nonStandardData.slice(systemTypePos).trim();
                                // åŒ¹é…ä»»æ„å­—æ¯å¼€å¤´ï¼ŒåŒ…å«å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦å’Œä¸­æ–‡çš„å‹å·ï¼Œé‡åˆ°ç©ºæ ¼åœæ­¢
                                const modelRegex = /^[A-Za-z][A-Za-z0-9\-\u4e00-\u9fa5]+/;
                                const match = textAfterSystem.match(modelRegex);
                                if (match && match[0]) {
                                    motherboardModel = match[0].trim();
                                }
                            }
                        }
                    }
                } else {
                    // å¤„ç†ç©ºæ ¼åˆ†éš”æ ¼å¼
                    basicInfo = nonStandardData.split(/\s+/).filter(item => item.trim() !== '');
                    
                    // å¤„ç†äº”è¦ç´ ï¼šå…¬å¸åç§°,å¾®ä¿¡å…¬ä¼—å·,å‚å•†ID,å¡ç±»å‹,æ‰€å±ç³»ç»Ÿ
                    // 1. å¤„ç†å…¬å¸åç§°
                    if (basicInfo.length >= 1) {
                        companyName = basicInfo[0];
                    }
                    
                    // 2. å¤„ç†å¾®ä¿¡å…¬ä¼—å· - ä¸ºç©ºæ—¶è¡¥å¡«å…¬å¸åç§°
                    if (basicInfo.length >= 2 && basicInfo[1].trim() !== '') {
                        wechatName = basicInfo[1];
                    } else {
                        wechatName = companyName; // å¾®ä¿¡å…¬ä¼—å·ä¸ºç©ºæ—¶ï¼Œé»˜è®¤è¡¥å¡«å…¬å¸åç§°
                    }
                    
                    // 3. å¤„ç†å‚å•†ID
                    if (basicInfo.length >= 3) {
                        vendorId = basicInfo[2];
                    }
                    
                    // 4. æ‰€æœ‰å¡ç±»å‹éƒ½è®¾ç½®ä¸º"æ— å¡ç±»å‹"
                    cardType = 'æ— å¡ç±»å‹';
                    
                    // 5. å¤„ç†æ‰€å±ç³»ç»Ÿ - æ£€æµ‹åˆ°æ‰€å±ç³»ç»Ÿæ—¶ï¼Œå®Œç»“äº”è¦ç´ è½¬æ¢
                    // éå†ä»ç¬¬å››ä¸ªå­—æ®µå¼€å§‹çš„æ‰€æœ‰å­—æ®µï¼Œå¯»æ‰¾ç³»ç»Ÿç±»å‹
                    for (let i = 3; i < basicInfo.length; i++) {
                        const item = basicInfo[i];
                        if (systemKeywords.includes(item)) {
                            systemType = item;
                            break; // æ£€æµ‹åˆ°æ‰€å±ç³»ç»Ÿæ—¶ï¼Œå®Œç»“äº”è¦ç´ è½¬æ¢
                        }
                    }
                    
                    // æå–ä¸»æ¿å‹å·
                    // 1. å…ˆå°è¯•ä»æ˜ç¡®æ ‡æ³¨ä¸­æå–
                    let modelMatch = nonStandardData.match(/ä¸»æ¿å‹å·ï¼š([^ï¼Œã€‚]+)/);
                    if (modelMatch && modelMatch[1]) {
                        motherboardModel = modelMatch[1].trim();
                    } else {
                        // 2. æ‰¾åˆ°ç³»ç»Ÿç±»å‹åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®
                        let systemTypePos = -1;
                        for (const keyword of systemKeywords) {
                            const pos = nonStandardData.indexOf(keyword);
                            if (pos !== -1) {
                                systemTypePos = pos + keyword.length;
                                break;
                            }
                        }
                        
                        if (systemTypePos !== -1) {
                            // 3. ä»ç³»ç»Ÿç±»å‹åé¢æå–ç¬¬ä¸€ä¸ªä»¥å­—æ¯å¼€å¤´çš„è¿ç»­å­—ç¬¦ä¸²ä½œä¸ºå‹å·
                            const textAfterSystem = nonStandardData.slice(systemTypePos).trim();
                            // åŒ¹é…ä»»æ„å­—æ¯å¼€å¤´ï¼ŒåŒ…å«å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦å’Œä¸­æ–‡çš„å‹å·ï¼Œé‡åˆ°ç©ºæ ¼åœæ­¢
                            const modelRegex = /^[A-Za-z][A-Za-z0-9\-\u4e00-\u9fa5]+/;
                            const match = textAfterSystem.match(modelRegex);
                            if (match && match[0]) {
                                motherboardModel = match[0].trim();
                            }
                        }
                        
                        // 4. å¦‚æœè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œéå†æ‰€æœ‰å­—æ®µï¼ŒæŸ¥æ‰¾å‹å·
                        if (!motherboardModel) {
                            for (const item of basicInfo) {
                                // åŒ¹é…ä»»æ„å­—æ¯å¼€å¤´ï¼ŒåŒ…å«å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦å’Œä¸­æ–‡çš„å‹å·ï¼Œä¸åŒ…å«ç©ºæ ¼
                                const modelRegex = /^[A-Za-z][A-Za-z0-9\-\u4e00-\u9fa5]+$/;
                                if (modelRegex.test(item)) {
                                    motherboardModel = item;
                                    break;
                                }
                            }
                        }
                    }
                    // å¡«å……ä¸»æ¿å‹å·
                    document.getElementById('motherboardModel').value = motherboardModel;
                }
                
                // äº”è¦ç´ å·²åœ¨å‰é¢å¤„ç†å®Œæˆï¼Œæ­¤å¤„ä¸å†é‡å¤å¤„ç†
                // åˆ é™¤é‡å¤çš„äº”è¦ç´ å¤„ç†é€»è¾‘ï¼Œä¿ç•™å¾®ä¿¡å…¬ä¼—å·ä¸ºç©ºæ—¶è¡¥å¡«å…¬å¸åç§°çš„ä¼˜åŒ–
                
                // æå–ä¸»æ¿å‹å·å’Œç³»ç»Ÿç±»å‹
                    if (basicInfo.length >= 1) {
                        // ä¼˜åŒ–ï¼šç³»ç»Ÿç±»å‹åé¢ï¼Œä»¥AIã€aiã€Aiã€Wã€YLç­‰å¼€å¤´ï¼Œå…è®¸-è¿å­—ç¬¦çš„å‹å·è¯†åˆ«
                        // 1. æ‰¾åˆ°ç³»ç»Ÿç±»å‹åœ¨basicInfoä¸­çš„ä½ç½®
                        let systemTypeIndex = -1;
                        for (let i = 0; i < basicInfo.length; i++) {
                            if (systemKeywords.includes(basicInfo[i])) {
                                systemTypeIndex = i;
                                break;
                            }
                        }
                        
                        // 2. ä»ç³»ç»Ÿç±»å‹åé¢å¼€å§‹æŸ¥æ‰¾å‹å·
                        let startIndex = systemTypeIndex + 1;
                        if (systemTypeIndex === -1) {
                            startIndex = 0; // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç³»ç»Ÿç±»å‹ï¼Œä»å¼€å§‹æŸ¥æ‰¾
                        }
                        
                        for (let i = startIndex; i < basicInfo.length; i++) {
                            const item = basicInfo[i];
                            // åŒ¹é…ä»¥AIã€aiã€Aiã€Wã€YLç­‰å¼€å¤´ï¼Œå…è®¸-è¿å­—ç¬¦å’Œä¸­æ–‡åç¼€çš„å‹å·
                            const modelRegex = /^(AI|ai|Ai|W|YL)[A-Za-z0-9\-]+(?:[\u4e00-\u9fa5])?$/;
                            if (modelRegex.test(item)) {
                                motherboardModel = item;
                                break;
                            }
                        }
                        // å¡«å……ä¸»æ¿å‹å·
                        document.getElementById('motherboardModel').value = motherboardModel;
                    }
                    
                    // å¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°ç³»ç»Ÿç±»å‹ï¼Œå°è¯•ä»æ‰€æœ‰åŸºæœ¬ä¿¡æ¯ä¸­åŒ¹é…
                    if (!systemType) {
                        const systemKeywords = ['è·ƒé¾™æ–°ç§æœ‰', 'è·ƒé¾™å…¬æœ‰å”®æ°´æœº', 'è·ƒé¾™å…¬æœ‰å”®æ°´æœºæœ‰åŸŸå', 'è·ƒé¾™æ–°å…¬æœ‰', 'è·ƒé¾™æ–°å…¬æœ‰æœ‰åŸŸå', 'è·ƒé¾™å…¬æœ‰', 'è·ƒé¾™å…¬æœ‰æœ‰åŸŸå', 'è·ƒé¾™2.0å…¬æœ‰', 'è·ƒé¾™3.0å…¬æœ‰', 'è·ƒé¾™ç§æœ‰', 'å®¢æˆ·ç§æœ‰'];
                        for (const item of basicInfo) {
                            if (systemKeywords.includes(item)) {
                                systemType = item;
                                break;
                            }
                        }
                    }
                
                // å®Œå…¨ä»åŸå§‹æ•°æ®æå–ç³»ç»Ÿç±»å‹ï¼Œä¸ä½¿ç”¨é»˜è®¤å€¼
                if (!systemType) {
                    // å®šä¹‰å®Œæ•´çš„ç³»ç»Ÿç±»å‹å…³é”®å­—æ•°ç»„
                    const systemKeywords = ['è·ƒé¾™æ–°ç§æœ‰', 'è·ƒé¾™å…¬æœ‰å”®æ°´æœº', 'è·ƒé¾™å…¬æœ‰å”®æ°´æœºæœ‰åŸŸå', 'è·ƒé¾™æ–°å…¬æœ‰', 'è·ƒé¾™æ–°å…¬æœ‰æœ‰åŸŸå', 'è·ƒé¾™å…¬æœ‰', 'è·ƒé¾™å…¬æœ‰æœ‰åŸŸå', 'è·ƒé¾™2.0å…¬æœ‰', 'è·ƒé¾™3.0å…¬æœ‰', 'è·ƒé¾™ç§æœ‰', 'å®¢æˆ·ç§æœ‰'];
                    // å°è¯•ä»æ•´ä¸ªéæ ‡å‡†æ•°æ®ä¸­åŒ¹é…
                    for (const keyword of systemKeywords) {
                        if (nonStandardData.includes(keyword)) {
                            systemType = keyword;
                            break;
                        }
                    }
                }
                
                // å¡«å……ç³»ç»Ÿç±»å‹åˆ°æ–°æ·»åŠ çš„è¾“å…¥æ¡†
                document.getElementById('systemType').value = systemType;
                
                // å°†åŸºç¡€ä¿¡æ¯å¡«å……åˆ°Excelæ•°æ®æ–‡æœ¬åŸŸ
                // æ ¼å¼ï¼šå…¬å¸åç§°	å¾®ä¿¡å…¬ä¼—å·	æ— å¡ç±»å‹	å‚å•†ID	ç³»ç»Ÿç±»å‹
                document.getElementById('excelData').value = `${companyName}\t${wechatName}\t${cardType}\t${vendorId}\t${systemType}`;
                
                // è§£ææ»¤èŠ¯å¯¿å‘½
                if (nonStandardData.includes('æµé‡')) {
                    document.getElementById('filterLifeType').value = '1';
                } else if (nonStandardData.includes('æ—¶é—´')) {
                    document.getElementById('filterLifeType').value = '0';
                }
                
                // è§£æICCIDèµ·å§‹å’Œç»“å°¾ï¼ˆæ”¯æŒæ¢è¡Œï¼ŒåŒ¹é…æ‰€æœ‰8986å¼€å¤´çš„ICCIDï¼‰
                const iccidRangeMatch = nonStandardData.match(/(8986[0-9A-F]+)\s*åˆ°\s*(8986[0-9A-F]+)/i);
                if (iccidRangeMatch && iccidRangeMatch[1] && iccidRangeMatch[2]) {
                    document.getElementById('iccidStart').value = iccidRangeMatch[1];
                    document.getElementById('iccidEnd').value = iccidRangeMatch[2];
                }
                
                // è§£æå…¥åº“æ•°é‡
                const countMatch = nonStandardData.match(/[ï¼ˆ(]\s*(\d+)\s*å¼ [ï¼‰)]/);
                if (countMatch && countMatch[1]) {
                    document.getElementById('inStockCount').value = countMatch[1];
                }
                
                // è§£æé€šé“2è„‰å†²ï¼ˆå†·æ°´è„‰å†²ï¼‰
                const coldPulseMatch = nonStandardData.match(/å†·æ°´(?:è·¯)?è„‰å†²(\d+)/);
                if (coldPulseMatch && coldPulseMatch[1]) {
                    document.getElementById('channel2Pulse').value = coldPulseMatch[1];
                }
                
                // è§£æé€šé“1è„‰å†²ï¼ˆçƒ­æ°´è„‰å†²ï¼‰
                const hotPulseMatch = nonStandardData.match(/çƒ­æ°´è„‰å†²(\d+)/);
                if (hotPulseMatch && hotPulseMatch[1]) {
                    document.getElementById('channel1Pulse').value = hotPulseMatch[1];
                }
                
                // è§£ææœªæ ‡æ˜ç±»å‹çš„è„‰å†²ï¼Œè‡ªåŠ¨å¡«å……åˆ°é€šé“2è„‰å†²
                if (!document.getElementById('channel2Pulse').value && !document.getElementById('channel1Pulse').value) {
                    const pulseMatch = nonStandardData.match(/è„‰å†²(\d+)/);
                    if (pulseMatch && pulseMatch[1]) {
                        document.getElementById('channel2Pulse').value = pulseMatch[1];
                    }
                }
                
                // è§£ææ£€ä¿®æ—¶é—´
                const maintainTimeMatch = nonStandardData.match(/æ£€ä¿®\s*æ—¶é—´ï¼š(\d+)|æ£€ä¿®(\d+)/);
                if (maintainTimeMatch) {
                    const maintainTime = maintainTimeMatch[1] || maintainTimeMatch[2];
                    if (maintainTime) {
                        document.getElementById('maintainTime').value = maintainTime;
                    }
                }
                
                // è§£æåˆ¶æ°´æ—¶é—´
                const waterTimeMatch = nonStandardData.match(/åˆ¶æ°´\s*æ—¶é—´ï¼š(\d+)|åˆ¶æ°´(\d+)/);
                if (waterTimeMatch) {
                    const waterTime = waterTimeMatch[1] || waterTimeMatch[2];
                    if (waterTime) {
                        document.getElementById('waterTime').value = waterTime;
                    }
                }
                
                // è§£æçƒ­æ°´è´¹ç‡ä¸ºå¤§/1é€šé“/çƒ­æ°´è€è´¹ç‡
                const hotOldRateMatch = nonStandardData.match(/çƒ­æ°´è´¹ç‡(\d+)/);
                if (hotOldRateMatch && hotOldRateMatch[1]) {
                    document.getElementById('rate1Hot').value = hotOldRateMatch[1];
                }
                
                // è§£æå†·æ°´è´¹ç‡ä¸ºå°/2é€šé“/å†·æ°´è€è´¹ç‡
                const coldOldRateMatch = nonStandardData.match(/å†·æ°´è´¹ç‡(\d+)/);
                if (coldOldRateMatch && coldOldRateMatch[1]) {
                    document.getElementById('rate2Cold').value = coldOldRateMatch[1];
                }
                
                // è§£æå†·æ°´è´¹ç‡2è·¯ä¸ºå°/2é€šé“/å†·æ°´è´¹ç‡
                const coldRate2Match = nonStandardData.match(/å†·æ°´è´¹ç‡2è·¯([\d.]+)å…ƒ\/å‡/);
                if (coldRate2Match && coldRate2Match[1]) {
                    document.getElementById('rate2ColdPerLiter').value = coldRate2Match[1];
                }
                
                // è§£æå†·æ°´è´¹ç‡(0.3)å…ƒ/å‡æ ¼å¼ä¸ºå°/2é€šé“/å†·æ°´è´¹ç‡
                const coldRateWithBracketsMatch = nonStandardData.match(/å†·æ°´è´¹ç‡\(([\d.]+)\)å…ƒ\/å‡/);
                if (coldRateWithBracketsMatch && coldRateWithBracketsMatch[1]) {
                    document.getElementById('rate2ColdPerLiter').value = coldRateWithBracketsMatch[1];
                }
                
                // è§£æçƒ­æ°´è´¹ç‡1è·¯ä¸ºå¤§/1é€šé“/çƒ­æ°´è´¹ç‡
                const hotRate1Match = nonStandardData.match(/çƒ­æ°´è´¹ç‡1è·¯([\d.]+)å…ƒ\/å‡/);
                if (hotRate1Match && hotRate1Match[1]) {
                    document.getElementById('rate1HotPerLiter').value = hotRate1Match[1];
                }
                
                // è§£æå¤§/1é€šé“/çƒ­æ°´è´¹ç‡å…ƒ/å‡ï¼ˆä¿ç•™åŸæœ‰é€»è¾‘ï¼‰
                const hotRateMatch = nonStandardData.match(/å¤§\/1é€šé“\/çƒ­æ°´è´¹ç‡\[å…ƒ\/å‡\]([\d.]+)/);
                if (hotRateMatch && hotRateMatch[1]) {
                    document.getElementById('rate1HotPerLiter').value = hotRateMatch[1];
                }
                
                // è§£æå°/2é€šé“/å†·æ°´è´¹ç‡å…ƒ/å‡ï¼ˆä¿ç•™åŸæœ‰é€»è¾‘ï¼‰
                const coldRateMatch = nonStandardData.match(/å°\/2é€šé“\/å†·æ°´è´¹ç‡\[å…ƒ\/å‡\]([\d.]+)/);
                if (coldRateMatch && coldRateMatch[1]) {
                    document.getElementById('rate2ColdPerLiter').value = coldRateMatch[1];
                }
                
                // è§£æé™åˆ¶æµé‡
                const limitFlowMatch = nonStandardData.match(/é™åˆ¶æµé‡(\d+)/);
                if (limitFlowMatch && limitFlowMatch[1]) {
                    document.getElementById('singleLimitFlow').value = limitFlowMatch[1];
                }
                
                // è§£ææµ®çƒ
                const floatBallMatch = nonStandardData.match(/æµ®çƒ(\d+)/);
                if (floatBallMatch && floatBallMatch[1]) {
                    document.getElementById('floatBall').value = floatBallMatch[1];
                }
                
                // è§£æå•æ¬¡é™åˆ¶æ—¶é—´
                const limitTimeMatch = nonStandardData.match(/å•æ¬¡é™åˆ¶(\d+)/);
                if (limitTimeMatch && limitTimeMatch[1]) {
                    document.getElementById('singleLimitTime').value = limitTimeMatch[1];
                }
                
                // è§£æå¡æµé‡
                const cardFlowMatch = nonStandardData.match(/(\d+)M/);
                if (cardFlowMatch && cardFlowMatch[1]) {
                    document.getElementById('cardFlow').value = cardFlowMatch[1];
                }
                
                // è§£æåŠ çƒ­æœ€é«˜æ¸©ä¸ºçƒ­æ°´ æ¸©åº¦
                const hotWaterTempMatch = nonStandardData.match(/åŠ çƒ­æœ€é«˜æ¸©(\d+)/);
                if (hotWaterTempMatch && hotWaterTempMatch[1]) {
                    document.getElementById('hotWaterTemp').value = hotWaterTempMatch[1];
                }
                
                // è§£æé˜€2æ”¾æ°´æ—¶é—´[å†·ã€å°]ï¼šåŒ¹é…å¤šç§æ ¼å¼
                // åŒ¹é…æ ¼å¼1ï¼šæ”¾æ°´æ—¶é—´å†·2è·¯6
                // åŒ¹é…æ ¼å¼2ï¼šå†·2è·¯6
                // åŒ¹é…æ ¼å¼3ï¼šé˜€2æ”¾æ°´æ—¶é—´å†·2è·¯6
                let valve2Time = '';
                const valve2TimeMatch = nonStandardData.match(/æ”¾æ°´æ—¶é—´å†·2è·¯(\d+)/i);
                if (valve2TimeMatch && valve2TimeMatch[1]) {
                    valve2Time = valve2TimeMatch[1];
                    document.getElementById('valve2Time').value = valve2Time;
                }
                
                // è§£æé˜€1æ”¾æ°´æ—¶é—´[ç½è£…ã€å¤§ã€çƒ­]ï¼šåŒ¹é…å¤šç§æ ¼å¼
                // åŒ¹é…æ ¼å¼1ï¼šçƒ­1è·¯6
                // åŒ¹é…æ ¼å¼2ï¼šé˜€1æ”¾æ°´æ—¶é—´çƒ­1è·¯6
                // åŒ¹é…æ ¼å¼3ï¼šæ”¾æ°´æ—¶é—´çƒ­1è·¯6
                // åŒ¹é…æ ¼å¼4ï¼šå¦‚æœæ²¡æœ‰æ˜ç¡®çƒ­1è·¯å‚æ•°ï¼Œä½¿ç”¨å†·2è·¯çš„å‚æ•°å€¼
                const valve1TimeMatch = nonStandardData.match(/(?:æ”¾æ°´æ—¶é—´|é˜€1æ”¾æ°´æ—¶é—´)?çƒ­1è·¯(\d+)/i);
                if (valve1TimeMatch && valve1TimeMatch[1]) {
                    document.getElementById('valve1Time').value = valve1TimeMatch[1];
                } else {
                    // å¦‚æœæ²¡æœ‰æ‰¾åˆ°çƒ­1è·¯å‚æ•°ï¼Œä½¿ç”¨å†·2è·¯çš„å‚æ•°å€¼ä½œä¸ºé»˜è®¤å€¼
                    if (valve2Time) {
                        document.getElementById('valve1Time').value = valve2Time;
                    }
                }
                
                // è‡ªåŠ¨æå–æ ‡å‡†åŒ–ä¿¡æ¯
                extractData();
            }
            
            // æ¸…ç©ºæ‰€æœ‰æ•°æ®çš„å‡½æ•°
            function clearAllData() {
                // æ¸…ç©ºExcelæ•°æ®åŒºåŸŸ
                document.getElementById('excelData').value = '';
                
                // æ¸…ç©ºå‚æ•°è®¾ç½®åŒºåŸŸ
                document.getElementById('motherboardModel').value = '';
                document.getElementById('filterLifeType').value = '';
                document.getElementById('channel2Pulse').value = '';
                document.getElementById('channel1Pulse').value = '';
                document.getElementById('waterTime').value = '';
                document.getElementById('valve2Time').value = '';
                document.getElementById('valve1Time').value = '';
                document.getElementById('maintainTime').value = '';
                document.getElementById('rate1Hot').value = '';
                document.getElementById('rate2Cold').value = '';
                document.getElementById('rate1HotPerLiter').value = '';
                document.getElementById('rate2ColdPerLiter').value = '';
                document.getElementById('singleLimitFlow').value = '';
                document.getElementById('floatBall').value = '';
                document.getElementById('singleLimitTime').value = '';
                document.getElementById('cardFlow').value = '';
                document.getElementById('hotWaterTemp').value = '';
                document.getElementById('iccidStart').value = '';
                document.getElementById('iccidEnd').value = '';
                document.getElementById('inStockCount').value = '';
                
                // æ¸…ç©ºç»“æœæ˜¾ç¤ºåŒºåŸŸ
                document.getElementById('result').textContent = '';
            }
            </script>

        <!-- äºŒç»´ç ç”Ÿæˆå™¨å·¥å…·æ¨¡å— -->
        <section id="qrGeneratorTool" class="calculator" style="display: none;">
            <h2>ğŸ”² äºŒç»´ç æ‰¹é‡ç”Ÿæˆå™¨</h2>
            
            <div class="info-box">
                <strong>ğŸ“‹ åŠŸèƒ½è¯´æ˜ï¼š</strong><br>
                1. ä½¿ç”¨ç¨³å®šçš„äºŒç»´ç APIï¼Œæ— è·¨åŸŸé™åˆ¶<br>
                2. è‡ªåŠ¨åœ¨äºŒç»´ç ä¸‹æ–¹æ·»åŠ IMEIæ–‡å­—ï¼Œæ–‡å­—å¤§å°è‡ªé€‚åº”äºŒç»´ç å®½åº¦<br>
                3. è¾“å‡ºä¸º360x360pxæ­£æ–¹å½¢PNGå›¾ç‰‡ï¼Œä¾¿äºæ‰“å°å’Œä½¿ç”¨<br>
                4. æ”¯æŒæ‰¹é‡ç”Ÿæˆå’ŒZIPæ‰“åŒ…ä¸‹è½½ï¼Œç¨³å®šå¯é 
            </div>
            
            <div class="form-group">
                <label for="qrPrefix">äºŒç»´ç å‰ç¼€ï¼š</label>
                <input type="text" id="qrPrefix" placeholder="ä¾‹ï¼šhttp://cloud.yuelongxinxi.com/qr/" value="http://cloud.yuelongxinxi.com/qr/">
            </div>
            
            <div class="form-group">
                <label for="qrImeiList">IMEIåˆ—è¡¨ï¼ˆä¸€è¡Œä¸€ä¸ªï¼‰ï¼š</label>
                <textarea id="qrImeiList" placeholder="è¯·è¾“å…¥IMEIï¼Œä¸€è¡Œä¸€ä¸ªï¼Œä¾‹å¦‚ï¼š&#10;860256072911545&#10;860256072911546&#10;860256072911547"></textarea>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" id="qrGenerateBtn">
                    <span id="qrGenerateBtnText">ğŸ”² ç”ŸæˆäºŒç»´ç </span>
                    <span id="qrGenerateBtnLoading" class="loading" style="display: none;"></span>
                </button>
                <button class="btn btn-success" id="qrDownloadBtn" disabled>
                    ğŸ“¦ æ‰“åŒ…ä¸‹è½½ (PNGæ ¼å¼)
                </button>
            </div>
            
            <div class="api-status" id="qrApiStatus">
                <span class="api-icon">ğŸ“¡</span>
                <span id="qrApiStatusText">å‡†å¤‡ç”ŸæˆäºŒç»´ç ...</span>
            </div>
            
            <div class="progress-container" id="qrProgressContainer">
                <div class="progress-bar">
                    <div class="progress-fill" id="qrProgressFill"></div>
                </div>
                <div class="progress-text" id="qrProgressText">å‡†å¤‡ç”Ÿæˆ...</div>
            </div>
            
            <div class="error-message" id="qrErrorMessage"></div>
            <div class="success-message" id="qrSuccessMessage"></div>
            
            <div class="qr-grid" id="qrGrid"></div>
        </section>
        <!-- æ—¥å¿—åˆ†æå™¨å·¥å…·æ¨¡å— -->
            <section id="logAnalysisTool" class="calculator" style="display: none;">
                <h2>ğŸ“Š æ—¥å¿—åˆ†æå™¨</h2>
            <div style="font-weight: 600; color: #856404; margin-bottom: 5px;">ğŸ’¡ å¤‡å¿˜å½•ï¼š</div>
                        <div style="color: #856404; font-size: 14px;">
                            â€¢ ä¼˜è¨ç‰¹æ®Šæµé€Ÿ=æœ¬æ¬¡æ¶ˆè´¹æµé‡/å……å€¼æµé‡*60=Xæ¯«å‡/1åˆ†é’Ÿã€‚<br>
            <div class="log-analysis-tool">
                <div class="log-input-section">
                    <textarea id="logInput" placeholder="è¯·ç²˜è´´åŸå§‹æ—¥å¿—æ•°æ®ï¼Œæ¯è¡Œä¸€æ¡æ•°æ®...

    æ”¯æŒçš„æ•°æ®æ ¼å¼ï¼š
    â€¢ ç±»å‹1: 0000011800800100000000001e012c000a000000000002009700000000000000000153588000000000025000000000a80100026a
    â€¢ ç±»å‹2: 000035F1 00-80-00 0001 0BB8-000F 0258-0003 004B-0000 0000-0000 0000-2DDD-0000-0324-0332 0000-0000-0000-0000-0001 0000C03C 00 0584
    â€¢ ç±»å‹3: 0000000C01440600000000000000000000012CD4C0000001E000000000000000000D0A000000010014070800000001000000141F1F000D030397
    â€¢ ç±»å‹4: 00003B13 05-0C-09 0000 00000000-0000 00000000-0000 00005B1B-0146 0000-0000 0000-0000-4125-0000-0000 4E20-4E20-9C40-4E20-4E20 1C1DCF2A 03 0554

    æ”¯æŒåŠŸèƒ½ï¼š
    1. è‡ªåŠ¨è¯†åˆ«å¤šç§æ•°æ®ç±»å‹å¹¶åº”ç”¨ç›¸åº”çš„è§£æè§„åˆ™
    2. æ ¼å¼çµæ´»ï¼šæ”¯æŒå¸¦æˆ–ä¸å¸¦"-"åˆ†éš”ç¬¦çš„æ•°æ®æ ¼å¼
    3. è¡¨æ ¼å±•ç¤ºï¼šä½¿ç”¨è¡¨æ ¼æ¸…æ™°å±•ç¤ºæ¯ä¸ªå­—æ®µçš„å€¼å’Œä½ç½®
    4. ç»Ÿè®¡ä¿¡æ¯ï¼šæ˜¾ç¤ºè§£ææˆåŠŸå’Œå¤±è´¥çš„æ¡ç›®æ•°
    5. å¿«æ·é”®ï¼šæŒ‰Ctrl+Enterå¯å¿«é€Ÿåˆ†ææ•°æ®

    æ•°æ®å­—æ®µè¯´æ˜ï¼š
    â€¢ è®¾å¤‡IDã€è®¡è´¹æ¨¡å¼ã€å‘½ä»¤ã€è®¾å¤‡çŠ¶æ€
    â€¢ æœ¬æ¬¡æ¶ˆè´¹ã€å……å€¼æµé‡ã€å……å€¼å¤©æ•°ã€å‰©ä½™æµé‡ã€å‰©ä½™å¤©æ•°
    â€¢ å·²ç”¨æµé‡ã€å·²ç”¨å¤©æ•°ã€çº¯æ°´TDSã€åŸæ°´TDS
    â€¢ å„çº§æ»¤èŠ¯å¯¿å‘½ã€æœ€å¤§æ»¤èŠ¯å¯¿å‘½
    â€¢ åŒ—äº¬æ—¶é—´ã€æœºå™¨ç±»å‹ã€æ ¡éªŒç 

    ä½¿ç”¨æç¤ºï¼š
    - æ¯è¡Œè¾“å…¥ä¸€æ¡æ•°æ®ï¼Œå¯æ‰¹é‡è§£æå¤šæ¡æ—¥å¿—
    - å·¥å…·ä¼šè‡ªåŠ¨æ¸…ç†æ•°æ®ä¸­çš„ç©ºæ ¼å’Œåˆ†éš”ç¬¦
    - è¡¨æ ¼æ”¯æŒæ°´å¹³æ»šåŠ¨æŸ¥çœ‹å®Œæ•´æ•°æ®
    - æ‚¬åœåœ¨è¡¨æ ¼å•å…ƒæ ¼ä¸Šå¯æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
    - è§£æé”™è¯¯æ—¶ä¼šæ˜¾ç¤ºå…·ä½“é”™è¯¯åŸå› å’ŒåŸå§‹æ•°æ®
    - æ”¯æŒå¤šç§æ—¥å¿—æ ¼å¼çš„è‡ªåŠ¨è¯†åˆ«ä¸è§£æ

    è¾“å…¥ç¤ºä¾‹ï¼š
    0000011800800100000000001e012c000a000000000002009700000000000000000153588000000000025000000000a80100026a
    000035F1 00-80-00 0001 0BB8-000F 0258-0003 004B-0000 0000-0000 0000-2DDD-0000-0324-0332 0000-0000-0000-0000-0001 0000C03C 00 0584
    0000000C01440600000000000000000000012CD4C0000001E000000000000000000D0A000000010014070800000001000000141F1F000D030397
    00003B13 05-0C-09 0000 00000000-0000 00000000-0000 00005B1B-0146 0000-0000 0000-0000-4125-0000-0000 4E20-4E20-9C40-4E20-4E20 1C1DCF2A 03 0554

    âš¡ æŒ‰ Ctrl+Enter å¿«é€Ÿåˆ†ææ•°æ® âš¡"></textarea>
                    
                    <div class="buttons-section">
                        <button id="analyzeBtn" class="analyze-btn">ğŸš€ åˆ†ææ•°æ®</button>
                        <button id="parseImeiIccidBtn" class="analyze-btn">ğŸ” è§£æimeiå’Œiccid</button>
                        <button id="clearLogBtn" class="clear-btn">ğŸ—‘ï¸ æ¸…ç©º</button>
                    </div>
                </div>
                
                <div id="statusSection" class="status-section"></div>
                
                <div class="result-section">
                    <div class="result-content">
                        <!-- è§£æç»“æœå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="imeiIccidResult">IMEIå’ŒICCIDè§£æç»“æœï¼š</label>
                    <textarea id="imeiIccidResult" class="result-area" rows="10" readonly placeholder="IMEIå’ŒICCIDè§£æç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
                </div>
            </div>
        </section>
        <section id="stockParamTool" class="calculator" style="display: none;">
            <h2>ğŸ“¦ å…¥åº“å‚æ•°ç”Ÿæˆå™¨</h2>
            
            <div class="tool-section">
                <h3>ä¸€é”®è½¬æ¢åŒºåŸŸ</h3>
                <div class="form-group">
                    <label for="nonStandardData">ç²˜è´´éæ ‡å‡†å†…å®¹ï¼š</label>
                    <textarea id="nonStandardData" placeholder="ä¾‹å¦‚ï¼šä¸­å›½æ°´åŠ¡-åˆ†å®œåŠäº©-å»ºçƒ¨  é“¶é¾™ç›´é¥®æ°´    1001    è·ƒé¾™æ–°ç§æœ‰   WSSJ2-B1   æµé‡æ»¤èŠ¯  å†·æ°´è·¯è„‰å†²330ï¼Œçƒ­æ°´è„‰å†²330  æ£€ä¿®720ï¼Œå¤§/1é€šé“/çƒ­æ°´è´¹ç‡[å…ƒ/å‡]0.5ï¼Œå°/2é€šé“/å†·æ°´è´¹ç‡[å…ƒ/å‡]0.5ï¼Œé™åˆ¶æµé‡7500,æµ®çƒ7ï¼Œå•æ¬¡é™åˆ¶300  æŒ‡å®šID 
 898604E70623D0181822åˆ° 
 898604E70623D0181831ï¼ˆ10å¼ ï¼‰  18M "></textarea>
                </div>
                <button class="btn" onclick="convertData()">ä¸€é”®è½¬æ¢</button>
            </div>
            
            <div class="result-area" id="result" style="margin-top: 20px;"></div>
            
            <div class="tool-section">
                <h3>å‚æ•°è®¾ç½®</h3>
                <div class="parameter-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                    <div class="input-wrapper">
                        <label for="motherboardModel">ä¸»æ¿å‹å·:</label>
                        <input type="text" id="motherboardModel">
                    </div>
                    <div class="input-wrapper">
                        <label for="systemType">ç³»ç»Ÿç±»å‹:</label>
                        <input type="text" id="systemType" placeholder="ä¾‹å¦‚ï¼šè·ƒé¾™å…¬æœ‰å”®æ°´æœº">
                    </div>
                    <div class="input-wrapper">
                        <label for="filterLifeType" style="color: red;">æ»¤èŠ¯å¯¿å‘½:</label>
                        <select id="filterLifeType">
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="0">0.æ—¶é—´</option>
                            <option value="1">1.æµé‡</option>
                        </select>
                    </div>
                    <div class="input-wrapper">
                        <label for="channel2Pulse" style="color: red;">é€šé“2è„‰å†²[å†·ã€å°2]:</label>
                        <input type="text" id="channel2Pulse">
                    </div>
                    <div class="input-wrapper">
                        <label for="channel1Pulse">é€šé“1è„‰å†²[çƒ­,å¤§]:</label>
                        <input type="text" id="channel1Pulse">
                    </div>
                    <div class="input-wrapper">
                        <label for="waterTime" style="color: red;">åˆ¶æ°´æ—¶é—´:</label>
                        <input type="text" id="waterTime">
                    </div>
                    <div class="input-wrapper">
                        <label for="valve2Time">é˜€2æ”¾æ°´æ—¶é—´[å†·ã€å°]:</label>
                        <input type="text" id="valve2Time">
                    </div>
                    <div class="input-wrapper">
                        <label for="valve1Time">é˜€1æ”¾æ°´æ—¶é—´[ç½è£…ã€å¤§ã€çƒ­]:</label>
                        <input type="text" id="valve1Time">
                    </div>
                    <div class="input-wrapper">
                        <label for="maintainTime" style="color: red;">æ£€ä¿® æ—¶é—´ï¼š</label>
                        <input type="text" id="maintainTime">
                    </div>
                    <div class="input-wrapper">
                        <label for="rate1Hot">å¤§/1é€šé“/çƒ­æ°´è€è´¹ç‡:</label>
                        <input type="text" id="rate1Hot">
                    </div>
                    <div class="input-wrapper">
                        <label for="rate2Cold">å°/2é€šé“/å†·æ°´è€è´¹ç‡:</label>
                        <input type="text" id="rate2Cold">
                    </div>
                    <div class="input-wrapper">
                        <label for="rate1HotPerLiter">å¤§/1é€šé“/çƒ­æ°´è´¹ç‡ï¼š</label>
                        <input type="text" id="rate1HotPerLiter">
                    </div>
                    <div class="input-wrapper">
                        <label for="rate2ColdPerLiter">å°/2é€šé“/å†·æ°´è´¹ç‡ï¼š</label>
                        <input type="text" id="rate2ColdPerLiter">
                    </div>
                    <div class="input-wrapper">
                        <label for="singleLimitFlow">å•æ¬¡é™åˆ¶æµé‡/ç®±3:</label>
                        <input type="text" id="singleLimitFlow">
                    </div>
                    <div class="input-wrapper">
                        <label for="floatBall">æµ®çƒ-æ´¾å£«:</label>
                        <input type="text" id="floatBall">
                    </div>
                    <div class="input-wrapper">
                        <label for="singleLimitTime">å•æ¬¡é™åˆ¶æ—¶é—´:</label>
                        <input type="text" id="singleLimitTime">
                    </div>
                    <div class="input-wrapper">
                        <label for="cardFlow" style="color: red;">å¡æµé‡:</label>
                        <input type="text" id="cardFlow">
                    </div>
                    <div class="input-wrapper">
                        <label for="hotWaterTemp">çƒ­æ°´ æ¸©åº¦:</label>
                        <input type="text" id="hotWaterTemp">
                    </div>
                    <div class="input-wrapper">
                        <label for="iccidStart">ICCIDèµ·å§‹:</label>
                        <input type="text" id="iccidStart">
                    </div>
                    <div class="input-wrapper">
                        <label for="iccidEnd">ICCIDç»“å°¾:</label>
                        <input type="text" id="iccidEnd">
                    </div>
                    <div class="input-wrapper">
                        <label for="inStockCount">å…¥åº“æ•°é‡:</label>
                        <input type="text" id="inStockCount">
                    </div>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="extractData()">æå–æ•°æ®</button>
            
            <div style="margin-top: 20px; padding: 15px; background-color: #fff3cd; border: 1px solid #ffeeba; border-radius: 4px; color: #856404;">
                <strong>æç¤ºï¼š</strong>å®¶ç”¨æœºå¸¸ç”¨å‚æ•°ä¸ºçº¢è‰²æ ‡æ³¨é¡¹ã€‚ä¸€èˆ¬åŒ…å«ï¼šæ»¤èŠ¯å¯¿å‘½:ã€é€šé“2è„‰å†²\[å†·ã€å°2]:ã€åˆ¶æ°´æ—¶é—´:ã€æ£€ä¿®æ—¶é—´ã€å¡æµé‡ã€‚
            </div>
            
            <div class="tool-section">
                <h3>æ•°æ®ç²˜è´´åŒºåŸŸ</h3>
                <div class="form-group">
                    <label for="excelData">ä»Excelç²˜è´´æ•°æ®ï¼ˆå…¬å¸åç§°,å¾®ä¿¡å…¬ä¼—å·,å‚å•†ID,å¡ç±»å‹,æ‰€å±ç³»ç»Ÿï¼‰ï¼š</label>
                    <textarea id="excelData" placeholder="ä¾‹å¦‚ï¼šé«˜å¯†å¸‚æ³‰ç¢§ç„¶ä¾›æ°´æœ‰é™å…¬å¸	é«˜å¯†æ³‰ç¢§ç„¶æ™ºæ…§å‡€æ°´	1028	ç¿”ä¸œå¡	è·ƒé¾™å…¬æœ‰å”®æ°´æœº"></textarea>
                </div>
            </div>
            
            <div style="margin-top: 20px; padding: 15px; background-color: #fff3cd; border: 1px solid #ffeeba; border-radius: 4px; color: #856404;">
                <strong>æç¤ºï¼š</strong>å®¶ç”¨æœºå¸¸ç”¨å‚æ•°ä¸ºçº¢è‰²æ ‡æ³¨é¡¹ã€‚ä¸€èˆ¬åŒ…å«ï¼šæ»¤èŠ¯å¯¿å‘½:ã€é€šé“2è„‰å†²[å†·ã€å°2]:ã€åˆ¶æ°´æ—¶é—´:ã€æ£€ä¿®æ—¶é—´ã€å¡æµé‡ã€‚
            </div>
        </section>
        <section id="qrParserTool" class="calculator" style="display: none;">
            <h2>ğŸ” äºŒç»´ç è§£æå·¥å…·</h2>
            
            <div class="info-box">
                <strong>ğŸ“‹ åŠŸèƒ½è¯´æ˜ï¼š</strong><br>
                1. æ”¯æŒä¸Šä¼ æ–‡ä»¶å¤¹æˆ–å•ä¸ªå›¾ç‰‡æ–‡ä»¶<br>
                2. è‡ªåŠ¨æå–æ–‡ä»¶å¤¹ä¸­çš„å›¾ç‰‡æ–‡ä»¶<br>
                3. è§£ææ‰€æœ‰å›¾ç‰‡ä¸­çš„äºŒç»´ç å†…å®¹<br>
                4. è¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡å­—å†…å®¹<br>
                5. æ˜¾ç¤ºæ‰€æœ‰è§£æç»“æœ<br>
                6. å¯æå–äºŒç»´ç å†…å®¹ä¸­çš„15ä½ä»¥å†…æ•°å­—åç¼€
            </div>
            
            <div class="form-group">
                <label for="fileUpload">ä¸Šä¼ æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š</label>
                <div id="dropArea" style="height: 150px; border: 2px dashed #ccc; border-radius: 8px; padding: 20px; text-align: center; line-height: 110px; cursor: pointer; transition: all 0.3s ease;">
                    <span id="dropText">ğŸ“ ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡æ–‡ä»¶åˆ°è¿™é‡Œä¸Šä¼ </span>
                    <input type="file" id="fileUpload" multiple webkitdirectory directory accept="image/*" style="display: none;">
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" id="parseQrBtn">
                    ğŸ” å¼€å§‹è§£æäºŒç»´ç 
                </button>
                <button class="btn btn-primary" id="textRecognitionBtn">
                    ğŸ”¤ æ–‡å­—è¯†åˆ«
                </button>
                <button class="btn btn-success" id="extractInfoBtn" disabled>
                    ğŸ“‹ æå–ä¿¡æ¯
                </button>
                <button class="btn btn-info" id="copyExtractedBtn" disabled>
                    ğŸ“‹ å¤åˆ¶ç»“æœ
                </button>
                <button class="btn btn-secondary" id="formatForBackendBtn" disabled>
                    ğŸ“ ä¿®æ”¹ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼
                </button>
                
                <button class="btn btn-danger" id="clearQrBtn">
                    ğŸ—‘ï¸ æ¸…ç©º
                </button>
            </div>
            
            <div class="status-section" id="qrParserStatus" style="display: none;"></div>
            
            <!-- å›¾ç‰‡é¢„è§ˆåŒºåŸŸ -->
            <div id="imagePreviewArea" style="margin: 20px 0;">
                <!-- å›¾ç‰‡é¢„è§ˆå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="form-group">
                <label for="qrResults">äºŒç»´ç è§£æç»“æœï¼š</label>
                <textarea id="qrResults" class="result-area" rows="15" readonly placeholder="è§£æç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="extractedInfo">æå–çš„ä¿¡æ¯ï¼š</label>
                <textarea id="extractedInfo" class="result-area" rows="8" readonly placeholder="æå–çš„15ä½ä»¥å†…æ•°å­—å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
            </div>
            
            <style>
                #imagePreviewArea {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                    gap: 15px;
                }
                
                .image-preview-item {
                    border: 1px solid #ddd;
                    border-radius: 5px;
                    padding: 10px;
                    background-color: #f9f9f9;
                }
                
                .preview-image {
                    max-width: 100%;
                    max-height: 200px;
                    object-fit: contain;
                    margin-bottom: 10px;
                    border-radius: 3px;
                }
                
                .image-results {
                    font-size: 14px;
                    line-height: 1.6;
                }
                
                .qr-info {
                    color: #165DFF;
                    font-weight: 500;
                }
                
                .text-info {
                    color: #36CFC9;
                }
            </style>
        </section>
        
        <section id="logAnalysisTool2" class="calculator" style="display: none;">
            <h2>ğŸ“Š æ—¥å¿—è§£æå™¨</h2>
            
            <div class="log-analysis-tool">
                <div class="log-input-section">
                    <textarea id="logInput2" placeholder="è¯·ç²˜è´´åŸå§‹æ—¥å¿—æ•°æ®ï¼Œæ¯è¡Œä¸€æ¡æ•°æ®...

    âš¡ æŒ‰ Ctrl+Enter å¿«é€Ÿåˆ†ææ•°æ® âš¡"></textarea>
                    
                    <div class="buttons-section">
                        <button id="analyzeBtn2" class="analyze-btn" onclick="analysis2()">ğŸš€ åˆ†ææ•°æ®</button>
                        <button id="clearLogBtn" class="clear-btn">ğŸ—‘ï¸ æ¸…ç©º</button>
                    </div>
                </div>
                
                <div id="statusSection" class="status-section"></div>
                
                <div class="result-section">
                    <div class="result-content">
                        <!-- è§£æç»“æœå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
        </section>
        <script>
            // å…¨å±€å®šä¹‰analysis2å‡½æ•°ï¼Œç¡®ä¿æŒ‰é’®ç‚¹å‡»æ—¶å¯ä»¥è®¿é—®
            function analysis2() {
                // è·å–æœ€æ–°çš„è¾“å…¥å€¼
                const rawInput2 = document.getElementById('logInput2').value.trim();
                
                // æ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸ºç©º
                if (!rawInput2) {
                    alert('è¯·è¾“å…¥æ—¥å¿—æ•°æ®ï¼');
                    return;
                }
                
                try {
                    // è°ƒç”¨logDecode.jsä¸­çš„analysiså‡½æ•°å¤„ç†æ—¥å¿—æ•°æ®
                    const result = analysis(rawInput2);
                    
                    // è·å–ç»“æœæ˜¾ç¤ºåŒºåŸŸ
                    const resultContent = document.querySelector('#logAnalysisTool2 .result-content');
                    
                    // æ£€æŸ¥resultæ˜¯å¦å­˜åœ¨å¹¶æ ¼å¼åŒ–æ˜¾ç¤ºç»“æœ
                    if (result && typeof result === 'object') {
                        // æŒ‰ç…§å…¥åº“å‚æ•°è§£æå™¨çš„æ ·å¼æ˜¾ç¤ºç»“æœ
                        let html = '<div class="param-results"><div class="param-group"><div class="param-column"><h4>è§£æç»“æœï¼š</h4>';
                        
                        // éå†resultå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œåªæ˜¾ç¤ºéç©ºçš„value
                        for (const [key, value] of Object.entries(result)) {
                            // æ£€æŸ¥valueæ˜¯å¦å­˜åœ¨ä¸”ä¸ä¸ºç©º
                            if (value && value.trim() !== '') {
                                html += `<div>${value}</div>`;
                            }
                        }
                        
                        html += '</div></div></div>';
                        resultContent.innerHTML = html;
                    } else if (typeof result === 'string') {
                        // å¦‚æœresultæ˜¯å­—ç¬¦ä¸²ï¼Œç›´æ¥æ˜¾ç¤º
                        resultContent.innerHTML = `<div class="param-results"><div class="param-group"><div class="param-column"><h4>è§£æç»“æœï¼š</h4><div>${result}</div></div></div></div>`;
                    } else {
                        // å¦‚æœæ²¡æœ‰æœ‰æ•ˆçš„ç»“æœï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                        resultContent.innerHTML = '<div class="error-message">æ— æ³•è§£ææ—¥å¿—æ•°æ®ï¼Œè¯·æ£€æŸ¥è¾“å…¥æ ¼å¼ã€‚</div>';
                    }
                } catch (error) {
                    console.error('æ—¥å¿—è§£æé”™è¯¯:', error);
                    const resultContent = document.querySelector('#logAnalysisTool2 .result-content');
                    resultContent.innerHTML = `<div class="error-message">è§£æå‡ºé”™ï¼š${error.message}</div>`;
                }
            }
            
            $(document).ready(function() {
                // ä¸ºæ—¥å¿—è§£æå™¨2æ·»åŠ å¿«æ·é”®æ”¯æŒï¼ˆCtrl+Enterï¼‰
                const logInput2Element = document.getElementById('logInput2');
                if (logInput2Element) {
                    logInput2Element.addEventListener('keydown', function(event) {
                        if (event.ctrlKey && event.key === 'Enter') {
                            event.preventDefault();
                            analysis2();
                        }
                    });
                }
            });
        </script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
        <script>
            // ===== æ—¥å¿—è§£æåŠŸèƒ½ logDecode.js =====
            // æ•°æ®ç±»å‹å®šä¹‰
            const dataTypes = {
                type1: {
                    name: "æ•°æ®ç±»å‹1 (52å­—èŠ‚)",
                    fields: [
                        {name: "è®¾å¤‡ID", start: 0, end: 3},
                        {name: "è®¡è´¹æ¨¡å¼", start: 4, end: 4},
                        {name: "å‘½ä»¤", start: 5, end: 5},
                        {name: "è®¾å¤‡çŠ¶æ€", start: 6, end: 6},
                        {name: "æœ¬æ¬¡æ¶ˆè´¹", start: 7, end: 8},
                        {name: "å……å€¼æµé‡", start: 9, end: 10},
                        {name: "å……å€¼å¤©æ•°", start: 11, end: 12},
                        {name: "å‰©ä½™æµé‡", start: 13, end: 14},
                        {name: "å‰©ä½™å¤©æ•°", start: 15, end: 16},
                        {name: "å·²ç”¨æµé‡", start: 17, end: 18},
                        {name: "å·²ç”¨å¤©æ•°", start: 19, end: 20},
                        {name: "çº¯æ°´TDS", start: 21, end: 22},
                        {name: "åŸæ°´TDS", start: 23, end: 24},
                        {name: "1çº§", start: 25, end: 26},
                        {name: "2çº§", start: 27, end: 28},
                        {name: "3çº§", start: 29, end: 30},
                        {name: "4çº§", start: 31, end: 32},
                        {name: "5çº§", start: 33, end: 34},
                        {name: "å¤§1", start: 35, end: 36},
                        {name: "å¤§2", start: 37, end: 38},
                        {name: "å¤§3", start: 39, end: 40},
                        {name: "å¤§4", start: 41, end: 42},
                        {name: "å¤§5", start: 43, end: 44},
                        {name: "åŒ—äº¬æ—¶é—´", start: 45, end: 48},
                        {name: "æœºå™¨ç±»å‹", start: 49, end: 49},
                        {name: "æ ¡éªŒç ", start: 50, end: 51}
                    ]
                },
                type2: {
                    name: "æ•°æ®ç±»å‹2 (52å­—èŠ‚)",
                    fields: [
                        {name: "è®¾å¤‡ID", start: 0, end: 3},
                        {name: "è®¡è´¹æ¨¡å¼", start: 4, end: 4},
                        {name: "å‘½ä»¤", start: 5, end: 5},
                        {name: "è®¾å¤‡çŠ¶æ€", start: 6, end: 6},
                        {name: "æœ¬æ¬¡æ¶ˆè´¹", start: 7, end: 8},
                        {name: "å……å€¼æµé‡", start: 9, end: 10},
                        {name: "å……å€¼å¤©æ•°", start: 11, end: 12},
                        {name: "å‰©ä½™æµé‡", start: 13, end: 14},
                        {name: "å‰©ä½™å¤©æ•°", start: 15, end: 16},
                        {name: "å·²ç”¨æµé‡", start: 17, end: 18},
                        {name: "å·²ç”¨å¤©æ•°", start: 19, end: 20},
                        {name: "çº¯æ°´TDS", start: 21, end: 22},
                        {name: "åŸæ°´TDS", start: 23, end: 24},
                        {name: "1çº§", start: 25, end: 26},
                        {name: "2çº§", start: 27, end: 28},
                        {name: "3çº§", start: 29, end: 30},
                        {name: "4çº§", start: 31, end: 32},
                        {name: "5çº§", start: 33, end: 34},
                        {name: "å¤§1", start: 35, end: 36},
                        {name: "å¤§2", start: 37, end: 38},
                        {name: "å¤§3", start: 39, end: 40},
                        {name: "å¤§4", start: 41, end: 42},
                        {name: "å¤§5", start: 43, end: 44},
                        {name: "åŒ—äº¬æ—¶é—´", start: 45, end: 48},
                        {name: "æœºå™¨ç±»å‹", start: 49, end: 49},
                        {name: "æ ¡éªŒç ", start: 50, end: 51}
                    ]
                },
                type3: {
                    name: "æ•°æ®ç±»å‹3 (52å­—èŠ‚)",
                    fields: [
                        {name: "è®¾å¤‡ID", start: 0, end: 3},
                        {name: "è®¡è´¹æ¨¡å¼", start: 4, end: 4},
                        {name: "å‘½ä»¤", start: 5, end: 5},
                        {name: "è®¾å¤‡çŠ¶æ€", start: 6, end: 6},
                        {name: "æœ¬æ¬¡æ¶ˆè´¹", start: 7, end: 8},
                        {name: "å……å€¼æµé‡", start: 9, end: 12},
                        {name: "å……å€¼å¤©æ•°", start: 13, end: 14},
                        {name: "å‰©ä½™æµé‡", start: 15, end: 18},
                        {name: "å‰©ä½™å¤©æ•°", start: 19, end: 20},
                        {name: "å·²ç”¨æµé‡", start: 21, end: 24},
                        {name: "å·²ç”¨å¤©æ•°", start: 25, end: 26},
                        {name: "çº¯æ°´TDS", start: 27, end: 28},
                        {name: "åŸæ°´TDS", start: 29, end: 30},
                        {name: "1çº§", start: 31, end: 32},
                        {name: "2çº§", start: 33, end: 34},
                        {name: "3çº§", start: 35, end: 36},
                        {name: "4çº§", start: 37, end: 38},
                        {name: "5çº§", start: 39, end: 40},
                        {name: "å¤§1", start: 41, end: 42},
                        {name: "å¤§2", start: 43, end: 44},
                        {name: "å¤§3", start: 45, end: 46},
                        {name: "å¤§4", start: 47, end: 48},
                        {name: "å¤§5", start: 49, end: 50},
                        {name: "åŒ—äº¬æ—¶é—´", start: 51, end: 54},
                        {name: "æœºå™¨ç±»å‹", start: 55, end: 55},
                        {name: "æ ¡éªŒç ", start: 56, end: 57}
                    ]
                },
                type4: {
                    name: "æ•°æ®ç±»å‹4 (58å­—èŠ‚)",
                    fields: [
                        {name: "è®¾å¤‡ID", start: 0, end: 3},
                        {name: "è®¡è´¹æ¨¡å¼", start: 4, end: 4},
                        {name: "å‘½ä»¤", start: 5, end: 5},
                        {name: "è®¾å¤‡çŠ¶æ€", start: 6, end: 6},
                        {name: "æœ¬æ¬¡æ¶ˆè´¹", start: 7, end: 8},
                        {name: "å……å€¼æµé‡", start: 9, end: 12},
                        {name: "å……å€¼å¤©æ•°", start: 13, end: 14},
                        {name: "å‰©ä½™æµé‡", start: 15, end: 18},
                        {name: "å‰©ä½™å¤©æ•°", start: 19, end: 20},
                        {name: "å·²ç”¨æµé‡", start: 21, end: 24},
                        {name: "å·²ç”¨å¤©æ•°", start: 25, end: 26},
                        {name: "çº¯æ°´TDS", start: 27, end: 28},
                        {name: "åŸæ°´TDS", start: 29, end: 30},
                        {name: "1çº§", start: 31, end: 32},
                        {name: "2çº§", start: 33, end: 34},
                        {name: "3çº§", start: 35, end: 36},
                        {name: "4çº§", start: 37, end: 38},
                        {name: "5çº§", start: 39, end: 40},
                        {name: "å¤§1", start: 41, end: 42},
                        {name: "å¤§2", start: 43, end: 44},
                        {name: "å¤§3", start: 45, end: 46},
                        {name: "å¤§4", start: 47, end: 48},
                        {name: "å¤§5", start: 49, end: 50},
                        {name: "åŒ—äº¬æ—¶é—´", start: 51, end: 54},
                        {name: "æœºå™¨ç±»å‹", start: 55, end: 55},
                        {name: "æ ¡éªŒç ", start: 56, end: 57}
                    ]
                }
            };

            // æ¸…ç†åå…­è¿›åˆ¶æ•°æ®
            function cleanHexData(data) {
                return data.replace(/[\s\-\r\n]/g, '').toUpperCase();
            }

            // åå…­è¿›åˆ¶è½¬åè¿›åˆ¶
            function hexToDec(hex) {
                return parseInt(hex, 16);
            }

            // æå–å­—èŠ‚èŒƒå›´
            function extractBytes(data, start, end) {
                const startPos = start * 2;
                const endPos = (end + 1) * 2;
                const hex = data.substring(startPos, endPos);
                // ç›´æ¥è¿”å›ï¼Œä¸æ·»åŠ ç©ºæ ¼
                return hex;
            }

            // åˆ¤æ–­æ•°æ®ç±»å‹
            function detectDataType(cleanData) {
                const byteLength = cleanData.length / 2;
                
                if (byteLength === 52) {
                    // æ ¹æ®æ•°æ®ç‰¹å¾è¿›ä¸€æ­¥åˆ¤æ–­æ˜¯type1ã€type2è¿˜æ˜¯type3
                    return 'type1'; // é»˜è®¤è¿”å›type1ï¼Œå®é™…åº”ç”¨ä¸­å¯ä»¥æ ¹æ®æ›´å¤šç‰¹å¾åˆ¤æ–­
                } else if (byteLength === 58) {
                    return 'type4';
                }
                
                return 'type1'; // é»˜è®¤ç±»å‹
            }

            // è§£æå•è¡Œæ•°æ®
            function parseData(rawData) {
                const cleanData = cleanHexData(rawData);
                const dataType = detectDataType(cleanData);
                const typeConfig = dataTypes[dataType];
                
                if (!typeConfig) {
                    throw new Error('æœªçŸ¥çš„æ•°æ®ç±»å‹');
                }

                const result = {
                    type: typeConfig.name,
                    originalData: rawData,
                    cleanData: cleanData,
                    fields: []
                };

                typeConfig.fields.forEach(field => {
                    const hexValue = extractBytes(cleanData, field.start, field.end);
                    const decValue = hexToDec(hexValue);
                    
                    // ç®€åŒ–å­—èŠ‚èŒƒå›´æ˜¾ç¤º
                    let rangeText;
                    if (field.start === field.end) {
                        rangeText = `${field.start + 1}`;
                    } else {
                        rangeText = `${field.start + 1}~${field.end + 1}`;
                    }
                    
                    result.fields.push({
                        name: field.name,
                        hexValue: hexValue,
                        decValue: decValue,
                        range: rangeText
                    });
                });

                // æ·»åŠ æ ¡éªŒç éªŒè¯
                try {
                    // è®¡ç®—æ ¡éªŒå’Œï¼šé™¤å»æœ€å4ä¸ªæ•°å­—(2ä¸ªå­—èŠ‚)å¤–ï¼Œå…¶ä½™æ‰€æœ‰æ•°å­—ï¼Œæ¯2ä¸ªæ•°å­—ç›¸åŠ ç»„æˆçš„å’Œ
                    const dataWithoutChecksum = cleanData.substring(0, cleanData.length - 4);
                    let checksum = 0;
                    
                    // æ¯2ä¸ªå­—ç¬¦ï¼ˆ1ä¸ªå­—èŠ‚ï¼‰ç›¸åŠ 
                    for (let i = 0; i < dataWithoutChecksum.length; i += 2) {
                        if (i + 1 < dataWithoutChecksum.length) {
                            const byte = dataWithoutChecksum.substring(i, i + 2);
                            checksum += parseInt(byte, 16);
                        }
                    }
                    
                    // å–åä¸¤ä½å­—èŠ‚ï¼ˆæ ¡éªŒç ï¼‰
                    const actualChecksumHex = cleanData.substring(cleanData.length - 4);
                    const actualChecksum = parseInt(actualChecksumHex, 16);
                    
                    // å–æ ¡éªŒå’Œçš„ä½16ä½ï¼ˆå› ä¸ºæ ¡éªŒç æ˜¯2å­—èŠ‚ï¼‰
                    const calculatedChecksum = checksum & 0xFFFF;
                    
                    // éªŒè¯ç»“æœ
                    const isValid = calculatedChecksum === actualChecksum;
                    
                    // æ·»åŠ æ ¡éªŒä¿¡æ¯åˆ°ç»“æœ
                    result.checksum = {
                        calculated: calculatedChecksum,
                        actual: actualChecksum,
                        isValid: isValid
                    };
                } catch (e) {
                    // å¦‚æœè®¡ç®—å‡ºé”™ï¼Œæ·»åŠ é”™è¯¯ä¿¡æ¯
                    result.checksum = {
                        error: e.message
                    };
                }
                
                return result;
            }

            // åˆ†ææ•°æ®
            function analyzeData() {
                const rawInput = document.getElementById('logInput').value.trim();
                const resultSection = document.querySelector('.result-content');
                const statusSection = document.getElementById('statusSection');
                
                if (!rawInput) {
                    statusSection.className = 'status-section error';
                    statusSection.textContent = 'âŒ è¯·è¾“å…¥åŸå§‹æ•°æ®';
                    return;
                }

                const lines = rawInput.split('\n').filter(line => line.trim());
                
                // æ¸…ç©ºç°æœ‰ç»“æœ
                resultSection.innerHTML = '';
                
                if (lines.length === 0) {
                    statusSection.className = 'status-section error';
                    statusSection.textContent = 'âŒ æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„æ•°æ®è¡Œ';
                    return;
                }

                let successCount = 0;
                let errorCount = 0;
                
                // ä¸ºæ¯æ¡æ•°æ®åˆ›å»ºç‹¬ç«‹çš„è§£æç»“æœå—
                lines.forEach((line, index) => {
                    try {
                        const parsedData = parseData(line.trim());
                        createResultBlock(parsedData, index);
                        successCount++;
                    } catch (error) {
                        // åˆ›å»ºé”™è¯¯ç»“æœå—
                        const errorBlock = document.createElement('div');
                        errorBlock.className = 'result-item error';
                        errorBlock.innerHTML = `
                            <div class="result-header">
                                ğŸ“Š è§£æç»“æœ (ç¬¬${index + 1}æ¡) - è§£æå¤±è´¥
                            </div>
                            <div class="status-section error">
                                âŒ è§£æå¤±è´¥: ${error.message}
                            </div>
                            <div class="error-raw-data">
                                <strong>åŸå§‹æ—¥å¿—:</strong> ${line}
                            </div>
                        `;
                        resultSection.appendChild(errorBlock);
                        errorCount++;
                    }
                });
                
                // æ›´æ–°çŠ¶æ€åŒºåŸŸæ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
                statusSection.className = 'status-section info';
                statusSection.innerHTML = `
                    ğŸ“Š è§£æå®Œæˆï¼æˆåŠŸè§£æ ${successCount} æ¡æ•°æ®ï¼Œå¤±è´¥ ${errorCount} æ¡æ•°æ®ã€‚
                `;
            }

            // åˆ›å»ºç»“æœå—
            function createResultBlock(parsedData, index) {
                const resultSection = document.querySelector('.result-content');
                
                // åˆ›å»ºç»“æœå®¹å™¨
                const resultBlock = document.createElement('div');
                resultBlock.className = 'result-item';
                resultBlock.style.marginBottom = '20px';
                resultBlock.style.border = '1px solid #e1e5e9';
                resultBlock.style.borderRadius = '10px';
                resultBlock.style.overflow = 'hidden';
                
                // åˆ›å»ºæ ‡é¢˜æ 
                const header = document.createElement('div');
                header.className = 'result-header';
                header.innerHTML = `
                    ğŸ“Š è§£æç»“æœ (ç¬¬${index + 1}æ¡) - ${parsedData.type}
                `;
                resultBlock.appendChild(header);
                
                // åˆ›å»ºåŸå§‹æ—¥å¿—æ˜¾ç¤ºåŒºåŸŸ
                const rawDataDiv = document.createElement('div');
                rawDataDiv.style.padding = '10px';
                rawDataDiv.style.backgroundColor = '#f8f9fa';
                rawDataDiv.style.borderBottom = '1px solid #e1e5e9';
                rawDataDiv.innerHTML = `<strong>åŸå§‹æ—¥å¿—:</strong> ${parsedData.originalData}`;
                resultBlock.appendChild(rawDataDiv);
                
                // åˆ›å»ºè¡¨æ ¼å®¹å™¨
                const tableContainer = document.createElement('div');
                tableContainer.style.overflowX = 'auto';
                tableContainer.style.width = '100%';
                
                // åˆ›å»ºè¡¨æ ¼
                const table = document.createElement('table');
                table.className = 'data-table';
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th class="row-label">æ•°æ®ç±»å‹</th>
                        </tr>
                        <tr>
                            <th class="row-label">èŒƒå›´</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="row-label"><strong>æ•°å€¼</strong></td>
                        </tr>
                    </tbody>
                `;
                
                // æ›´æ–°è¡¨æ ¼å†…å®¹
                const thead = table.querySelector('thead');
                const tbody = table.querySelector('tbody');
                const titleRow = thead.children[0];
                const rangeRow = thead.children[1];
                const valueRow = tbody.children[0];
                
                parsedData.fields.forEach(field => {
                    // æ·»åŠ å­—æ®µæ ‡é¢˜
                    const th = document.createElement('th');
                    th.title = field.name;
                    th.textContent = field.name;
                    titleRow.appendChild(th);
                    
                    // æ·»åŠ å­—èŠ‚èŒƒå›´
                    const rangeTh = document.createElement('th');
                    rangeTh.className = 'range-cell';
                    rangeTh.textContent = field.range;
                    rangeRow.appendChild(rangeTh);
                    
                    // æ·»åŠ æ•°å€¼
                    const td = document.createElement('td');
                    td.className = 'data-cell';
                    td.title = `åè¿›åˆ¶: ${field.decValue}, åå…­è¿›åˆ¶: ${field.hexValue}`;
                    // ä¼˜åŒ–16è¿›åˆ¶æ•°å€¼æ˜¾ç¤ºï¼šæœ€å°‘ä¿ç•™2ä½æ•°ï¼Œ00æ˜¾ç¤ºä¸º00
                    let formattedHex;
                    if (field.hexValue === '00') {
                        formattedHex = '00'; // å½“æ˜¯00æ—¶ï¼Œä¿æŒæ˜¾ç¤º00
                    } else {
                        // å»é™¤å‰å¯¼é›¶
                        const trimmed = field.hexValue.replace(/^0+/, '') || '0';
                        // ç¡®ä¿æœ€å°‘ä¿ç•™2ä½æ•°
                        formattedHex = trimmed.padStart(2, '0');
                    }
                    td.innerHTML = `<span class="dec-value">${field.decValue}</span><br><span class="hex-value">ã€Œ${formattedHex}ã€</span>`;
                    valueRow.appendChild(td);
                });
                
                // æ·»åŠ æ ¡éªŒç éªŒè¯ç»“æœåˆ—
                if (parsedData.checksum && !parsedData.checksum.error) {
                    // æ·»åŠ æ ¡éªŒç»“æœæ ‡é¢˜
                    const checksumTitleTh = document.createElement('th');
                    checksumTitleTh.title = 'æ ¡éªŒç éªŒè¯';
                    checksumTitleTh.textContent = 'æ ¡éªŒéªŒè¯';
                    titleRow.appendChild(checksumTitleTh);
                    
                    // æ·»åŠ ç©ºçš„èŒƒå›´å•å…ƒæ ¼
                    const checksumRangeTh = document.createElement('th');
                    checksumRangeTh.className = 'range-cell';
                    checksumRangeTh.textContent = '-';
                    rangeRow.appendChild(checksumRangeTh);
                    
                    // æ·»åŠ æ ¡éªŒç»“æœ
                    const checksumTd = document.createElement('td');
                    checksumTd.className = 'data-cell';
                    checksumTd.style.fontWeight = 'bold';
                    checksumTd.style.color = parsedData.checksum.isValid ? '#28a745' : '#dc3545';
                    
                    // æ ¼å¼åŒ–è®¡ç®—å‡ºçš„æ ¡éªŒå’Œä¸º16è¿›åˆ¶ï¼Œç¡®ä¿4ä½
                    const calculatedHex = parsedData.checksum.calculated.toString(16).toUpperCase().padStart(4, '0');
                    checksumTd.innerHTML = `${calculatedHex}ã€Œ${parsedData.checksum.isValid ? 'âœ…' : 'âŒ'}ã€`;
                    valueRow.appendChild(checksumTd);
                }
                
                tableContainer.appendChild(table);
                resultBlock.appendChild(tableContainer);
                
                // æ·»åŠ åˆ°ç»“æœåŒºåŸŸ
                resultSection.appendChild(resultBlock);
            }

            // æ¸…ç©ºæ•°æ®
            function clearLogData() {
                document.getElementById('logInput').value = '';
                document.getElementById('statusSection').innerHTML = '';
                document.querySelector('.result-content').innerHTML = '';
            }

            // ç»‘å®šäº‹ä»¶
            document.getElementById('analyzeBtn').addEventListener('click', analyzeData);
            document.getElementById('clearLogBtn').addEventListener('click', clearLogData);

            // å›è½¦é”®å¿«æ·åˆ†æ
            document.getElementById('logInput').addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    analyzeData();
                }
            });
            
            // æ—¥å¿—è§£æç•Œé¢åŠŸèƒ½
            function analyzeLog() {
                const logInput = document.getElementById('logInput').value.trim();
                const logResult = document.getElementById('logResult');
                
                if (!logInput) {
                    logResult.textContent = 'è¯·è¾“å…¥æ—¥å¿—æ•°æ®';
                    return;
                }
                
                try {
                    console.log('å¼€å§‹è§£ææ—¥å¿—:', logInput); // è°ƒè¯•ä¿¡æ¯
                    
                    const result = analysis(logInput);
                    
                    if (result && result.error) {
                        logResult.textContent = 'è§£æå¤±è´¥ï¼š' + result.error;
                        return;
                    }
                    
                    if (result) {
                        let output = 'ğŸ“Š æ—¥å¿—è§£æç»“æœï¼š\n';
                        output += 'â•'.repeat(50) + '\n\n';
                        
                        // æ ¼å¼åŒ–è¾“å‡ºç»“æœ
                        for (const [key, value] of Object.entries(result)) {
                            if (value && value.toString().trim()) {
                                output += `${value}\n`;
                            }
                        }
                        
                        output += '\n' + 'â•'.repeat(50);
                        output += '\nè§£æå®Œæˆ âœ“';
                        
                        logResult.textContent = output;
                        console.log('è§£ææˆåŠŸ:', result); // è°ƒè¯•ä¿¡æ¯
                    } else {
                        logResult.textContent = 'è§£æå¤±è´¥ï¼šæ— æ³•è¯†åˆ«çš„æ•°æ®æ ¼å¼';
                    }
                } catch (error) {
                    logResult.textContent = 'è§£æå‡ºé”™ï¼š' + error.message;
                    console.error('æ—¥å¿—è§£æé”™è¯¯:', error);
                }
            }
            
            function clearLogData() {
                document.getElementById('logInput').value = '';
                document.getElementById('logResult').textContent = 'ç­‰å¾…è¾“å…¥æ—¥å¿—æ•°æ®...';
            }
            
            // å¤„ç†å›è½¦é”®è‡ªåŠ¨è§£æ
            function handleLogInputKeydown(event) {
                // æ£€æµ‹å›è½¦é”®ï¼ˆEnteré”®ï¼ŒkeyCodeä¸º13ï¼‰
                if (event.key === 'Enter' || event.keyCode === 13) {
                    // é˜»æ­¢é»˜è®¤çš„æ¢è¡Œè¡Œä¸º
                    event.preventDefault();
                    
                    // è·å–è¾“å…¥æ¡†çš„å€¼
                    const logInput = document.getElementById('logInput').value.trim();
                    
                    // å¦‚æœæœ‰å†…å®¹åˆ™è‡ªåŠ¨å¼€å§‹è§£æ
                    if (logInput) {
                        console.log('ğŸ” æ£€æµ‹åˆ°å›è½¦é”®ï¼Œè‡ªåŠ¨å¼€å§‹è§£ææ—¥å¿—');
                        analyzeLog();
                    } else {
                        console.log('âš ï¸ è¾“å…¥æ¡†ä¸ºç©ºï¼Œæ— æ³•è§£æ');
                    }
                }
            }
            class QRGenerator {
                constructor() {
                    this.generatedBlobs = []; // å­˜å‚¨ç”Ÿæˆçš„blobå¯¹è±¡
                    this.initEventListeners();
                }

                initEventListeners() {
                    document.getElementById('qrGenerateBtn').addEventListener('click', () => this.generateQRCodes());
                    document.getElementById('qrDownloadBtn').addEventListener('click', () => this.downloadZip());
                }

                showError(message) {
                    const errorDiv = document.getElementById('qrErrorMessage');
                    errorDiv.textContent = message;
                    errorDiv.style.display = 'block';
                    setTimeout(() => {
                        errorDiv.style.display = 'none';
                    }, 5000);
                }

                showSuccess(message) {
                    const successDiv = document.getElementById('qrSuccessMessage');
                    successDiv.textContent = message;
                    successDiv.style.display = 'block';
                    setTimeout(() => {
                        successDiv.style.display = 'none';
                    }, 3000);
                }

                updateProgress(current, total, text) {
                    const progressContainer = document.getElementById('qrProgressContainer');
                    const progressFill = document.getElementById('qrProgressFill');
                    const progressText = document.getElementById('qrProgressText');
                    
                    progressContainer.style.display = 'block';
                    const percentage = (current / total) * 100;
                    progressFill.style.width = percentage + '%';
                    progressText.textContent = text || `æ­£åœ¨ç”Ÿæˆ ${current}/${total} (${Math.round(percentage)}%)`;
                }

                hideProgress() {
                    document.getElementById('qrProgressContainer').style.display = 'none';
                }

                updateApiStatus(message, show = true) {
                    const apiStatus = document.getElementById('qrApiStatus');
                    const apiStatusText = document.getElementById('qrApiStatusText');
                    
                    if (show) {
                        apiStatus.style.display = 'block';
                        apiStatusText.textContent = message;
                    } else {
                        apiStatus.style.display = 'none';
                    }
                }

                setGenerateButtonState(loading) {
                    const btn = document.getElementById('qrGenerateBtn');
                    const btnText = document.getElementById('qrGenerateBtnText');
                    const btnLoading = document.getElementById('qrGenerateBtnLoading');
                    
                    btn.disabled = loading;
                    btnText.style.display = loading ? 'none' : 'inline';
                    btnLoading.style.display = loading ? 'inline-block' : 'none';
                }

                // ç”Ÿæˆå¸¦è‡ªé€‚åº”IMEIæ–‡å­—çš„äºŒç»´ç ï¼ˆå¸¦é‡è¯•æœºåˆ¶ï¼‰
                async generateQRCode(text, imei, retryCount = 0) {
                    const encodedText = encodeURIComponent(text);
                    const maxRetries = 2;
                    
                    // å¤šä¸ªå¤‡é€‰APIï¼Œæé«˜æˆåŠŸç‡
                    const apis = [
                        `https://api.qrserver.com/v1/create-qr-code/?size=280x280&format=png&data=${encodedText}`,
                        `https://chart.googleapis.com/chart?chs=280x280&cht=qr&chl=${encodedText}`,
                        `https://quickchart.io/qr?text=${encodedText}&size=280`
                    ];
                    
                    const currentApi = apis[retryCount % apis.length];
                    console.log(`ğŸ”„ ${imei} å°è¯•API ${retryCount + 1}/${maxRetries + 1}:`, currentApi);
                    
                    try {
                        // åˆ›å»ºå¸¦è‡ªé€‚åº”IMEIæ–‡å­—çš„äºŒç»´ç å›¾ç‰‡
                        return await this.addTextToQRCode(currentApi, imei);
                    } catch (error) {
                        console.log(`âŒ ${imei} APIå¤±è´¥ (${retryCount + 1}/${maxRetries + 1}):`, error.message);
                        
                        if (retryCount < maxRetries) {
                            console.log(`ğŸ”„ ${imei} é‡è¯•ä¸­...`);
                            await new Promise(resolve => setTimeout(resolve, 200)); // çŸ­æš‚å»¶è¿Ÿ
                            return await this.generateQRCode(text, imei, retryCount + 1);
                        } else {
                            throw new Error(`æ‰€æœ‰APIéƒ½å¤±è´¥: ${error.message}`);
                        }
                    }
                }

                // åœ¨äºŒç»´ç å›¾ç‰‡ä¸Šæ·»åŠ è‡ªé€‚åº”IMEIæ–‡å­—
                async addTextToQRCode(qrUrl, imei) {
                    console.log(`ğŸ–¼ï¸ å¼€å§‹å¤„ç†: ${imei}`);
                    
                    // å°è¯•å¤šç§æ–¹æ³•è·å–å›¾ç‰‡
                    const methods = [
                        // æ–¹æ³•1: ä½¿ç”¨ä»£ç†æœåŠ¡å™¨
                        async () => {
                            const response = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(qrUrl)}`);
                            if (!response.ok) throw new Error(`ä»£ç†æœåŠ¡å™¨é”™è¯¯: ${response.status}`);
                            return await response.blob();
                        },
                        // æ–¹æ³•2: ä½¿ç”¨å¦ä¸€ä¸ªä»£ç†
                        async () => {
                            const response = await fetch(`https://corsproxy.io/?${encodeURIComponent(qrUrl)}`);
                            if (!response.ok) throw new Error(`ä»£ç†æœåŠ¡å™¨é”™è¯¯: ${response.status}`);
                            return await response.blob();
                        },
                        // æ–¹æ³•3: ç›´æ¥å°è¯•ï¼ˆå¯èƒ½ä¼šæœ‰è·¨åŸŸé—®é¢˜ï¼Œä½†æœ‰äº›æµè§ˆå™¨å…è®¸ï¼‰
                        async () => {
                            const response = await fetch(qrUrl);
                            if (!response.ok) throw new Error(`ç›´æ¥è¯·æ±‚é”™è¯¯: ${response.status}`);
                            return await response.blob();
                        }
                    ];
                    
                    let imageBlob = null;
                    let lastError = null;
                    
                    // å°è¯•æ¯ç§æ–¹æ³•
                    for (let i = 0; i < methods.length; i++) {
                        try {
                            console.log(`ğŸ”„ ${imei} å°è¯•æ–¹æ³• ${i + 1}/${methods.length}`);
                            imageBlob = await methods[i]();
                            console.log(`âœ… ${imei} æ–¹æ³• ${i + 1} æˆåŠŸè·å–å›¾ç‰‡`);
                            break;
                        } catch (error) {
                            console.log(`âŒ ${imei} æ–¹æ³• ${i + 1} å¤±è´¥:`, error.message);
                            lastError = error;
                            continue;
                        }
                    }
                    
                    if (!imageBlob) {
                        throw new Error(`æ‰€æœ‰è·å–å›¾ç‰‡çš„æ–¹æ³•éƒ½å¤±è´¥: ${lastError?.message}`);
                    }
                    
                    const imageUrl = URL.createObjectURL(imageBlob);
                    
                    return new Promise((resolve, reject) => {
                        const img = new Image();
                        
                        const timeout = setTimeout(() => {
                            console.log(`â° ${imei} å¤„ç†è¶…æ—¶`);
                            URL.revokeObjectURL(imageUrl);
                            reject(new Error('å¤„ç†è¶…æ—¶'));
                        }, 10000);
                        
                        img.onload = () => {
                            clearTimeout(timeout);
                            console.log(`âœ… ${imei} å›¾ç‰‡åŠ è½½æˆåŠŸ`);
                            
                            try {
                                // åˆ›å»ºcanvas
                                const canvas = document.createElement('canvas');
                                const ctx = canvas.getContext('2d');
                                
                                if (!ctx) {
                                    throw new Error('æ— æ³•åˆ›å»ºCanvasä¸Šä¸‹æ–‡');
                                }
                                
                                // è®¾ç½®ç”»å¸ƒå°ºå¯¸ä¸ºæ­£æ–¹å½¢
                                const qrSize = 280;
                                const textHeight = 80;
                                const totalSize = qrSize + textHeight;
                                
                                canvas.width = totalSize;
                                canvas.height = totalSize;
                                
                                // å¡«å……ç™½è‰²èƒŒæ™¯
                                ctx.fillStyle = '#ffffff';
                                ctx.fillRect(0, 0, totalSize, totalSize);
                                
                                // ç»˜åˆ¶äºŒç»´ç ï¼ˆå±…ä¸­ä¸Šæ–¹ï¼‰
                                const qrX = (totalSize - qrSize) / 2;
                                const qrY = 10;
                                ctx.drawImage(img, qrX, qrY, qrSize, qrSize);
                                
                                // è‡ªé€‚åº”æ–‡å­—å¤§å°åˆ°äºŒç»´ç å®½åº¦
                                const maxWidth = qrSize - 20;
                                let fontSize = 50;
                                const minFontSize = 24;
                                
                                // è®¾ç½®æ–‡å­—æ ·å¼
                                ctx.fillStyle = '#333333';
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'middle';
                                
                                // åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
                                do {
                                    ctx.font = `bold ${fontSize}px Arial, sans-serif`;
                                    const textWidth = ctx.measureText(imei).width;
                                    
                                    if (textWidth <= maxWidth || fontSize <= minFontSize) {
                                        break;
                                    }
                                    fontSize -= 1;
                                } while (fontSize > minFontSize);
                                
                                fontSize = Math.max(fontSize, minFontSize);
                                ctx.font = `bold ${fontSize}px Arial, sans-serif`;
                                
                                // ç»˜åˆ¶IMEIæ–‡å­—
                                const textY = qrY + qrSize + textHeight / 2;
                                ctx.fillText(imei, totalSize / 2, textY);
                                
                                console.log(`ğŸ“ ${imei} å­—ä½“: ${fontSize}px`);
                                
                                // è½¬æ¢ä¸ºblob
                                canvas.toBlob((resultBlob) => {
                                    if (resultBlob) {
                                        const url = URL.createObjectURL(resultBlob);
                                        this.generatedBlobs.push({ blob: resultBlob, filename: `${imei}.png` });
                                        console.log(`ğŸ‰ ${imei} å¤„ç†å®Œæˆ`);
                                        
                                        // æ¸…ç†ä¸´æ—¶URL
                                        URL.revokeObjectURL(imageUrl);
                                        resolve(url);
                                    } else {
                                        URL.revokeObjectURL(imageUrl);
                                        reject(new Error('Canvasè½¬æ¢å¤±è´¥'));
                                    }
                                }, 'image/png');
                                
                            } catch (error) {
                                console.error(`âŒ ${imei} Canvaså¤„ç†å¤±è´¥:`, error);
                                URL.revokeObjectURL(imageUrl);
                                reject(error);
                            }
                        };
                        
                        img.onerror = (error) => {
                            clearTimeout(timeout);
                            console.error(`âŒ ${imei} å›¾ç‰‡åŠ è½½å¤±è´¥:`, error);
                            URL.revokeObjectURL(imageUrl);
                            reject(new Error('å›¾ç‰‡åŠ è½½å¤±è´¥'));
                        };
                        
                        img.src = imageUrl;
                    });
                }

                async generateQRCodes() {
                    const prefix = document.getElementById('qrPrefix').value.trim();
                    const imeiText = document.getElementById('qrImeiList').value.trim();
                    
                    if (!prefix) {
                        this.showError('è¯·è¾“å…¥äºŒç»´ç å‰ç¼€');
                        return;
                    }
                    
                    if (!imeiText) {
                        this.showError('è¯·è¾“å…¥IMEIåˆ—è¡¨');
                        return;
                    }

                    const imeiList = imeiText.split('\n').filter(imei => imei.trim()).map(imei => imei.trim());
                    
                    if (imeiList.length === 0) {
                        this.showError('è¯·è¾“å…¥æœ‰æ•ˆçš„IMEIåˆ—è¡¨');
                        return;
                    }

                    this.setGenerateButtonState(true);
                    this.generatedBlobs = [];
                    document.getElementById('qrGrid').innerHTML = '';
                    document.getElementById('qrDownloadBtn').disabled = true;
                    this.updateApiStatus('ä½¿ç”¨QR-Server.com APIç”ŸæˆäºŒç»´ç ...');

                    let successCount = 0;
                    let failCount = 0;

                    for (let i = 0; i < imeiList.length; i++) {
                        const imei = imeiList[i];
                        const qrText = prefix + imei;
                        
                        this.updateProgress(i + 1, imeiList.length, `æ­£åœ¨ç”Ÿæˆ ${i + 1}/${imeiList.length}: ${imei}`);
                        
                        try {
                            const qrUrl = await this.generateQRCode(qrText, imei);
                            await this.displayQRCode(qrUrl, imei, qrText);
                            successCount++;
                            
                            // å‡å°‘å»¶è¿Ÿæ—¶é—´ï¼Œæé«˜ç”Ÿæˆé€Ÿåº¦
                            if (i < imeiList.length - 1) {
                                await new Promise(resolve => setTimeout(resolve, 100));
                            }
                        } catch (error) {
                            console.error(`ç”Ÿæˆ ${imei} çš„äºŒç»´ç å¤±è´¥:`, error);
                            failCount++;
                            this.displayErrorQR(imei, error.message);
                        }
                    }

                    this.hideProgress();
                    this.setGenerateButtonState(false);
                    
                    if (successCount > 0) {
                        document.getElementById('qrDownloadBtn').disabled = false;
                        this.updateApiStatus(`âœ… æˆåŠŸç”Ÿæˆ ${successCount} ä¸ªäºŒç»´ç ${failCount > 0 ? `ï¼Œå¤±è´¥ ${failCount} ä¸ª` : ''}`);
                        this.showSuccess(`æˆåŠŸç”Ÿæˆ ${successCount} ä¸ªäºŒç»´ç ${failCount > 0 ? `ï¼Œå¤±è´¥ ${failCount} ä¸ª` : ''}`);
                    } else {
                        this.updateApiStatus('âŒ æ‰€æœ‰äºŒç»´ç ç”Ÿæˆå¤±è´¥');
                        this.showError('æ‰€æœ‰äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•');
                    }
                }

                async displayQRCode(qrUrl, imei, qrText) {
                    return new Promise((resolve, reject) => {
                        const qrItem = document.createElement('div');
                        qrItem.className = 'qr-item';
                        
                        // åˆ›å»ºå›¾ç‰‡å…ƒç´ å¹¶ç­‰å¾…åŠ è½½
                        const img = new Image();
                        img.onload = () => {
                            qrItem.innerHTML = `
                                <img src="${qrUrl}" alt="QR Code for ${imei}">
                                <div class="qr-label">${imei}</div>
                                <div class="qr-label" style="font-size: 0.7em; color: #999; margin-top: 5px;">${qrText}</div>
                                <div class="qr-label" style="font-size: 0.6em; color: #4facfe; margin-top: 3px;">API: QR-Server.com</div>
                            `;
                            
                            document.getElementById('qrGrid').appendChild(qrItem);
                            resolve();
                        };
                        
                        img.onerror = () => {
                            reject(new Error('äºŒç»´ç å›¾ç‰‡åŠ è½½å¤±è´¥'));
                        };
                        
                        img.src = qrUrl;
                    });
                }

                displayErrorQR(imei, errorMsg) {
                    const qrItem = document.createElement('div');
                    qrItem.className = 'qr-item';
                    qrItem.style.background = '#ffe6e6';
                    qrItem.innerHTML = `
                        <div style="padding: 20px; color: #d63031;">
                            <div style="font-size: 2em; margin-bottom: 10px;">âŒ</div>
                            <div class="qr-label">${imei}</div>
                            <div style="font-size: 0.8em; margin-top: 5px;">${errorMsg}</div>
                        </div>
                    `;
                    
                    document.getElementById('qrGrid').appendChild(qrItem);
                }

                async downloadZip() {
                    if (this.generatedBlobs.length === 0) {
                        this.showError('æ²¡æœ‰å¯ä¸‹è½½çš„äºŒç»´ç ');
                        return;
                    }

                    const zip = new JSZip();
                    const downloadBtn = document.getElementById('qrDownloadBtn');
                    const originalText = downloadBtn.textContent;
                    
                    downloadBtn.disabled = true;
                    downloadBtn.innerHTML = '<span class="loading"></span> æ­£åœ¨æ‰“åŒ…...';

                    try {
                        // å¤„ç†ç”Ÿæˆçš„å›¾ç‰‡
                        for (let i = 0; i < this.generatedBlobs.length; i++) {
                            const item = this.generatedBlobs[i];
                            zip.file(item.filename, item.blob);
                            downloadBtn.textContent = `æ­£åœ¨æ‰“åŒ… ${i + 1}/${this.generatedBlobs.length}`;
                        }

                        downloadBtn.textContent = 'æ­£åœ¨ç”Ÿæˆå‹ç¼©åŒ…...';
                        const content = await zip.generateAsync({type: 'blob'});
                        
                        const link = document.createElement('a');
                        link.href = URL.createObjectURL(content);
                        link.download = `äºŒç»´ç _${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.zip`;
                        link.click();
                        
                        URL.revokeObjectURL(link.href);
                        this.showSuccess('äºŒç»´ç æ‰“åŒ…ä¸‹è½½æˆåŠŸï¼');
                        
                    } catch (error) {
                        console.error('æ‰“åŒ…ä¸‹è½½å¤±è´¥:', error);
                        this.showError('æ‰“åŒ…ä¸‹è½½å¤±è´¥: ' + error.message);
                    } finally {
                        downloadBtn.disabled = false;
                        downloadBtn.textContent = originalText;
                    }
                }
            }

            // åˆå§‹åŒ–äºŒç»´ç ç”Ÿæˆå™¨
            let qrGenerator = null;
            function initQRGenerator() {
                if (!qrGenerator) {
                    qrGenerator = new QRGenerator();
                }
            }

            // ç”Ÿæˆå½“æ—¥æ—¥æœŸ+001çš„é»˜è®¤å€¼
            function getDefaultSerialNumber() {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                return `${year}${month}${day}001`;
            }
            
            // åˆå§‹åŒ–ç”Ÿæˆæµæ°´å·å·¥å…·
            function initSerialNumberTool() {
                document.getElementById('startSerialNumber').value = getDefaultSerialNumber();
                document.getElementById('serialNumberCount').value = 10;// è®¾ç½®é»˜è®¤æ•°é‡ä¸º10
            }
            
            // å½“å‰æ¿€æ´»çš„å·¥å…·ID
            let currentActiveTool = null;
            let mobileMenuOpen = false;
            
            // åˆ‡æ¢ç§»åŠ¨ç«¯èœå•æ˜¾ç¤ºçŠ¶æ€
            function toggleMobileMenu() {
                const mobileMenu = document.getElementById('mobileMenu');
                const mobileMenuBtn = document.getElementById('mobileMenuBtn');
                
                if (mobileMenuOpen) {
                    mobileMenu.style.display = 'none';
                    mobileMenuBtn.textContent = 'â˜°';
                    mobileMenuBtn.style.borderRadius = '12px 12px 0 0'; // æ¢å¤åº•éƒ¨åœ†è§’
                } else {
                    mobileMenu.style.display = 'block';
                    mobileMenuBtn.textContent = 'âœ•';
                    mobileMenuBtn.style.borderRadius = '12px 12px 0 0'; // ç¡®ä¿åº•éƒ¨æ— åœ†è§’
                }
                
                mobileMenuOpen = !mobileMenuOpen;
            }
            
            // åœ¨æ˜¾ç¤ºå·¥å…·æ—¶åˆå§‹åŒ–
            function showTool(toolId) {
                // éšè—æ‰€æœ‰å·¥å…·
                document.querySelectorAll('.calculator').forEach(tool => {
                    tool.style.display = 'none';
                });
                
                // æ˜¾ç¤ºé€‰ä¸­çš„å·¥å…·
                const selectedTool = document.getElementById(toolId);
                if (selectedTool) {
                    selectedTool.style.display = 'block';
                    currentActiveTool = toolId; // è®°å½•å½“å‰æ¿€æ´»çš„å·¥å…·ID
                    
                    // å¦‚æœæ˜¯äºŒç»´ç ç”Ÿæˆå™¨ï¼Œåˆå§‹åŒ–å®ƒ
                    if (toolId === 'qrGeneratorTool') {
                        initQRGenerator();
                    }
                    
                    // å¦‚æœæ˜¯ç”Ÿæˆæµæ°´å·å·¥å…·ï¼Œåˆå§‹åŒ–å®ƒ
                    if (toolId === 'serialNumberTool') {
                        initSerialNumberTool();
                    }
                    
                    // å¦‚æœæ˜¯æ—¥å¿—åˆ†æå™¨ï¼Œå¯ä»¥åšä¸€äº›åˆå§‹åŒ–
                    if (toolId === 'logAnalysisTool') {
                        // è¿™é‡Œå¯ä»¥æ·»åŠ æ—¥å¿—åˆ†æå™¨çš„åˆå§‹åŒ–é€»è¾‘
                        console.log('æ—¥å¿—åˆ†æå™¨å·²æ¿€æ´»');
                    }
                }
                
                // æ›´æ–°æŒ‰é’®æ¿€æ´»çŠ¶æ€
                document.querySelectorAll('.tool-switcher button').forEach(btn => {
                    btn.classList.remove('active');
                });
                const activeBtn = document.querySelector(`.tool-switcher button[onclick="showTool('${toolId}')"]`);
                if (activeBtn) {
                    activeBtn.classList.add('active');
                }
                
                // åœ¨ç§»åŠ¨ç«¯è®¾å¤‡ä¸Šï¼Œåˆ‡æ¢å·¥å…·åå…³é—­èœå•
                if (window.innerWidth < 768 && mobileMenuOpen) {
                    toggleMobileMenu();
                }
            }
            
            // å“åº”çª—å£å¤§å°å˜åŒ–
            function handleResize() {
                const mobileMenuBtn = document.getElementById('mobileMenuBtn');
                const toolSwitcher = document.querySelector('.tool-switcher');
                const mobileMenu = document.getElementById('mobileMenu');
                
                // åœ¨å°å±å¹•è®¾å¤‡ä¸Šæ˜¾ç¤ºç§»åŠ¨ç«¯èœå•æŒ‰é’®ï¼Œéšè—æ¡Œé¢ç«¯å·¥å…·å¯¼èˆª
                if (window.innerWidth < 768) {
                    mobileMenuBtn.style.display = 'block';
                    toolSwitcher.style.display = 'none';
                    mobileMenu.style.display = mobileMenuOpen ? 'block' : 'none';
                } else {
                    // åœ¨å¤§å±å¹•è®¾å¤‡ä¸Šéšè—ç§»åŠ¨ç«¯èœå•æŒ‰é’®ï¼Œæ˜¾ç¤ºæ¡Œé¢ç«¯å·¥å…·å¯¼èˆª
                    mobileMenuBtn.style.display = 'none';
                    toolSwitcher.style.display = 'flex';
                    mobileMenu.style.display = 'none';
                    mobileMenuOpen = false;
                }
            }
            
            // ç»‘å®šçª—å£å¤§å°å˜åŒ–äº‹ä»¶
            window.addEventListener('resize', handleResize);
            
            // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
            document.addEventListener('DOMContentLoaded', function() {
                handleResize();
            });
            
            // æ˜¾ç¤ºæ¶ˆæ¯æç¤ºå‡½æ•°
            function showMessage(message, type = 'info') {
                // æŸ¥æ‰¾æˆ–åˆ›å»ºå½“å‰æ¿€æ´»å·¥å…·é¡µé¢ä¸­çš„æç¤ºå…ƒç´ 
                let messageElement;
                
                // å¦‚æœæœ‰å½“å‰æ¿€æ´»çš„å·¥å…·
                if (currentActiveTool) {
                    const activeToolElement = document.getElementById(currentActiveTool);
                    if (activeToolElement) {
                        // å…ˆåœ¨å½“å‰å·¥å…·é¡µé¢ä¸­æŸ¥æ‰¾ç°æœ‰çš„æç¤ºå…ƒç´ 
                        messageElement = activeToolElement.querySelector('.toolMessage');
                        
                        // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æç¤ºå…ƒç´ 
                        if (!messageElement) {
                            messageElement = document.createElement('div');
                            messageElement.className = 'toolMessage';
                            messageElement.style.padding = '10px';
                            messageElement.style.marginBottom = '10px';
                            messageElement.style.borderRadius = '5px';
                            messageElement.style.backgroundColor = '#f8f9fa';
                            messageElement.style.display = 'none';
                            
                            // å°†æ–°å…ƒç´ æ’å…¥åˆ°å·¥å…·é¡µé¢çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ä¹‹å‰
                            if (activeToolElement.firstChild) {
                                activeToolElement.insertBefore(messageElement, activeToolElement.firstChild);
                            } else {
                                activeToolElement.appendChild(messageElement);
                            }
                        }
                    }
                }
                
                // å¦‚æœæ²¡æœ‰æ‰¾åˆ°æˆ–åˆ›å»ºæˆåŠŸï¼Œå›é€€åˆ°å…¨å±€çš„æç¤ºå…ƒç´ 
                if (!messageElement) {
                    messageElement = document.getElementById('toolMessage') || document.querySelector('.toolMessage');
                    
                    // å¦‚æœä»ç„¶æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ›å»ºä¸€ä¸ªå…¨å±€çš„æç¤ºå…ƒç´ 
                    if (!messageElement) {
                        messageElement = document.createElement('div');
                        messageElement.className = 'toolMessage';
                        messageElement.id = 'toolMessage';
                        messageElement.style.padding = '10px';
                        messageElement.style.marginBottom = '10px';
                        messageElement.style.borderRadius = '5px';
                        messageElement.style.backgroundColor = '#f8f9fa';
                        messageElement.style.display = 'none';
                        
                        // å°†å…¨å±€æç¤ºå…ƒç´ æ·»åŠ åˆ°body
                        document.body.appendChild(messageElement);
                    }
                }
                
                // è®¾ç½®æ¶ˆæ¯å†…å®¹å’Œæ ·å¼
                messageElement.textContent = message;
                
                // è®¾ç½®ä¸åŒç±»å‹æ¶ˆæ¯çš„æ ·å¼
                if (type === 'success') {
                    messageElement.style.backgroundColor = '#d4edda';
                    messageElement.style.color = '#155724';
                    messageElement.style.border = '1px solid #c3e6cb';
                } else if (type === 'error') {
                    messageElement.style.backgroundColor = '#f8d7da';
                    messageElement.style.color = '#721c24';
                    messageElement.style.border = '1px solid #f5c6cb';
                } else {
                    messageElement.style.backgroundColor = '#d1ecf1';
                    messageElement.style.color = '#0c5460';
                    messageElement.style.border = '1px solid #bee5eb';
                }
                
                messageElement.style.display = 'block';
                
                // 10ç§’åè‡ªåŠ¨éšè—æ¶ˆæ¯
                setTimeout(() => {
                    if (messageElement && messageElement.style.display === 'block') {
                        messageElement.style.display = 'none';
                    }
                }, 10000);
            }
            
            // ç”Ÿæˆæµæ°´å·å‡½æ•°
            function generateSerialNumbers() {
                const startSerial = document.getElementById('startSerialNumber').value.trim();
                const count = parseInt(document.getElementById('serialNumberCount').value.trim()) || 0;
                const endSerial = document.getElementById('endSerialNumber').value.trim();
                
                // éªŒè¯è¾“å…¥
                if (!startSerial) {
                    showMessage('è¯·è¾“å…¥èµ·å§‹æµæ°´å·', 'error');
                    return;
                }
                
                if (count === 0 && !endSerial) {
                    showMessage('è¯·è¾“å…¥æ•°é‡æˆ–ç»“æŸæµæ°´å·', 'error');
                    return;
                }
                
                if (count > 0 && endSerial) {
                    showMessage('æ•°é‡å’Œç»“æŸæµæ°´å·åªèƒ½é€‰æ‹©ä¸€ä¸ªè¾“å…¥', 'error');
                    return;
                }
                
                const results = [];
                
                try {
                    // å°è¯•æå–èµ·å§‹æµæ°´å·ä¸­çš„æ•°å­—åç¼€
                    const numericMatch = startSerial.match(/(\d+)$/);
                    const prefix = startSerial.replace(/\d+$/, '');
                    const startNumber = numericMatch ? parseInt(numericMatch[1]) : 1;
                    
                    // æ ¹æ®æ•°é‡ç”Ÿæˆ
                    if (count > 0) {
                        for (let i = 0; i < count; i++) {
                            const numberPart = String(startNumber + i).padStart(numericMatch ? numericMatch[1].length : 3, '0');
                            results.push(prefix + numberPart);
                        }
                    } 
                    // æ ¹æ®ç»“æŸæµæ°´å·ç”Ÿæˆ
                    else if (endSerial) {
                        const endNumericMatch = endSerial.match(/(\d+)$/);
                        if (!endNumericMatch) {
                            showMessage('ç»“æŸæµæ°´å·æ ¼å¼ä¸æ­£ç¡®', 'error');
                            return;
                        }
                        
                        const endNumber = parseInt(endNumericMatch[1]);
                        if (endNumber < startNumber) {
                            showMessage('ç»“æŸæµæ°´å·å¿…é¡»å¤§äºèµ·å§‹æµæ°´å·', 'error');
                            return;
                        }
                        
                        for (let i = 0; i <= endNumber - startNumber; i++) {
                            const numberPart = String(startNumber + i).padStart(numericMatch ? numericMatch[1].length : 3, '0');
                            results.push(prefix + numberPart);
                        }
                    }
                    
                    // æ˜¾ç¤ºç»“æœ
                    document.getElementById('serialNumberResult').value = results.join('\n');
                    showMessage('æµæ°´å·ç”ŸæˆæˆåŠŸï¼Œå…±ç”Ÿæˆ ' + results.length + ' ä¸ªæµæ°´å·', 'success');
                    
                } catch (error) {
                    console.error('ç”Ÿæˆæµæ°´å·å¤±è´¥:', error);
                    showMessage('ç”Ÿæˆæµæ°´å·å¤±è´¥: ' + error.message, 'error');
                }
            }
            
            // å¤åˆ¶æµæ°´å·ç»“æœ
            function copySerialNumbers() {
                const resultText = document.getElementById('serialNumberResult').value;
                if (!resultText.trim()) {
                    showMessage('è¯·å…ˆç”Ÿæˆæµæ°´å·', 'error');
                    return;
                }
                
                navigator.clipboard.writeText(resultText).then(() => {
                    showMessage('å¤åˆ¶æˆåŠŸ', 'success');
                }).catch(err => {
                    console.error('å¤åˆ¶å¤±è´¥:', err);
                    showMessage('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
                });
            }
            
            // ä¿®æ”¹ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼
            function formatSerialNumbers() {
                const resultText = document.getElementById('serialNumberResult').value;
                if (!resultText.trim()) {
                    showMessage('è¯·å…ˆç”Ÿæˆæµæ°´å·', 'error');
                    return;
                }
                
                // å°†æ¢è¡Œåˆ†éš”çš„æµæ°´å·è½¬æ¢ä¸ºé€—å·åˆ†éš”
                const serialNumbers = resultText.split('\n').filter(line => line.trim());
                document.getElementById('serialNumberResult').value = serialNumbers.join(',');
                showMessage('å·²è½¬æ¢ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼', 'success');
            }
            
            // é˜²æ­¢ç§‘å­¦è®¡æ•°æ ¼å¼
            function addQuotesToSerialNumbers() {
                const resultText = document.getElementById('serialNumberResult').value;
                if (!resultText.trim()) {
                    showMessage('è¯·å…ˆç”Ÿæˆæµæ°´å·', 'error');
                    return;
                }
                
                // å¤„ç†ä¸åŒæ ¼å¼çš„æµæ°´å·
                let serialNumbers;
                if (resultText.includes(',')) {
                    // é€—å·åˆ†éš”çš„æ ¼å¼
                    serialNumbers = resultText.split(',').filter(item => item.trim());
                    // æ·»åŠ å•å¼•å·å¹¶é‡æ–°ç”¨é€—å·è¿æ¥
                    document.getElementById('serialNumberResult').value = serialNumbers.map(serial => 
                        serial.trim().endsWith("'") ? serial.trim() : serial.trim() + "'"
                    ).join(',');
                } else {
                    // æ¢è¡Œåˆ†éš”çš„æ ¼å¼
                    serialNumbers = resultText.split('\n').filter(line => line.trim());
                    // æ·»åŠ å•å¼•å·å¹¶ä¿æŒæ¢è¡Œæ ¼å¼
                    document.getElementById('serialNumberResult').value = serialNumbers.map(serial => 
                        serial.trim().endsWith("'") ? serial.trim() : serial.trim() + "'"
                    ).join('\n');
                }
                showMessage('å·²æ·»åŠ å•å¼•å·é˜²æ­¢ç§‘å­¦è®¡æ•°æ ¼å¼', 'success');
            }
            
        // ===== äºŒç»´ç è§£æå·¥å…·ç›¸å…³å‡½æ•° =====
        
        // å­˜å‚¨è§£æç»“æœçš„å¯¹è±¡
        let imageParseResults = {};
        
        // åˆå§‹åŒ–äºŒç»´ç è§£æå·¥å…·
        document.addEventListener('DOMContentLoaded', function() {
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            document.getElementById('parseQrBtn').addEventListener('click', parseQrCodes);
            document.getElementById('textRecognitionBtn').addEventListener('click', recognizeTextFromImages);
            document.getElementById('extractInfoBtn').addEventListener('click', extractInfoFromQrResults);
            document.getElementById('clearQrBtn').addEventListener('click', clearQrParser);
            document.getElementById('copyExtractedBtn').addEventListener('click', copyExtractedInfo);
            document.getElementById('formatForBackendBtn').addEventListener('click', formatForBackendQuery);
            
            // æ‹–æ‹½ä¸Šä¼ ç›¸å…³äº‹ä»¶ç»‘å®š
            const dropArea = document.getElementById('dropArea');
            const fileInput = document.getElementById('fileUpload');
            
            // ç‚¹å‡»ä¸Šä¼ åŒºåŸŸè§¦å‘æ–‡ä»¶é€‰æ‹©
            dropArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            // é˜»æ­¢é»˜è®¤æ‹–æ‹½è¡Œä¸º
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });
            
            // æ‹–æ‹½æ ·å¼å˜åŒ–
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });
            
            // å¤„ç†æ–‡ä»¶æ”¾ç½®
            dropArea.addEventListener('drop', handleDrop, false);
            
            // å¤„ç†æ–‡ä»¶é€‰æ‹©å˜åŒ–
            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    const filesText = this.files.length === 1 ? `å·²é€‰æ‹© 1 ä¸ªæ–‡ä»¶` : `å·²é€‰æ‹© ${this.files.length} ä¸ªæ–‡ä»¶`;
                    document.getElementById('dropText').textContent = filesText;
                }
            });
            
            // é˜»æ­¢é»˜è®¤è¡Œä¸ºçš„è¾…åŠ©å‡½æ•°
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            // é«˜äº®æ‹–æ‹½åŒºåŸŸçš„è¾…åŠ©å‡½æ•°
            function highlight() {
                dropArea.style.borderColor = '#667eea';
                dropArea.style.backgroundColor = 'rgba(102, 126, 234, 0.05)';
            }
            
            // å–æ¶ˆé«˜äº®æ‹–æ‹½åŒºåŸŸçš„è¾…åŠ©å‡½æ•°
            function unhighlight() {
                dropArea.style.borderColor = '#ccc';
                dropArea.style.backgroundColor = 'transparent';
            }
            
            // å¤„ç†æ‹–æ‹½æ”¾ç½®æ–‡ä»¶çš„è¾…åŠ©å‡½æ•°
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                // å°†æ‹–æ‹½çš„æ–‡ä»¶è®¾ç½®åˆ°æ–‡ä»¶è¾“å…¥æ¡†
                fileInput.files = files;
                
                // æ›´æ–°æ˜¾ç¤ºæ–‡æœ¬
                if (files.length > 0) {
                    const filesText = files.length === 1 ? `å·²æ‹–æ‹½ 1 ä¸ªæ–‡ä»¶` : `å·²æ‹–æ‹½ ${files.length} ä¸ªæ–‡ä»¶`;
                    document.getElementById('dropText').textContent = filesText;
                }
            }
        });
        
        // è§£æäºŒç»´ç 
        function parseQrCodes() {
            // æ£€æŸ¥jsQRåº“æ˜¯å¦å¯ç”¨
            if (typeof jsQR === 'undefined') {
                showQrParserStatus('jsQRåº“æœªåŠ è½½ï¼Œæ— æ³•è§£æäºŒç»´ç ', 'error');
                console.error('jsQRåº“æœªåŠ è½½');
                return;
            }
            
            const fileInput = document.getElementById('fileUpload');
            const files = fileInput.files;
            const qrResults = document.getElementById('qrResults');
            const statusSection = document.getElementById('qrParserStatus');
            const extractInfoBtn = document.getElementById('extractInfoBtn');
            const previewArea = document.getElementById('imagePreviewArea');
            
            // æ¸…ç©ºä¹‹å‰çš„ç»“æœ
            qrResults.value = '';
            document.getElementById('extractedInfo').value = '';
            previewArea.innerHTML = '';
            extractInfoBtn.disabled = true;
            imageParseResults = {};
            
            // æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶è¢«é€‰æ‹©
            if (files.length === 0) {
                showQrParserStatus('è¯·å…ˆé€‰æ‹©æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹', 'error');
                return;
            }
            
            showQrParserStatus('æ­£åœ¨è§£æäºŒç»´ç ï¼Œè¯·ç¨å€™...', 'info');
            
            // è¿‡æ»¤å‡ºå›¾ç‰‡æ–‡ä»¶
            const imageFiles = Array.from(files).filter(file => file.type.startsWith('image/'));
            
            if (imageFiles.length === 0) {
                showQrParserStatus('æœªæ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶', 'error');
                return;
            }
            
            showQrParserStatus(`æ‰¾åˆ° ${imageFiles.length} ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œæ­£åœ¨è§£æ...`, 'info');
            
            let results = [];
            let processedCount = 0;
            
            // ä¾æ¬¡è§£ææ¯ä¸ªå›¾ç‰‡æ–‡ä»¶
            imageFiles.forEach(file => {
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    const img = new Image();
                    const imgSrc = event.target.result;
                    
                    // è®¾ç½®å›¾ç‰‡è·¨åŸŸå±æ€§
                    img.crossOrigin = 'anonymous';
                    
                    // è®¾ç½®å›¾ç‰‡åŠ è½½è¶…æ—¶
                    const timeoutId = setTimeout(() => {
                        console.error(`å›¾ç‰‡ ${file.name} åŠ è½½è¶…æ—¶`);
                        img.src = ''; // å–æ¶ˆåŠ è½½
                        
                        // åˆå§‹åŒ–è¯¥å›¾ç‰‡çš„è§£æç»“æœå¯¹è±¡
                        const fileId = file.name + '_' + Date.now();
                        imageParseResults[fileId] = {
                            fileName: file.name,
                            qrContent: 'å›¾ç‰‡åŠ è½½è¶…æ—¶',
                            textContent: ''
                        };
                        
                        // åˆ›å»ºå›¾ç‰‡é¢„è§ˆå…ƒç´ ï¼ˆåªæœ‰æ–‡ä»¶åï¼Œæ²¡æœ‰å›¾ç‰‡ï¼‰
                        createImagePreview(fileId, '', imageParseResults[fileId]);
                        
                        results.push(`æ–‡ä»¶å: ${file.name}\nå›¾ç‰‡åŠ è½½è¶…æ—¶`);
                        processedCount++;
                        
                        if (processedCount === imageFiles.length) {
                            qrResults.value = results.join('\n------------------------\n');
                            extractInfoBtn.disabled = false;
                            showQrParserStatus(`äºŒç»´ç è§£æå®Œæˆï¼Œå…±å¤„ç† ${imageFiles.length} ä¸ªæ–‡ä»¶`, 'info');
                        }
                    }, 10000); // 10ç§’è¶…æ—¶
                    
                    img.onload = function() {
                        clearTimeout(timeoutId);
                        console.log(`å›¾ç‰‡ ${file.name} åŠ è½½æˆåŠŸï¼Œå°ºå¯¸: ${img.width}x${img.height}`);
                        
                        try {
                            // åˆ›å»ºCanvaså¹¶ç»˜åˆ¶å›¾ç‰‡
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            
                            if (!ctx) {
                                throw new Error('æ— æ³•åˆ›å»ºCanvasä¸Šä¸‹æ–‡');
                            }
                            
                            // é™åˆ¶å›¾ç‰‡æœ€å¤§å°ºå¯¸ä¸º2000pxï¼Œé¿å…Canvasè¿‡å¤§
                            const maxSize = 2000;
                            let width = img.width;
                            let height = img.height;
                            
                            if (width > maxSize || height > maxSize) {
                                const scale = maxSize / Math.max(width, height);
                                width *= scale;
                                height *= scale;
                                console.log(`å›¾ç‰‡ ${file.name} è¢«ç¼©æ”¾åˆ°: ${width}x${height}`);
                            }
                            
                            canvas.width = width;
                            canvas.height = height;
                            
                            // æ¸…ç©ºCanvas
                            ctx.clearRect(0, 0, canvas.width, canvas.height);
                            
                            // ç»˜åˆ¶å›¾ç‰‡
                            ctx.drawImage(img, 0, 0, width, height);
                            
                            // åˆå§‹åŒ–è¯¥å›¾ç‰‡çš„è§£æç»“æœå¯¹è±¡
                            const fileId = file.name + '_' + Date.now();
                            imageParseResults[fileId] = {
                                fileName: file.name,
                                qrContent: '',
                                textContent: ''
                            };
                            
                            // è·å–å›¾åƒæ•°æ®
                            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                            console.log(`è·å–å›¾åƒæ•°æ®æˆåŠŸ: ${imageData.width}x${imageData.height}, æ•°æ®é•¿åº¦: ${imageData.data.length}`);
                            
                            // ä½¿ç”¨jsQRè§£æäºŒç»´ç ï¼Œæ·»åŠ é…ç½®é€‰é¡¹
                            let code = null;
                            try {
                                code = jsQR(imageData.data, imageData.width, imageData.height, {
                                    inversionAttempts: 'attemptBoth', // å°è¯•æ­£å¸¸å’Œåè½¬é¢œè‰²
                                    errorCorrectionLevel: 'high' // é«˜çº é”™çº§åˆ«
                                });
                                console.log(`jsQRè§£æç»“æœ:`, code);
                            } catch (jsQRError) {
                                console.error(`jsQRè§£æå¤±è´¥:`, jsQRError);
                                throw new Error(`jsQRè§£æå¤±è´¥: ${jsQRError.message}`);
                            }
                        
                        // å‡†å¤‡æ–‡ä»¶ç»“æœ
                        let fileResult = `æ–‡ä»¶å: ${file.name}`;
                        let qrContent = '';
                        if (code) {
                            fileResult += `\näºŒç»´ç å†…å®¹: ${code.data}`;
                            qrContent = code.data;
                        } else {
                            fileResult += `\næœªæ‰¾åˆ°äºŒç»´ç `;
                            qrContent = 'æœªæ‰¾åˆ°äºŒç»´ç ';
                        }
                        
                        // ä¿å­˜äºŒç»´ç è§£æç»“æœ
                        imageParseResults[fileId].qrContent = qrContent;
                        
                        // åˆ›å»ºå›¾ç‰‡é¢„è§ˆå…ƒç´ 
                        createImagePreview(fileId, imgSrc, imageParseResults[fileId]);
                        
                        results.push(fileResult);
                        processedCount++;
                        
                        // æ›´æ–°çŠ¶æ€
                        showQrParserStatus(`å·²è§£æ ${processedCount}/${imageFiles.length} ä¸ªæ–‡ä»¶`, 'info');
                        
                        // æ‰€æœ‰æ–‡ä»¶éƒ½å¤„ç†å®Œæ¯•
                        if (processedCount === imageFiles.length) {
                            // æ˜¾ç¤ºç»“æœ
                            qrResults.value = results.join('\n------------------------\n');
                            
                            // å¯ç”¨æå–ä¿¡æ¯æŒ‰é’®
                            extractInfoBtn.disabled = false;
                            
                            showQrParserStatus(`äºŒç»´ç è§£æå®Œæˆï¼Œå…±å¤„ç† ${imageFiles.length} ä¸ªæ–‡ä»¶`, 'info');
                        }
                        } catch (error) {
                            console.error(`å¤„ç†å›¾ç‰‡ ${file.name} æ—¶å‘ç”Ÿé”™è¯¯:`, error);
                            
                            // åˆå§‹åŒ–è¯¥å›¾ç‰‡çš„è§£æç»“æœå¯¹è±¡
                            const fileId = file.name + '_' + Date.now();
                            imageParseResults[fileId] = {
                                fileName: file.name,
                                qrContent: `è§£æé”™è¯¯: ${error.message}`,
                                textContent: ''
                            };
                            
                            // åˆ›å»ºå›¾ç‰‡é¢„è§ˆå…ƒç´ 
                            createImagePreview(fileId, imgSrc, imageParseResults[fileId]);
                            
                            results.push(`æ–‡ä»¶å: ${file.name}\nè§£æé”™è¯¯: ${error.message}`);
                            processedCount++;
                            
                            if (processedCount === imageFiles.length) {
                                qrResults.value = results.join('\n------------------------\n');
                                extractInfoBtn.disabled = false;
                                showQrParserStatus(`äºŒç»´ç è§£æå®Œæˆï¼Œå…±å¤„ç† ${imageFiles.length} ä¸ªæ–‡ä»¶`, 'info');
                            }
                        }
                    };
                    
                    img.onerror = function() {
                        clearTimeout(timeoutId);
                        console.error(`å›¾ç‰‡ ${file.name} åŠ è½½å¤±è´¥`);
                        
                        // åˆå§‹åŒ–è¯¥å›¾ç‰‡çš„è§£æç»“æœå¯¹è±¡
                        const fileId = file.name + '_' + Date.now();
                        imageParseResults[fileId] = {
                            fileName: file.name,
                            qrContent: 'å›¾ç‰‡åŠ è½½å¤±è´¥',
                            textContent: ''
                        };
                        
                        // åˆ›å»ºå›¾ç‰‡é¢„è§ˆå…ƒç´ ï¼ˆåªæœ‰æ–‡ä»¶åï¼Œæ²¡æœ‰å›¾ç‰‡ï¼‰
                        createImagePreview(fileId, '', imageParseResults[fileId]);
                        
                        results.push(`æ–‡ä»¶å: ${file.name}\nå›¾ç‰‡åŠ è½½å¤±è´¥`);
                        processedCount++;
                        
                        if (processedCount === imageFiles.length) {
                            qrResults.value = results.join('\n------------------------\n');
                            extractInfoBtn.disabled = false;
                            showQrParserStatus(`äºŒç»´ç è§£æå®Œæˆï¼Œå…±å¤„ç† ${imageFiles.length} ä¸ªæ–‡ä»¶`, 'info');
                        }
                    };
                    
                    img.src = imgSrc;
                };
                
                reader.onerror = function() {
                    // åˆå§‹åŒ–è¯¥å›¾ç‰‡çš„è§£æç»“æœå¯¹è±¡
                    const fileId = file.name + '_' + Date.now();
                    imageParseResults[fileId] = {
                        fileName: file.name,
                        qrContent: 'æ–‡ä»¶è¯»å–å¤±è´¥',
                        textContent: ''
                    };
                    
                    // åˆ›å»ºå›¾ç‰‡é¢„è§ˆå…ƒç´ ï¼ˆåªæœ‰æ–‡ä»¶åï¼Œæ²¡æœ‰å›¾ç‰‡ï¼‰
                    createImagePreview(fileId, '', imageParseResults[fileId]);
                    
                    results.push(`æ–‡ä»¶å: ${file.name}\næ–‡ä»¶è¯»å–å¤±è´¥`);
                    processedCount++;
                    
                    if (processedCount === imageFiles.length) {
                        qrResults.value = results.join('\n------------------------\n');
                        extractInfoBtn.disabled = false;
                        showQrParserStatus(`äºŒç»´ç è§£æå®Œæˆï¼Œå…±å¤„ç† ${imageFiles.length} ä¸ªæ–‡ä»¶`, 'info');
                    }
                };
                
                reader.readAsDataURL(file);
            });
        }
        
        // ä»å›¾ç‰‡ä¸­è¯†åˆ«æ–‡å­—
        function recognizeTextFromImages() {
            const fileInput = document.getElementById('fileUpload');
            const files = fileInput.files;
            const statusSection = document.getElementById('qrParserStatus');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶è¢«é€‰æ‹©
            if (files.length === 0) {
                showQrParserStatus('è¯·å…ˆé€‰æ‹©æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹', 'error');
                return;
            }
            
            showQrParserStatus('æ­£åœ¨è¿›è¡Œæ–‡å­—è¯†åˆ«ï¼Œè¯·ç¨å€™...', 'info');
            
            // è¿‡æ»¤å‡ºå›¾ç‰‡æ–‡ä»¶
            const imageFiles = Array.from(files).filter(file => file.type.startsWith('image/'));
            
            if (imageFiles.length === 0) {
                showQrParserStatus('æœªæ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶', 'error');
                return;
            }
            
            let processedCount = 0;
            
            // ä¾æ¬¡å¯¹æ¯ä¸ªå›¾ç‰‡è¿›è¡Œæ–‡å­—è¯†åˆ«
            imageFiles.forEach(file => {
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    const img = new Image();
                    
                    img.onload = function() {
                        // åˆ›å»ºCanvaså¹¶ç»˜åˆ¶å›¾ç‰‡
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        
                        // æŸ¥æ‰¾å¯¹åº”çš„æ–‡ä»¶ID
                        let fileId = null;
                        for (const id in imageParseResults) {
                            if (imageParseResults[id].fileName === file.name) {
                                fileId = id;
                                break;
                            }
                        }
                        
                        // å¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ID
                        if (!fileId) {
                            fileId = file.name + '_' + Date.now();
                            imageParseResults[fileId] = {
                                fileName: file.name,
                                qrContent: '',
                                textContent: ''
                            };
                        }
                        
                        // è¿›è¡Œæ–‡å­—è¯†åˆ«
                        recognizeTextFromCanvas(canvas, file.name).then(textResult => {
                            const textContent = textResult && textResult.trim() ? textResult.trim() : 'æœªè¯†åˆ«åˆ°æ–‡å­—';
                            
                            // ä¿å­˜æ–‡å­—è¯†åˆ«ç»“æœ
                            imageParseResults[fileId].textContent = textContent;
                            
                            // æ›´æ–°é¢„è§ˆåŒºåŸŸçš„æ–‡å­—è¯†åˆ«ç»“æœ
                            updateImagePreviewResults(fileId, imageParseResults[fileId]);
                            
                            processedCount++;
                            
                            // æ›´æ–°çŠ¶æ€
                            showQrParserStatus(`å·²å¤„ç† ${processedCount}/${imageFiles.length} ä¸ªæ–‡ä»¶`, 'info');
                            
                            // æ‰€æœ‰æ–‡ä»¶è¯†åˆ«å®Œæˆ
                            if (processedCount === imageFiles.length) {
                                showQrParserStatus('æ–‡å­—è¯†åˆ«å®Œæˆ', 'success');
                                
                                // æ›´æ–°å¤§çš„è¾“å‡ºæ¡†
                                updateQrResultsTextarea();
                            }
                        }).catch(error => {
                            // æ›´å¥å£®çš„é”™è¯¯å¤„ç†
                            let errorMessage = 'æœªçŸ¥é”™è¯¯';
                            if (error) {
                                if (error.message) {
                                    errorMessage = error.message;
                                } else if (typeof error === 'string') {
                                    errorMessage = error;
                                } else {
                                    errorMessage = JSON.stringify(error);
                                }
                            }
                            
                            // ä¿å­˜é”™è¯¯ç»“æœ
                            if (imageParseResults[fileId]) {
                                imageParseResults[fileId].textContent = 'è¯†åˆ«é”™è¯¯: ' + errorMessage;
                                updateImagePreviewResults(fileId, imageParseResults[fileId]);
                            }
                            
                            processedCount++;
                            
                            // æ›´æ–°çŠ¶æ€
                            showQrParserStatus(`å·²å¤„ç† ${processedCount}/${imageFiles.length} ä¸ªæ–‡ä»¶`, 'info');
                            
                            // æ‰€æœ‰æ–‡ä»¶è¯†åˆ«å®Œæˆ
                            if (processedCount === imageFiles.length) {
                                showQrParserStatus('æ–‡å­—è¯†åˆ«å®Œæˆ', 'success');
                                
                                // æ›´æ–°å¤§çš„è¾“å‡ºæ¡†
                                updateQrResultsTextarea();
                            }
                        });
                    };
                    
                    img.onerror = function() {
                        // æŸ¥æ‰¾å¯¹åº”çš„æ–‡ä»¶ID
                        let fileId = null;
                        for (const id in imageParseResults) {
                            if (imageParseResults[id].fileName === file.name) {
                                fileId = id;
                                break;
                            }
                        }
                        
                        // ä¿å­˜é”™è¯¯ç»“æœ
                        if (imageParseResults[fileId]) {
                            imageParseResults[fileId].textContent = 'å›¾ç‰‡åŠ è½½å¤±è´¥';
                            updateImagePreviewResults(fileId, imageParseResults[fileId]);
                        }
                        
                        processedCount++;
                        
                        if (processedCount === imageFiles.length) {
                            showQrParserStatus('æ–‡å­—è¯†åˆ«å®Œæˆ', 'success');
                            updateQrResultsTextarea();
                        }
                    };
                    
                    img.src = event.target.result;
                };
                
                reader.onerror = function() {
                    // æŸ¥æ‰¾å¯¹åº”çš„æ–‡ä»¶ID
                    let fileId = null;
                    for (const id in imageParseResults) {
                        if (imageParseResults[id].fileName === file.name) {
                            fileId = id;
                            break;
                        }
                    }
                    
                    // ä¿å­˜é”™è¯¯ç»“æœ
                    if (imageParseResults[fileId]) {
                        imageParseResults[fileId].textContent = 'æ–‡ä»¶è¯»å–å¤±è´¥';
                        updateImagePreviewResults(fileId, imageParseResults[fileId]);
                    }
                    
                    processedCount++;
                    
                    if (processedCount === imageFiles.length) {
                        showQrParserStatus('æ–‡å­—è¯†åˆ«å®Œæˆ', 'success');
                        updateQrResultsTextarea();
                    }
                };
                
                reader.readAsDataURL(file);
            });
        }
        
        // åˆ›å»ºå›¾ç‰‡é¢„è§ˆå…ƒç´ 
        function createImagePreview(fileId, imgSrc, results) {
            const previewArea = document.getElementById('imagePreviewArea');
            
            const previewItem = document.createElement('div');
            previewItem.className = 'image-preview-item';
            previewItem.dataset.fileId = fileId;
            
            if (imgSrc) {
                const img = document.createElement('img');
                img.className = 'preview-image';
                img.src = imgSrc;
                img.alt = results.fileName;
                previewItem.appendChild(img);
            }
            
            const fileName = document.createElement('div');
            fileName.style.fontWeight = 'bold';
            fileName.style.marginBottom = '5px';
            fileName.textContent = results.fileName;
            previewItem.appendChild(fileName);
            
            const imageResults = document.createElement('div');
            imageResults.className = 'image-results';
            
            const qrInfo = document.createElement('div');
            qrInfo.className = 'qr-info';
            qrInfo.textContent = `äºŒç»´ç ä¿¡æ¯: ${results.qrContent}`;
            
            const textInfo = document.createElement('div');
            textInfo.className = 'text-info';
            textInfo.textContent = `æ–‡å­—ä¿¡æ¯: ${results.textContent || 'æœªè¿›è¡Œæ–‡å­—è¯†åˆ«'}`;
            
            imageResults.appendChild(qrInfo);
            imageResults.appendChild(textInfo);
            
            previewItem.appendChild(imageResults);
            
            previewArea.appendChild(previewItem);
        }
        
        // æ›´æ–°å›¾ç‰‡é¢„è§ˆçš„ç»“æœæ˜¾ç¤º
        function updateImagePreviewResults(fileId, results) {
            const previewItem = document.querySelector(`.image-preview-item[data-file-id="${fileId}"]`);
            if (previewItem) {
                const qrInfo = previewItem.querySelector('.qr-info');
                const textInfo = previewItem.querySelector('.text-info');
                
                if (qrInfo) {
                    qrInfo.textContent = `äºŒç»´ç ä¿¡æ¯: ${results.qrContent}`;
                }
                
                if (textInfo) {
                    textInfo.textContent = `æ–‡å­—ä¿¡æ¯: ${results.textContent}`;
                }
            }
        }
        
        // æ›´æ–°äºŒç»´ç è§£æç»“æœæ–‡æœ¬æ¡†
        function updateQrResultsTextarea() {
            const qrResults = document.getElementById('qrResults');
            let results = [];
            
            for (const fileId in imageParseResults) {
                const result = imageParseResults[fileId];
                let resultText = `æ–‡ä»¶å: ${result.fileName}`;
                
                if (result.qrContent) {
                    if (result.qrContent === 'æœªæ‰¾åˆ°äºŒç»´ç ') {
                        resultText += `\næœªæ‰¾åˆ°äºŒç»´ç `;
                    } else {
                        resultText += `\näºŒç»´ç å†…å®¹: ${result.qrContent}`;
                    }
                }
                
                if (result.textContent && result.textContent !== 'æœªè¿›è¡Œæ–‡å­—è¯†åˆ«') {
                    if (result.textContent === 'æœªè¯†åˆ«åˆ°æ–‡å­—') {
                        resultText += `\næœªè¯†åˆ«åˆ°æ–‡å­—`;
                    } else {
                        resultText += `\nè¯†åˆ«æ–‡å­—: ${result.textContent}`;
                    }
                }
                
                results.push(resultText);
            }
            
            qrResults.value = results.join('\n------------------------\n');
        }
        
        // ä¸»OCRæ¥å£ - ä½¿ç”¨Tesseract.jså¹¶é…ç½®ä¸ºåªè¯†åˆ«æ•°å­—
        async function primaryOCR(canvas, fileName) {
            try {
                const worker = await Tesseract.createWorker('eng');
                try {
                    // é…ç½®Tesseractåªè¯†åˆ«æ•°å­—
                    await worker.setParameters({
                        tessedit_char_whitelist: '0123456789',
                        tessedit_pageseg_mode: 6
                    });
                    const result = await worker.recognize(canvas);
                    return result.data.text;
                } finally {
                    await worker.terminate();
                }
            } catch (error) {
                console.error(`ä¸»OCRæ¥å£ï¼ˆTesseractï¼‰è¯†åˆ«å¤±è´¥:`, error);
                throw new Error(`ä¸»æ¥å£å¤±è´¥: ${error.message || 'æœªçŸ¥é”™è¯¯'}`);
            }
        }

        // å¤‡ç”¨OCRæ¥å£1 - ä½¿ç”¨OCRAD.jsåªè¯†åˆ«æ•°å­—
        function fallbackOCR1(canvas, fileName) {
            try {
                // OCRADè¯†åˆ«
                const text = OCRAD(canvas);
                // è¿‡æ»¤åªä¿ç•™æ•°å­—
                return text.replace(/[^0-9]/g, '');
            } catch (error) {
                console.error(`å¤‡ç”¨OCRæ¥å£1ï¼ˆOCRAD.jsï¼‰è¯†åˆ«å¤±è´¥:`, error);
                throw new Error(`å¤‡ç”¨æ¥å£1å¤±è´¥: ${error.message || 'æœªçŸ¥é”™è¯¯'}`);
            }
        }

        // å¤‡ç”¨OCRæ¥å£2 - ä½¿ç”¨canvas-ocråªè¯†åˆ«æ•°å­—
        function fallbackOCR2(canvas, fileName) {
            try {
                const ocr = new CanvasOCR();
                // è®¾ç½®åªè¯†åˆ«æ•°å­—
                ocr.setOptions({
                    lang: 'en',
                    charWhitelist: '0123456789'
                });
                // ç”±äºcanvas-ocrå¯èƒ½æ˜¯åŒæ­¥çš„ï¼Œè¿™é‡Œç”¨PromiseåŒ…è£…
                return new Promise((resolve, reject) => {
                    try {
                        const text = ocr.recognize(canvas);
                        resolve(text);
                    } catch (err) {
                        reject(new Error(`å¤‡ç”¨æ¥å£2å¤±è´¥: ${err.message || 'æœªçŸ¥é”™è¯¯'}`));
                    }
                });
            } catch (error) {
                console.error(`å¤‡ç”¨OCRæ¥å£2ï¼ˆcanvas-ocrï¼‰è¯†åˆ«å¤±è´¥:`, error);
                throw new Error(`å¤‡ç”¨æ¥å£2å¤±è´¥: ${error.message || 'æœªçŸ¥é”™è¯¯'}`);
            }
        }

        // ä»Canvasä¸­è¯†åˆ«æ–‡å­—ï¼ˆä¸»å¤‡æ¥å£æœºåˆ¶ï¼‰
        async function recognizeTextFromCanvas(canvas, fileName) {
            let allErrors = [];
            let timeoutId;
            
            // è®¾ç½®15ç§’å…¨å±€è¶…æ—¶
            const timeoutPromise = new Promise((_, reject) => {
                timeoutId = setTimeout(() => reject(new Error('æ–‡å­—è¯†åˆ«è¶…æ—¶ï¼Œè¯·å°è¯•åˆ†è¾¨ç‡è¾ƒä½çš„å›¾ç‰‡')), 15000);
            });
            
            try {
                // å°è¯•ä¸»æ¥å£
                try {
                    const textResult = await Promise.race([primaryOCR(canvas, fileName), timeoutPromise]);
                    if (textResult && textResult.trim()) {
                        return textResult;
                    } else {
                        throw new Error('ä¸»æ¥å£æœªè¯†åˆ«åˆ°æœ‰æ•ˆå†…å®¹');
                    }
                } catch (primaryError) {
                    allErrors.push(primaryError.message);
                    console.log(`ä¸»æ¥å£å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨æ¥å£1...`);
                    
                    // å°è¯•å¤‡ç”¨æ¥å£1
                    try {
                        const textResult = await Promise.race([fallbackOCR1(canvas, fileName), timeoutPromise]);
                        if (textResult && textResult.trim()) {
                            return textResult;
                        } else {
                            throw new Error('å¤‡ç”¨æ¥å£1æœªè¯†åˆ«åˆ°æœ‰æ•ˆå†…å®¹');
                        }
                    } catch (fallback1Error) {
                        allErrors.push(fallback1Error.message);
                        console.log(`å¤‡ç”¨æ¥å£1å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨æ¥å£2...`);
                        
                        // å°è¯•å¤‡ç”¨æ¥å£2
                        try {
                            const textResult = await Promise.race([fallbackOCR2(canvas, fileName), timeoutPromise]);
                            if (textResult && textResult.trim()) {
                                return textResult;
                            } else {
                                throw new Error('å¤‡ç”¨æ¥å£2æœªè¯†åˆ«åˆ°æœ‰æ•ˆå†…å®¹');
                            }
                        } catch (fallback2Error) {
                            allErrors.push(fallback2Error.message);
                            console.log(`æ‰€æœ‰OCRæ¥å£å‡å¤±è´¥`);
                            // æ‰€æœ‰æ¥å£éƒ½å¤±è´¥ï¼ŒæŠ›å‡ºç»¼åˆé”™è¯¯
                            throw new Error(`æ‰€æœ‰OCRæ¥å£å¤±è´¥: ${allErrors.join(', ')}`);
                        }
                    }
                }
            } catch (error) {
                console.error(`æ–‡ä»¶ ${fileName} æ–‡å­—è¯†åˆ«æœ€ç»ˆå¤±è´¥:`, error);
                throw error;
            } finally {
                clearTimeout(timeoutId);
            }
        }
        
        // ä»äºŒç»´ç ç»“æœä¸­æå–ä¿¡æ¯ï¼ˆåŒ…æ‹¬æ–‡å­—è¯†åˆ«ç»“æœï¼‰
        function extractInfoFromQrResults() {
            const extractedInfo = document.getElementById('extractedInfo');
            const statusSection = document.getElementById('qrParserStatus');
            
            if (Object.keys(imageParseResults).length === 0) {
                showQrParserStatus('è¯·å…ˆè§£æäºŒç»´ç ', 'error');
                return;
            }
            
            // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–15ä½ä»¥å†…çš„æ•°å­—
            const extractedNumbers = [];
            
            // æŒ‰æ–‡ä»¶å¤„ç†ç»“æœ
            for (const fileId in imageParseResults) {
                const result = imageParseResults[fileId];
                let currentFileContent = '';
                
                if (result.qrContent && result.qrContent !== 'æœªæ‰¾åˆ°äºŒç»´ç ' && result.qrContent !== 'å›¾ç‰‡åŠ è½½å¤±è´¥' && result.qrContent !== 'æ–‡ä»¶è¯»å–å¤±è´¥') {
                    currentFileContent += result.qrContent + ' ';
                }
                
                if (result.textContent && result.textContent !== 'æœªè¿›è¡Œæ–‡å­—è¯†åˆ«' && result.textContent !== 'æœªè¯†åˆ«åˆ°æ–‡å­—' && !result.textContent.startsWith('è¯†åˆ«é”™è¯¯:')) {
                    currentFileContent += result.textContent + ' ';
                }
                
                if (currentFileContent) {
                    extractNumbersFromContent(currentFileContent, extractedNumbers, result.fileName);
                }
            }
        }
        
        // ä»å†…å®¹ä¸­æå–æ•°å­—
        function extractNumbersFromContent(content, extractedNumbers, fileName) {
            // æå–æ‰€æœ‰1-15ä½çš„è¿ç»­æ•°å­—
            const matches = content.match(/\d{1,15}/g);
            if (matches) {
                // å»é‡å¹¶æ·»åŠ åˆ°ç»“æœæ•°ç»„
                const uniqueNumbers = [...new Set(matches)];
                uniqueNumbers.forEach(number => {
                    if (!extractedNumbers.includes(number)) {
                        extractedNumbers.push(number);
                    }
                });
            }
            
            if (extractedNumbers.length > 0) {
                extractedInfo.value = extractedNumbers.join('\n');
                showQrParserStatus(`æˆåŠŸæå– ${extractedNumbers.length} ä¸ªæœ‰æ•ˆä¿¡æ¯`, 'info');
                // å¯ç”¨å¤åˆ¶ç»“æœå’Œä¿®æ”¹æ ¼å¼æŒ‰é’®
                document.getElementById('copyExtractedBtn').disabled = false;
                document.getElementById('formatForBackendBtn').disabled = false;
            } else {
                extractedInfo.value = 'æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„15ä½ä»¥å†…æ•°å­—';
                showQrParserStatus('æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ä¿¡æ¯', 'info');
                // ç¦ç”¨æŒ‰é’®
                document.getElementById('copyExtractedBtn').disabled = true;
                document.getElementById('formatForBackendBtn').disabled = true;
            }
        }
        
        // æ¸…ç©ºäºŒç»´ç è§£æå™¨
        function clearQrParser() {
            document.getElementById('fileUpload').value = '';
            document.getElementById('qrResults').value = '';
            document.getElementById('extractedInfo').value = '';
            document.getElementById('imagePreviewArea').innerHTML = '';
            document.getElementById('extractInfoBtn').disabled = true;
            document.getElementById('copyExtractedBtn').disabled = true;
            document.getElementById('formatForBackendBtn').disabled = true;
            document.getElementById('qrParserStatus').style.display = 'none';
            document.getElementById('dropText').textContent = 'ğŸ“ ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡æ–‡ä»¶åˆ°è¿™é‡Œä¸Šä¼ ';
            imageParseResults = {};
        }
        
        // å¤åˆ¶æå–çš„ä¿¡æ¯
        function copyExtractedInfo() {
            const extractedInfo = document.getElementById('extractedInfo');
            
            if (extractedInfo.value.trim()) {
                extractedInfo.select();
                document.execCommand('copy');
                
                // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçš„æç¤º
                showQrParserStatus('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'info');
            } else {
                showQrParserStatus('æ²¡æœ‰å¯å¤åˆ¶çš„ä¿¡æ¯', 'error');
            }
        }
        
        // ä¿®æ”¹ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼
        function formatForBackendQuery() {
            const extractedInfo = document.getElementById('extractedInfo');
            
            if (extractedInfo.value.trim()) {
                // å°†æ¢è¡Œåˆ†éš”è½¬æ¢ä¸ºé€—å·åˆ†éš”
                const commaSeparated = extractedInfo.value.split('\n').filter(line => line.trim()).join(',');
                
                // å¤åˆ¶åˆ°å‰ªè´´æ¿
                const tempTextarea = document.createElement('textarea');
                tempTextarea.value = commaSeparated;
                document.body.appendChild(tempTextarea);
                tempTextarea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextarea);
                
                // æ˜¾ç¤ºä¿®æ”¹æˆåŠŸçš„æç¤º
                showQrParserStatus('å·²è½¬æ¢ä¸ºåå°æ‰¹é‡æŸ¥è¯¢æ ¼å¼å¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿', 'info');
            } else {
                showQrParserStatus('æ²¡æœ‰å¯è½¬æ¢çš„ä¿¡æ¯', 'error');
            }
        }
        
        // æ˜¾ç¤ºäºŒç»´ç è§£æå™¨çŠ¶æ€ä¿¡æ¯
        function showQrParserStatus(message, type) {
            const statusSection = document.getElementById('qrParserStatus');
            statusSection.textContent = message;
            statusSection.className = 'status-section';
            statusSection.classList.add(type === 'error' ? 'error' : 'info');
            statusSection.style.display = 'block';
        }
        
        // è§£æIMEIå’ŒICCID
        function parseImeiAndIccid() {
            const logInput = document.getElementById('logInput');
            const imeiIccidResult = document.getElementById('imeiIccidResult');
            const statusSection = document.getElementById('statusSection');
            
            const inputLines = logInput.value.trim().split('\n');
            const results = [];
            
            if (inputLines.length === 0) {
                showStatus('è¯·è¾“å…¥æ—¥å¿—æ•°æ®', 'error');
                return;
            }
            
            // é€è¡Œè§£æ
            inputLines.forEach(line => {
                if (line.trim()) {
                    const parsed = extractImeiAndIccid(line.trim());
                    results.push(parsed);
                } else {
                    results.push(''); // ä¿ç•™ç©ºè¡Œ
                }
            });
            
            // æ˜¾ç¤ºç»“æœ
            imeiIccidResult.value = results.join('\n');
            showStatus(`æˆåŠŸè§£æ ${inputLines.length} æ¡æ•°æ®`, 'info');
        }
        
        // ä»å•è¡Œæ•°æ®ä¸­æå–IMEIå’ŒICCID
        function extractImeiAndIccid(line) {
            try {
                // æ¸…ç†æ•°æ®ï¼Œç§»é™¤æ‰€æœ‰åˆ†éš”ç¬¦å’Œç©ºæ ¼
                const cleanLine = line.replace(/[\s-]/g, '');
                
                let imei = '';
                let iccid = '';
                
                // é¦–å…ˆå°è¯•ç›´æ¥æŸ¥æ‰¾IMEIå’ŒICCIDçš„ç‰¹å¾æ¨¡å¼
                
                // æŸ¥æ‰¾IMEIï¼ˆé€šå¸¸æ˜¯15ä½æ•°å­—ï¼Œå‰ä¸¤ä½æ˜¯86ï¼‰
                const imeiMatch = cleanLine.match(/([8][6]\d{13})/);
                if (imeiMatch && imeiMatch[1]) {
                    imei = imeiMatch[1];
                } else {
                    // å°è¯•é€šè¿‡ä½ç½®æå–IMEI
                    const imeiPositionMatch = cleanLine.match(/0[03]86(\d{13})/);
                    if (imeiPositionMatch && imeiPositionMatch[1]) {
                        imei = '86' + imeiPositionMatch[1];
                    }
                }
                
                // æŸ¥æ‰¾ICCIDï¼ˆé€šå¸¸æ˜¯20ä½å­—ç¬¦ï¼Œå‰å››ä½æ˜¯8986ï¼‰
                const iccidMatch = cleanLine.match(/(8986\w{16})/);
                if (iccidMatch && iccidMatch[1]) {
                    iccid = iccidMatch[1];
                }
                
                // å¦‚æœé€šè¿‡ç‰¹å¾æ¨¡å¼æ²¡æœ‰æ‰¾åˆ°ï¼Œå°è¯•ä½¿ç”¨ä½ç½®æ–¹æ³•
                if (!imei || !iccid) {
                    if (cleanLine.length >= 58) {
                        // 58å­—èŠ‚æ•°æ®
                        if (!imei) {
                            // å°è¯•ä»ç¬¬65-80ä½æå–IMEIï¼ˆ15ä½ï¼‰
                            const potentialImei = cleanLine.substring(64, 79);
                            if (/\d{15}/.test(potentialImei)) {
                                imei = potentialImei;
                            }
                        }
                        if (!iccid) {
                            // å°è¯•ä»ç¬¬83-102ä½æå–ICCIDï¼ˆ20ä½ï¼‰
                            iccid = cleanLine.substring(82, 102);
                        }
                    } else if (cleanLine.length >= 52) {
                        // 52å­—èŠ‚æ•°æ®
                        if (!imei) {
                            // å°è¯•ä»ç¬¬53-67ä½æå–IMEIï¼ˆ15ä½ï¼‰
                            const potentialImei = cleanLine.substring(52, 67);
                            if (/\d{15}/.test(potentialImei)) {
                                imei = potentialImei;
                            }
                        }
                        if (!iccid) {
                            // å°è¯•ä»IMEIåé¢æŸ¥æ‰¾ICCID
                            const potentialIccidStart = cleanLine.indexOf('8986');
                            if (potentialIccidStart !== -1) {
                                iccid = cleanLine.substring(potentialIccidStart, potentialIccidStart + 20);
                            }
                        }
                    }
                }
                
                // ç¡®ä¿IMEIæ˜¯15ä½æ•°å­—
                if (imei) {
                    // ç§»é™¤å¯èƒ½çš„éæ•°å­—å­—ç¬¦
                    imei = imei.replace(/[^\d]/g, '');
                    // æˆªå–å‰15ä½
                    if (imei.length > 15) {
                        imei = imei.substring(0, 15);
                    }
                }
                
                // ç¡®ä¿ICCIDæ˜¯20ä½å­—ç¬¦
                if (iccid) {
                    // æˆªå–å‰20ä½
                    if (iccid.length > 20) {
                        iccid = iccid.substring(0, 20);
                    }
                }
                
                // éªŒè¯æå–ç»“æœ
            if (!imei && !iccid) {
                return 'æœªèƒ½æå–åˆ°IMEIå’ŒICCID';
            } else if (!imei) {
                return `-${iccid}`;
            } else if (!iccid) {
                return `${imei}-`;
            }
            
            // è¿”å›IMEIå’ŒICCIDï¼Œç”¨è¿å­—ç¬¦åˆ†éš”
            return `${imei}-${iccid}`;
            } catch (error) {
                return `è§£æå¤±è´¥: ${error.message}`;
            }
        }
        
        // ç»‘å®šè§£æIMEIå’ŒICCIDæŒ‰é’®äº‹ä»¶
        document.getElementById('parseImeiIccidBtn').addEventListener('click', parseImeiAndIccid);
        
        // ===== å·¥å…·é›†ä¼˜åŒ–ç‰ˆæœ¬ =====
        (function() {
            // å…¨å±€çŠ¶æ€ç®¡ç†
            const appState = {
                toolsExpanded: false,
                currentActiveTool: null,
                initialized: false
            };
            
            // å…ƒç´ ç¼“å­˜
            const elements = {
                toggleTutorialBtn: null,
                toggleToolsBtn: null,
                topToolSwitchBtn: null,
                tutorialsContainer: null,
                toolSwitcher: null,
                toolModal: null
            };
            
            /**
             * DOMå…ƒç´ åˆå§‹åŒ–å‡½æ•°
             * è´Ÿè´£è·å–å¹¶ç¼“å­˜é¡µé¢ä¸­æ‰€æœ‰éœ€è¦æ“ä½œçš„DOMå…ƒç´ å¼•ç”¨
             * è¿™äº›å…ƒç´ å¼•ç”¨å­˜å‚¨åœ¨å…¨å±€elementså¯¹è±¡ä¸­ä¾›å…¶ä»–å‡½æ•°ä½¿ç”¨
             */
            function initElements() {
                // è·å–æ•™ç¨‹ç›®å½•åˆ‡æ¢æŒ‰é’®
                elements.toggleTutorialBtn = document.getElementById('toggleTutorialBtn');
                // è·å–å·¥å…·å¯¼èˆªæ åˆ‡æ¢æŒ‰é’®
                elements.toggleToolsBtn = document.getElementById('toggleToolsBtn');
                // è·å–å³ä¸Šè§’å·¥å…·åˆ—è¡¨æŒ‰é’®
                elements.topToolSwitchBtn = document.getElementById('topToolSwitchBtn');
                // è·å–æ•™ç¨‹ç›®å½•å®¹å™¨
                elements.tutorialsContainer = document.getElementById('tutorialsContainer');
                // è·å–ä¸»å·¥å…·åˆ‡æ¢å™¨
                elements.toolSwitcher = document.getElementById('mainToolSwitcher');
                // è·å–å·¥å…·åˆ—è¡¨å¼¹çª—
                elements.toolModal = document.getElementById('toolModal');
            }
            
            /**
             * æ•™ç¨‹ç›®å½•æ”¶èµ·/å±•å¼€å‡½æ•°
             * åˆ‡æ¢æ•™ç¨‹ç›®å½•çš„æ˜¾ç¤ºçŠ¶æ€ï¼Œå¹¶æ›´æ–°åˆ‡æ¢æŒ‰é’®çš„æ–‡æœ¬
             */
            window.toggleTutorials = function() {
                try {
                    // è§£æ„è·å–éœ€è¦çš„å…ƒç´ å¼•ç”¨
                    const { tutorialsContainer, toggleTutorialBtn } = elements;
                    
                    // æ£€æŸ¥å…ƒç´ æ˜¯å¦æœ‰æ•ˆï¼Œæ— æ•ˆåˆ™ç›´æ¥è¿”å›
                    if (!isValidElement(tutorialsContainer) || !isValidElement(toggleTutorialBtn)) return;
                    
                    // åˆ¤æ–­å½“å‰ç›®å½•æ˜¯å¦éšè—
                    const isHidden = tutorialsContainer.style.display === 'none';
                    
                    // åˆ‡æ¢ç›®å½•æ˜¾ç¤ºçŠ¶æ€ï¼šå¦‚æœéšè—åˆ™æ˜¾ç¤º(block)ï¼Œå¦åˆ™éšè—(none)
                    tutorialsContainer.style.display = isHidden ? 'block' : 'none';
                    
                    // æ›´æ–°æŒ‰é’®æ–‡æœ¬ï¼šæ˜¾ç¤ºå‘ä¸Šç®­å¤´è¡¨ç¤ºå·²å±•å¼€ï¼Œå‘ä¸‹ç®­å¤´è¡¨ç¤ºå·²æ”¶èµ·
                    toggleTutorialBtn.textContent = isHidden ? 'â–²' : 'â–¼';
                } catch (err) {
                    // ç»Ÿä¸€é”™è¯¯å¤„ç†
                    handleError('åˆ‡æ¢æ•™ç¨‹ç›®å½•', err);
                }
            };
            
            /**
             * è¾…åŠ©å‡½æ•°ï¼šæ£€æŸ¥DOMå…ƒç´ æ˜¯å¦æœ‰æ•ˆ
             * @param {HTMLElement} element - éœ€è¦æ£€æŸ¥çš„DOMå…ƒç´ 
             * @returns {boolean} - å¦‚æœå…ƒç´ å­˜åœ¨ä¸”ä¸ºDOMå…ƒç´ èŠ‚ç‚¹ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false
             */
            function isValidElement(element) {
                // æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ä¸”èŠ‚ç‚¹ç±»å‹ä¸º1(ElementèŠ‚ç‚¹)
                return element && element.nodeType === 1;
            }
            
            /**
             * è¾…åŠ©å‡½æ•°ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†
             * æä¾›æ ‡å‡†åŒ–çš„é”™è¯¯è®°å½•æœºåˆ¶ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œé”™è¯¯è¿½è¸ª
             * @param {string} operation - é”™è¯¯å‘ç”Ÿçš„æ“ä½œæè¿°
             * @param {Error} error - æ•è·åˆ°çš„é”™è¯¯å¯¹è±¡
             */
            function handleError(operation, error) {
                console.error(`${operation}å‡ºé”™:`, error.message);
            }
            
            /**
             * æ›´æ–°å·¥å…·æŒ‰é’®å¯è§æ€§çš„å…¬å…±å‡½æ•°
             * æ ¹æ®æ˜¾ç¤ºæ¨¡å¼æ§åˆ¶å·¥å…·æŒ‰é’®çš„æ˜¾ç¤º/éšè—çŠ¶æ€
             * @param {NodeList|Array} buttons - å·¥å…·æŒ‰é’®é›†åˆ
             * @param {boolean} shouldShowAll - æ˜¯å¦æ˜¾ç¤ºæ‰€æœ‰æŒ‰é’®ï¼Œé»˜è®¤ä¸ºfalseï¼ˆä»…æ˜¾ç¤ºå¸¸ç”¨å·¥å…·ï¼‰
             */
            function updateToolButtonsVisibility(buttons, shouldShowAll = false) {
                // éå†æ‰€æœ‰æŒ‰é’®
                buttons.forEach(btn => {
                    // æ£€æŸ¥æŒ‰é’®å…ƒç´ æ˜¯å¦æœ‰æ•ˆ
                    if (isValidElement(btn)) {
                        // å¦‚æœè®¾ç½®ä¸ºæ˜¾ç¤ºå…¨éƒ¨ï¼Œåˆ™ç›´æ¥æ˜¾ç¤ºæ‰€æœ‰æŒ‰é’®
                        if (shouldShowAll) {
                            btn.style.display = 'inline-block';
                            return;
                        }
                        
                        // è·å–æŒ‰é’®æ–‡æœ¬å†…å®¹ï¼ˆé˜²æ­¢æ–‡æœ¬ä¸ºç©ºçš„æƒ…å†µï¼‰
                        const btnText = btn.textContent || '';
                        // åˆ¤æ–­æŒ‰é’®æ˜¯å¦ä¸ºå½“å‰æ¿€æ´»çŠ¶æ€
                        const isActive = btn.classList.contains('active');
                        // å®šä¹‰å¸¸ç”¨å·¥å…·ç±»å‹åˆ¤æ–­
                        const isIcCardTool = btnText.includes('ICå¡å·å¤„ç†');
                        const isPulseTool = btnText.includes('è„‰å†²è®¡ç®—å™¨');
                        // åŒæ—¶æ£€æŸ¥å¤§å°å†™ç‰ˆæœ¬
                        const isIccidTool = btnText.includes('iccidè¯¦æƒ…') || btnText.includes('ICCIDè¯¦æƒ…');
                        const isSerialTool = btnText.includes('ç”Ÿæˆæµæ°´å·');
                        const isQRTool = btnText.includes('è§£æäºŒç»´ç ');
                        const isQRGeneratorTool = btnText.includes('äºŒç»´ç ç”Ÿæˆå™¨') || btnText.includes('äºŒç»´ç ç”Ÿæˆ');
                        const isStockParamTool = btnText.includes('å…¥åº“å‚æ•°ç”Ÿæˆ');
                        
                        // è®¾ç½®æŒ‰é’®æ˜¾ç¤ºçŠ¶æ€ï¼šå¦‚æœæ˜¯æ¿€æ´»æ€æˆ–å±äºå¸¸ç”¨å·¥å…·åˆ™æ˜¾ç¤ºï¼ˆç©ºå­—ç¬¦ä¸²é‡ç½®ä¸ºé»˜è®¤æ˜¾ç¤ºï¼‰ï¼Œå¦åˆ™éšè—
                        btn.style.display = (isActive || isIcCardTool || isPulseTool || 
                                          isIccidTool || isSerialTool || isQRTool || isQRGeneratorTool || isStockParamTool) ? '' : 'none';
                    }
                });
            }
            
            /**
             * å·¥å…·å¯¼èˆªæ æ”¶èµ·/å±•å¼€å‡½æ•°
             * åˆ‡æ¢å·¥å…·å¯¼èˆªæ çš„å±•å¼€/æ”¶èµ·çŠ¶æ€ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°æŒ‰é’®æ˜¾ç¤ºå’Œæ–‡æœ¬å†…å®¹
             */
            window.toggleTools = function() {
                try {
                    // è§£æ„è·å–éœ€è¦çš„å…ƒç´ å¼•ç”¨
                    const { toolSwitcher, toggleToolsBtn } = elements;
                    
                    // ä½¿ç”¨ç»Ÿä¸€çš„å…ƒç´ æœ‰æ•ˆæ€§æ£€æŸ¥
                    if (!isValidElement(toolSwitcher) || !isValidElement(toggleToolsBtn)) return;
                    
                    const allButtons = toolSwitcher.querySelectorAll('button');
                    // å…ˆè·å–å½“å‰çŠ¶æ€çš„åå‘ï¼ˆè¦åˆ‡æ¢åˆ°çš„ç›®æ ‡çŠ¶æ€ï¼‰
                    const targetExpanded = !appState.toolsExpanded;
                    
                    if (!targetExpanded) { // å¦‚æœç›®æ ‡çŠ¶æ€æ˜¯æ”¶èµ·
                        // æ”¶èµ·çŠ¶æ€ï¼šåªæ˜¾ç¤ºå¸¸ç”¨å·¥å…·
                        updateToolButtonsVisibility(allButtons, false);
                        toggleToolsBtn.textContent = 'æŸ¥çœ‹æ›´å¤šâ–¼â–²';
                    } else { // å¦‚æœç›®æ ‡çŠ¶æ€æ˜¯å±•å¼€
                        // å±•å¼€çŠ¶æ€ï¼šæ˜¾ç¤ºæ‰€æœ‰å·¥å…·
                        updateToolButtonsVisibility(allButtons, true);
                        toggleToolsBtn.textContent = 'æ”¶èµ·â–²â–¼';
                    }
                    
                    // å…ˆæ›´æ–°UIï¼Œå†æ›´æ–°çŠ¶æ€å˜é‡
                    appState.toolsExpanded = targetExpanded;
                } catch (err) {
                    // ä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶è®°å½•åˆ‡æ¢è¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯
                    handleError('åˆ‡æ¢å·¥å…·æ ', err);
                }
            };
            
            /**
             * æ·»åŠ ç‚¹å‡»å·¥å…·å¯¼èˆªæ ç©ºç™½åŒºåŸŸåˆ‡æ¢èœå•å±•å¼€/æ”¶èµ·çŠ¶æ€çš„åŠŸèƒ½
             * ä¸ºå·¥å…·å¯¼èˆªæ æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬ï¼Œå½“ç”¨æˆ·ç‚¹å‡»å¯¼èˆªæ æœ¬èº«ï¼ˆè€Œéå…¶ä¸­çš„æŒ‰é’®å…ƒç´ ï¼‰æ—¶åˆ‡æ¢å±•å¼€/æ”¶èµ·çŠ¶æ€
             */
            function setupToolSwitcherClickHandler() {
                try {
                    // è·å–å·¥å…·å¯¼èˆªæ å…ƒç´ å¼•ç”¨
                    const { toolSwitcher } = elements;
                    
                    // ä½¿ç”¨ç»Ÿä¸€çš„å…ƒç´ æœ‰æ•ˆæ€§æ£€æŸ¥
                    if (!isValidElement(toolSwitcher)) return;
                    
                    // ä¸ºå·¥å…·å¯¼èˆªæ æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
                    toolSwitcher.addEventListener('click', function(event) {
                        // å®‰å…¨æ£€æŸ¥äº‹ä»¶å¯¹è±¡å¹¶åˆ¤æ–­ç‚¹å‡»ç›®æ ‡æ˜¯å¦æ˜¯å¯¼èˆªæ æœ¬èº«ï¼ˆå³ç©ºç™½åŒºåŸŸï¼‰
                        if (event && event.target === toolSwitcher) {
                            // å¦‚æœç‚¹å‡»çš„æ˜¯å¯¼èˆªæ æœ¬èº«è€ŒéæŒ‰é’®ï¼Œåˆ™è°ƒç”¨toggleToolså‡½æ•°åˆ‡æ¢èœå•å±•å¼€/æ”¶èµ·çŠ¶æ€
                            window.toggleTools();
                        }
                    });
                } catch (err) {
                    // ä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶è®°å½•äº‹ä»¶ç»‘å®šè¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯
                    handleError('è®¾ç½®å·¥å…·å¯¼èˆªæ ç‚¹å‡»å¤„ç†å™¨', err);
                }
            }
            
            /**
             * å·¥å…·åˆ—è¡¨å¼¹çª—å‡½æ•°
             * åˆ‡æ¢å·¥å…·åˆ—è¡¨å¼¹çª—çš„æ˜¾ç¤º/éšè—çŠ¶æ€ï¼Œå¹¶ç›¸åº”åœ°æ§åˆ¶é¡µé¢æ»šåŠ¨è¡Œä¸º
             */
            window.toggleToolModal = function() {
                try {
                    // è·å–å·¥å…·å¼¹çª—å…ƒç´ å¼•ç”¨
                    const modal = elements.toolModal;
                    
                    // ä½¿ç”¨ç»Ÿä¸€çš„å…ƒç´ æœ‰æ•ˆæ€§æ£€æŸ¥
                    if (!isValidElement(modal)) return;
                    
                    // åˆ¤æ–­å¼¹çª—å½“å‰æ˜¯å¦ä¸ºæ‰“å¼€çŠ¶æ€ï¼ˆä½¿ç”¨flexå¸ƒå±€è¡¨ç¤ºæ‰“å¼€ï¼‰
                    const isOpen = modal.style.display === 'flex';
                    
                    // åˆ‡æ¢å¼¹çª—æ˜¾ç¤ºçŠ¶æ€ï¼šå¦‚æœå·²æ‰“å¼€åˆ™éšè—(none)ï¼Œå¦åˆ™æ˜¾ç¤º(flex)
                    modal.style.display = isOpen ? 'none' : 'flex';
                    
                    // æ§åˆ¶é¡µé¢æ»šåŠ¨ï¼šå¼¹çª—æ‰“å¼€æ—¶ç¦æ­¢é¡µé¢æ»šåŠ¨ï¼Œå…³é—­æ—¶æ¢å¤æ»šåŠ¨
                    document.body.style.overflow = isOpen ? '' : 'hidden';
                    
                    // æ·»åŠ æˆ–ç§»é™¤bodyçš„modal-openç±»åï¼Œç”¨äºæ ·å¼æ§åˆ¶
                    document.body.classList.toggle('modal-open', !isOpen);
                } catch (err) {
                    // ä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶è®°å½•å¼¹çª—åˆ‡æ¢è¿‡ç¨‹ä¸­çš„é”™è¯¯
                    handleError('åˆ‡æ¢å·¥å…·å¼¹çª—', err);
                }
            };
            
            /**
             * æ‰©å±•showToolå‡½æ•°ï¼Œå¢åŠ è®°å½•å½“å‰æ¿€æ´»å·¥å…·å’Œæ›´æ–°æŒ‰é’®çŠ¶æ€åŠŸèƒ½
             * é‡‡ç”¨å‡½æ•°åŒ…è£…æ¨¡å¼ï¼Œä¿ç•™åŸå§‹åŠŸèƒ½çš„åŒæ—¶å¢åŠ é¢å¤–çš„å·¥å…·çŠ¶æ€ç®¡ç†èƒ½åŠ›
             */
            function enhanceShowTool() {
                try {
                    // é¦–å…ˆæ£€æŸ¥åŸå§‹showToolå‡½æ•°æ˜¯å¦å­˜åœ¨
                    if (typeof window.showTool === 'function') {
                        // ä¿å­˜åŸå§‹showToolå‡½æ•°å¼•ç”¨ï¼Œä»¥ä¾¿åç»­è°ƒç”¨
                        const originalShowTool = window.showTool;
                        
                        // é‡å†™window.showToolå‡½æ•°
                        window.showTool = function(toolId) {
                            try {
                                // è®°å½•å½“å‰æ¿€æ´»çš„å·¥å…·IDåˆ°åº”ç”¨çŠ¶æ€
                                appState.currentActiveTool = toolId;
                                
                                // è°ƒç”¨åŸå§‹å‡½æ•°ï¼Œä¿ç•™åŸæœ‰åŠŸèƒ½
                                originalShowTool.apply(this, arguments);
                                
                                // æ›´æ–°æ‰€æœ‰å·¥å…·æŒ‰é’®çš„activeçŠ¶æ€
                                const allButtons = document.querySelectorAll('.tool-switcher button');
                                // å®‰å…¨æ£€æŸ¥æŒ‰é’®é›†åˆ
                                if (allButtons && allButtons.length > 0) {
                                    // éå†æ¯ä¸ªæŒ‰é’®
                                    allButtons.forEach(btn => {
                                        // æ£€æŸ¥æŒ‰é’®å…ƒç´ æ˜¯å¦æœ‰æ•ˆ
                                        if (isValidElement(btn)) {
                                            try {
                                                // è·å–æŒ‰é’®æ–‡æœ¬å†…å®¹
                                                const btnText = btn.textContent || '';
                                                let shouldActivate = false;
                                                
                                                // å·¥å…·åç§°åˆ°IDçš„æ˜ å°„è¡¨ï¼Œç”¨äºæ ¹æ®æŒ‰é’®æ–‡æœ¬è¯†åˆ«å¯¹åº”çš„å·¥å…·ID
                                                const toolMapping = {
                                                    'è„‰å†²è®¡ç®—å™¨': 'pulseTool',
                                                    'è¿›åˆ¶è½¬æ¢å™¨': 'conversionTool',
                                                    'å…¥åº“å‚æ•°è§£æ': 'paramParser',
                                                    'ICCIDè¯¦æƒ…': 'iccidTool',
                                                    'ICå¡å·å¤„ç†': 'excelTemplateTool',
                                                    'ç”Ÿæˆæµæ°´å·': 'serialNumberTool',
                                                    'æ´—æµ´å•ä»·': 'waterValueTool',
                                                    'æ°´æ§å•ä»·': 'waterPriceTool',
                                                    'ä¿®å¤iccidä¹±ç ': 'csv89860Tool',
                                                    'äºŒç»´ç ç”Ÿæˆå™¨': 'qrGeneratorTool',
                                                    'æ—¥å¿—åˆ†æå™¨': 'logAnalysisTool',
                                                    'æ—¥å¿—è§£æå™¨': 'logAnalysisTool2',
                                                    'è§£æäºŒç»´ç ': 'qrParserTool'
                                                };
                                                
                                                // éå†æ˜ å°„è¡¨ï¼Œæ£€æŸ¥æŒ‰é’®æ–‡æœ¬æ˜¯å¦åŒ…å«å¯¹åº”å·¥å…·åç§°ï¼Œä¸”IDåŒ¹é…
                                                for (const [name, id] of Object.entries(toolMapping)) {
                                                    if (btnText.includes(name) && id === toolId) {
                                                        shouldActivate = true;
                                                        break;
                                                    }
                                                }
                                                
                                                // ä½¿ç”¨toggleæ–¹æ³•æ ¹æ®shouldActivateå€¼æ·»åŠ æˆ–ç§»é™¤activeç±»
                                                btn.classList.toggle('active', shouldActivate);
                                            } catch (btnErr) {
                                                // é™é»˜å¤„ç†å•ä¸ªæŒ‰é’®çš„é”™è¯¯ï¼Œä¸å½±å“å…¶ä»–æŒ‰é’®æ›´æ–°
                                                handleError('å·¥å…·æŒ‰é’®çŠ¶æ€æ›´æ–°', btnErr, true);
                                            }
                                        }
                                    });
                                }
                                
                                // ä¿æŒå½“å‰çš„å±•å¼€/æ”¶èµ·çŠ¶æ€ï¼Œæ— éœ€é¢å¤–æ“ä½œ
                            } catch (err) {
                                console.error('æ‰§è¡ŒshowToolå‡ºé”™:', err.message);
                                // å³ä½¿å‡ºé”™ä¹Ÿå°è¯•è°ƒç”¨åŸå§‹å‡½æ•°ï¼Œç¡®ä¿åŸºæœ¬åŠŸèƒ½æ­£å¸¸
                                originalShowTool.apply(this, arguments);
                            }
                        };
                    }
                } catch (err) {
                    console.error('å¢å¼ºshowToolå‡½æ•°å‡ºé”™:', err.message);
                }
            }
            
            /**
             * ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
             * ä¸ºæ‰€æœ‰äº¤äº’å…ƒç´ æ·»åŠ ç»Ÿä¸€çš„äº‹ä»¶ç›‘å¬å¤„ç†ï¼ŒåŒ…æ‹¬æŒ‰é’®ç‚¹å‡»ã€å¼¹çª—äº¤äº’ã€é”®ç›˜äº‹ä»¶å’Œé”™è¯¯å¤„ç†ç­‰
             */
            function bindEvents() {
                try {
                    // æ•™ç¨‹ç›®å½•æŒ‰é’®ç»‘å®šäº‹ä»¶
                    if (elements.toggleTutorialBtn) {
                        // ç§»é™¤å†…è”onclickå±æ€§ï¼Œæ”¹ä¸ºä½¿ç”¨æ ‡å‡†çš„äº‹ä»¶ç›‘å¬å™¨
                        elements.toggleTutorialBtn.removeAttribute('onclick');
                        elements.toggleTutorialBtn.addEventListener('click', window.toggleTutorials);
                    }
                    
                    // å·¥å…·å¯¼èˆªæŒ‰é’®ç»‘å®šäº‹ä»¶
                    if (elements.toggleToolsBtn) {
                        elements.toggleToolsBtn.removeAttribute('onclick');
                        elements.toggleToolsBtn.addEventListener('click', window.toggleTools);
                    }
                    
                    // å³ä¸Šè§’å·¥å…·åˆ—è¡¨æŒ‰é’®ç»‘å®šäº‹ä»¶
                    if (elements.topToolSwitchBtn) {
                        elements.topToolSwitchBtn.removeAttribute('onclick');
                        elements.topToolSwitchBtn.addEventListener('click', window.toggleToolModal);
                    }
                    
                    // å¼¹çª—ç‚¹å‡»å¤–éƒ¨åŒºåŸŸå…³é—­åŠŸèƒ½
                    if (elements.toolModal) {
                        elements.toolModal.addEventListener('click', function(e) {
                            // ä»…å½“ç‚¹å‡»ç›®æ ‡æ˜¯å¼¹çª—æœ¬èº«è€Œéå…¶å­å…ƒç´ æ—¶æ‰å…³é—­å¼¹çª—
                            if (e && e.target === elements.toolModal) {
                                window.toggleToolModal();
                            }
                        });
                    }
                    
                    // å¼¹çª—å…³é—­æŒ‰é’®ç»‘å®šäº‹ä»¶
                    const closeModalBtn = document.getElementById('closeToolModalBtn');
                    if (closeModalBtn) {
                        closeModalBtn.addEventListener('click', window.toggleToolModal);
                    }
                    
                    // ESCé”®å…³é—­å¼¹çª—åŠŸèƒ½ - æ·»åŠ å…¨å±€é”®ç›˜äº‹ä»¶ç›‘å¬å™¨
                    document.addEventListener('keydown', function(e) {
                        // æ£€æŸ¥äº‹ä»¶å¯¹è±¡æ˜¯å¦æœ‰æ•ˆï¼Œæ˜¯å¦ä¸ºEscapeé”®ï¼Œä¸”å¼¹çª—æ˜¯å¦å¤„äºæ‰“å¼€çŠ¶æ€
                        if (e && e.key === 'Escape' && elements.toolModal && elements.toolModal.style.display === 'flex') {
                            window.toggleToolModal();
                        }
                    });
                    
                    // æ·»åŠ å…¨å±€é”™è¯¯å¤„ç† - æ•è·é¡µé¢ä¸­çš„JavaScripté”™è¯¯
                    window.addEventListener('error', function(event) {
                        handleError(`å…¨å±€é”™è¯¯: ${event.message} ä½äº: ${event.filename} ç¬¬ ${event.lineno} è¡Œ`, new Error(event.message));
                    });
                    
                    // æ·»åŠ Promiseé”™è¯¯å¤„ç† - æ•è·æœªå¤„ç†çš„Promiseæ‹’ç»
                    window.addEventListener('unhandledrejection', function(event) {
                        handleError('æœªå¤„ç†çš„Promiseé”™è¯¯', new Error(String(event.reason)));
                    });
                    
                    // ä¸ºæ‰€æœ‰å¸¦data-tool-idå±æ€§çš„å·¥å…·æŒ‰é’®æ·»åŠ ç»Ÿä¸€çš„ç‚¹å‡»äº‹ä»¶å¤„ç†
                    const allToolButtons = document.querySelectorAll('button[data-tool-id]');
                    if (allToolButtons && allToolButtons.length > 0) {
                        // éå†æ‰€æœ‰å·¥å…·æŒ‰é’®
                        allToolButtons.forEach(btn => {
                            // æ£€æŸ¥æŒ‰é’®å…ƒç´ æ˜¯å¦æœ‰æ•ˆ
                            if (isValidElement(btn)) {
                                btn.addEventListener('click', function() {
                                    try {
                                        // è·å–æŒ‰é’®å¯¹åº”çš„å·¥å…·ID
                                        const toolId = this.getAttribute('data-tool-id');
                                        
                                        // å®‰å…¨æ£€æŸ¥ï¼šå·¥å…·IDå­˜åœ¨ä¸”showToolå‡½æ•°å¯ç”¨
                                        if (toolId && typeof window.showTool === 'function') {
                                            // è°ƒç”¨showToolå‡½æ•°åˆ‡æ¢åˆ°æŒ‡å®šå·¥å…·
                                            window.showTool(toolId);
                                            
                                            // å¼ºåˆ¶å…³é—­å·¥å…·åˆ—è¡¨å¼¹çª—ï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒä¸€è‡´æ€§
                                            setTimeout(function() {
                                                try {
                                                    const toolModal = document.getElementById('toolModal');
                                                    if (toolModal && toolModal.style.display === 'flex') {
                                                        window.toggleToolModal();
                                                    }
                                                } catch (closeErr) {
                                                    handleError('å…³é—­å¼¹çª—', closeErr);
                                                }
                                            }, 100); // çŸ­æš‚å»¶è¿Ÿç¡®ä¿å·¥å…·åˆ‡æ¢å®Œæˆåå†å…³é—­å¼¹çª—
                                        }
                                    } catch (err) {
                                        handleError('å·¥å…·æŒ‰é’®ç‚¹å‡»', err);
                                    }
                                });
                            }
                        });
                    }
                } catch (err) {
                    // ç»Ÿä¸€é”™è¯¯å¤„ç†
                    handleError('ç»‘å®šäº‹ä»¶ç›‘å¬å™¨', err);
                }
            }
            
            /**
             * åˆå§‹åŒ–åº”ç”¨ç¨‹åº
             * è´Ÿè´£è®¾ç½®åº”ç”¨ç¨‹åºçš„åˆå§‹çŠ¶æ€ã€ç»‘å®šäº‹ä»¶ç›‘å¬å™¨å’Œå¢å¼ºç°æœ‰åŠŸèƒ½
             * ä½¿ç”¨try-catchç»“æ„ç¡®ä¿åˆå§‹åŒ–è¿‡ç¨‹ä¸­çš„é”™è¯¯èƒ½å¤Ÿè¢«æ•è·å’Œå¤„ç†
             */
            function initApp() {
                try {
                    // é˜²æ­¢é‡å¤åˆå§‹åŒ–æ£€æŸ¥
                    if (appState.initialized) return;
                    
                    // åˆå§‹åŒ–DOMå…ƒç´ å¼•ç”¨ï¼Œæ–¹ä¾¿åç»­æ“ä½œ
                    initElements();
                    
                    // åˆå§‹åŒ–æ•™ç¨‹ç›®å½•ä¸ºæ”¶èµ·çŠ¶æ€
                    if (isValidElement(elements.tutorialsContainer)) {
                        elements.tutorialsContainer.style.display = 'none';
                    }
                    // æ›´æ–°æ•™ç¨‹åˆ‡æ¢æŒ‰é’®æ–‡æœ¬ä¸ºæ”¶èµ·çŠ¶æ€
                    if (isValidElement(elements.toggleTutorialBtn)) {
                        elements.toggleTutorialBtn.textContent = 'â–¼';
                    }
                    
                    // ç»‘å®šæ‰€æœ‰äº¤äº’å…ƒç´ çš„äº‹ä»¶ç›‘å¬å™¨
                    bindEvents();
                    
                    // å¢å¼ºåŸç”ŸshowToolå‡½æ•°ï¼Œæ·»åŠ å·¥å…·çŠ¶æ€ç®¡ç†åŠŸèƒ½
                    enhanceShowTool();
                    
                    // è®¾ç½®å·¥å…·å¯¼èˆªæ ç©ºç™½åŒºåŸŸçš„ç‚¹å‡»äº‹ä»¶å¤„ç†å™¨
                    setupToolSwitcherClickHandler();
                    
                    // ä½¿ç”¨setTimeoutå»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿DOMå®Œå…¨åŠ è½½åå†åº”ç”¨åˆå§‹æ ·å¼
                    setTimeout(() => {
                        try {
                            const { toolSwitcher, toggleToolsBtn } = elements;
                            // æ£€æŸ¥å¿…è¦å…ƒç´ æ˜¯å¦å­˜åœ¨
                            if (isValidElement(toolSwitcher) && isValidElement(toggleToolsBtn)) {
                                // åˆå§‹åŒ–æ—¶ç¡®ä¿å·¥å…·å¯¼èˆªæ çŠ¶æ€ä¸ºæ”¶èµ·
                                appState.toolsExpanded = false;
                            
                                // è·å–æ‰€æœ‰å·¥å…·æŒ‰é’®
                                const allButtons = toolSwitcher.querySelectorAll('button');
                                // åº”ç”¨åˆå§‹çŠ¶æ€ä¸‹çš„æŒ‰é’®å¯è§æ€§æ§åˆ¶
                                updateToolButtonsVisibility(allButtons);
                                // è®¾ç½®åˆ‡æ¢æŒ‰é’®çš„åˆå§‹æ–‡æœ¬
                                toggleToolsBtn.textContent = 'æŸ¥çœ‹æ›´å¤šâ–¼â–²';
                            }
                        } catch (timeoutErr) {
                            // æ•è·å¹¶å¤„ç†åˆå§‹åŒ–æ ·å¼åº”ç”¨è¿‡ç¨‹ä¸­çš„é”™è¯¯
                            handleError('å·¥å…·å¯¼èˆªæ åˆå§‹åŒ–è¶…æ—¶', timeoutErr);
                        }
                    }, 200);
                    
                    // æ ‡è®°åº”ç”¨å·²å®Œæˆåˆå§‹åŒ–ï¼Œé˜²æ­¢é‡å¤æ‰§è¡Œ
                    appState.initialized = true;
                } catch (err) {
                    // ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼Œç¡®ä¿åˆå§‹åŒ–è¿‡ç¨‹ä¸­çš„å¼‚å¸¸ä¸ä¼šå½±å“æ•´ä¸ªåº”ç”¨
                    handleError('åˆå§‹åŒ–åº”ç”¨', err);
                }
            }
            
            /**
             * é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨åˆå§‹åŒ–åº”ç”¨
             * æ£€æŸ¥å½“å‰æ–‡æ¡£åŠ è½½çŠ¶æ€ï¼š
             * - å¦‚æœæ–‡æ¡£ä»åœ¨åŠ è½½ä¸­(loadingçŠ¶æ€)ï¼Œåˆ™æ³¨å†ŒDOMContentLoadedäº‹ä»¶ç›‘å¬å™¨
             * - å¦‚æœæ–‡æ¡£å·²ç»åŠ è½½å®Œæˆï¼Œåˆ™ä½¿ç”¨setTimeoutåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¸­åˆå§‹åŒ–åº”ç”¨
             * è¿™ç§æ–¹å¼ç¡®ä¿æ— è®ºåœ¨è„šæœ¬æ‰§è¡Œæ—¶æ–‡æ¡£å¤„äºä½•ç§çŠ¶æ€ï¼Œéƒ½èƒ½æ­£ç¡®åˆå§‹åŒ–åº”ç”¨
             */
            if (document.readyState === 'loading') {
                // æ–‡æ¡£æ­£åœ¨åŠ è½½ä¸­ï¼Œç­‰å¾…DOMå®Œå…¨è§£æå’Œæ„å»ºåå†åˆå§‹åŒ–
                document.addEventListener('DOMContentLoaded', initApp);
            } else {
                // æ–‡æ¡£å·²ç»åŠ è½½å®Œæˆï¼Œä½¿ç”¨setTimeoutç¡®ä¿åœ¨å½“å‰æ‰§è¡Œæ ˆæ¸…ç©ºåå†åˆå§‹åŒ–
                // è¿™æ˜¯ä¸€ç§å¸¸è§çš„å¼‚æ­¥åˆå§‹åŒ–æ¨¡å¼ï¼Œå¯ä»¥é¿å…é˜»å¡UIæ¸²æŸ“
                setTimeout(initApp, 0);
            }
        })();
        
        </script>
    </body>
    </html>
